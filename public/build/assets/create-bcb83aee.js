import{_ as D,Z as N,O as j,P as A,D as O,T as E,r as h,R as z,a3 as I,o as J,g as c,i as a,y as K,w as p,a as P,N as W,l as m,n as e,J as r,z as u,k as i,L as v,F as b,t as g,K as Y,H as Z,M as w,p as G,C as T}from"./vendor-54d6cb1e.js";import{L as X}from"./main-b839be26.js";import{P as Q}from"./page-header-ff719701.js";import{F as $}from"./FormValidation-cabc17c8.js";import{s as ee}from"./searchbar-3bdb3315.js";import"./footer-7e4f68d9.js";import"./app-cb082573.js";const oe={data(){return{promocode:!1}},components:{Layout:X,PageHeader:Q,Head:N,Multiselect:j,searchbar:ee,FormValidation:$,flatPickr:A},methods:{customSearch(s,o){return o?s.filter(_=>{const l=o.toLowerCase();return _.label.toLowerCase().includes(l)||_.mobile.toLowerCase().includes(l)}):s}},props:{successMessage:String,alertMessage:String,serviceLocations:Array,promo:Object,users:Object,service_location_ids:Array},setup(s){var V,B,L;const{t:o}=O(),_=E({service_location_id:s.promo?s.promo.service_location_id:"",transport_type:s.promo?s.promo.transport_type:"",code:s.promo?s.promo.code:"",minimum_trip_amount:s.promo?s.promo.minimum_trip_amount:"",maximum_discount_amount:s.promo?s.promo.maximum_discount_amount:"",cummulative_maximum_discount_amount:s.promo?s.promo.cummulative_maximum_discount_amount:"",discount_percent:s.promo?s.promo.discount_percent:"",uses_per_user:s.promo?s.promo.uses_per_user:"",user_id:s.promo?s.promo.user_id:[],user_specific:s.promo?((V=s.promo.user_id)==null?void 0:V.length)>0:!1,date:[]}),l=h({minDate:s.promo?(L=(B=s.promo.from)==null?void 0:B.split(" "))==null?void 0:L[0]:"today",mode:"range",dateFormat:"Y-m-d"}),f=h(""),C=h(s.users?s.users:[]),S=async()=>{try{let d=await P.get("/promo-code/userList?search="+f.value);C.value=d.data.results}catch(d){console.log("Errors"+d)}};z(f,I.debounce(function(){f.value.length>0?S():C.value=[]},300));const U={service_location_id:{required:!0},transport_type:{required:!0},code:{required:!0},minimum_trip_amount:{required:!0},maximum_discount_amount:{required:!0},discount_percent:{required:!0},uses_per_user:{required:!0},user_specific:{required:!1},user_id:{required:_.user_specific},date:{required:!0}},M=h(null),y=h({}),k=h(s.successMessage||""),x=h(s.alertMessage||""),q=()=>{k.value="",x.value=""},H=d=>{f.value=d},F=async()=>{if(y.value=M.value.validate(),!(Object.keys(y.value).length>0))try{let d;s.promo?d=await P.post(`/promo-code/update/${s.promo.id}`,_.data()):d=await P.post("store",_.data()),d.status===201||d.status===200?(k.value=o("promo_code_saved_successfully"),_.reset(),W.get("/promo-code")):x.value=o("failed_to_save_promo_code")}catch(d){d.response&&d.response.status===422?y.value=d.response.data.errors:(console.error(o("error_saving_promo_code"),d),x.value=o("failed_to_save_promo_code"))}};return J(()=>{var d,t,n,R;s.promo&&(_.date=[(t=(d=s.promo.from)==null?void 0:d.split(" "))==null?void 0:t[0],(R=(n=s.promo.to)==null?void 0:n.split(" "))==null?void 0:R[0]])}),{form:_,successMessage:k,users:C,inputsearch:H,alertMessage:x,handleSubmit:F,dismissMessage:q,validationRules:U,validationRef:M,serviceLocations:s.serviceLocations,errors:y,rangeDateconfig:l}}},se={class:"text-success text-decoration-underline text-decoration-underline-success float-end"},te={class:"row"},le={class:"col-md-6"},re={class:"mb-3"},ae={for:"select_service_locations",class:"form-label"},ne={class:"col-md-6"},ie={class:"mb-3"},de={for:"select_transport_type",class:"form-label"},me={disabled:"",value:""},ce={value:"taxi"},ue={value:"delivery"},_e={value:"both"},fe={class:"col-md-6"},pe={class:"mb-3"},ve={for:"select_users",class:"form-label"},be={class:"col-md-6 d-flex"},ge={class:"form-check",style:{"align-self":"center"}},he={for:"select_all_user"},ye=["checked"],ke={class:"col-sm-6"},xe={class:"mb-3"},we={for:"code",class:"form-label"},Ce=["placeholder"],Me={class:"col-sm-6"},Ve={class:"mb-3"},Be={for:"minimum_trip_amount",class:"form-label"},Le=["placeholder"],Se={class:"col-sm-6"},Ue={class:"mb-3"},qe={for:"maximum_discount_amount",class:"form-label"},He=["placeholder"],Fe={class:"col-sm-6"},Pe={class:"mb-3"},Re={for:"cummulative_maximum_discount_amount",class:"form-label"},Te=["placeholder"],De={class:"col-sm-6"},Ne={class:"mb-3"},je={for:"discount_percent",class:"form-label"},Ae=["placeholder"],Oe={class:"col-sm-6"},Ee={class:"mb-4"},ze={for:"datepicker-range",class:"form-label"},Ie={class:"col-sm-6"},Je={class:"mb-3"},Ke={for:"uses_per_user",class:"form-label"},We=["placeholder"],Ye={class:"col-lg-12"},Ze={class:"text-end"},Ge={type:"submit",class:"btn btn-primary"},Xe={key:0,class:"custom-alert alert alert-success alert-border-left fade show",role:"alert"},Qe={class:"alert-content"},$e={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",role:"alert"},eo={class:"alert-content"},oo={class:"modal-footer v-modal-footer"};function so(s,o,_,l,f,C){const S=c("Head"),U=c("PageHeader"),M=c("BLink"),y=c("BCardHeader"),k=c("Multiselect"),x=c("flat-pickr"),q=c("FormValidation"),H=c("BCardBody"),F=c("BCard"),V=c("BCol"),B=c("BRow"),L=c("BModal"),d=c("Layout");return a(),K(d,null,{default:p(()=>[m(S,{title:"Promo Code"}),m(U,{title:_.promo?s.$t("edit"):s.$t("create"),pageTitle:s.$t("promo_code"),pageLink:"/promo-code"},null,8,["title","pageTitle"]),m(B,null,{default:p(()=>[m(V,{lg:"12"},{default:p(()=>[m(F,{"no-body":"",id:"tasksList"},{default:p(()=>[m(y,{class:"border-0"},{default:p(()=>[m(M,{onClick:o[0]||(o[0]=t=>f.promocode=!f.promocode)},{default:p(()=>[e("h6",se,r(s.$t("how_it_works")),1)]),_:1})]),_:1}),m(H,{class:"border border-dashed border-end-0 border-start-0"},{default:p(()=>[e("form",{onSubmit:o[12]||(o[12]=G((...t)=>l.handleSubmit&&l.handleSubmit(...t),["prevent"]))},[m(q,{form:l.form,rules:l.validationRules,ref:"validationRef"},{default:p(()=>[e("div",te,[e("div",le,[e("div",re,[e("label",ae,[u(r(s.$t("service_locations"))+" ",1),o[17]||(o[17]=e("span",{class:"text-danger"},"*",-1))]),m(k,{id:"select_service_locations",modelValue:l.form.service_location_id,"onUpdate:modelValue":o[1]||(o[1]=t=>l.form.service_location_id=t),"close-on-select":"",searchable:!0,"create-option":!1,"track-by":"value",options:l.serviceLocations.map(t=>({value:t.id,label:t.name})),placeholder:s.$t("select_service_locations")},null,8,["modelValue","options","placeholder"]),(a(!0),i(b,null,v(l.errors.service_location_id,(t,n)=>(a(),i("span",{key:n,class:"text-danger"},r(t),1))),128))])]),e("div",ne,[e("div",ie,[e("label",de,[u(r(s.$t("transport_type"))+" ",1),o[18]||(o[18]=e("span",{class:"text-danger"},"*",-1))]),g(e("select",{id:"transport_type",class:"form-select","onUpdate:modelValue":o[2]||(o[2]=t=>l.form.transport_type=t)},[e("option",me,r(s.$t("select")),1),e("option",ce,r(s.$t("taxi")),1),e("option",ue,r(s.$t("delivery")),1),e("option",_e,r(s.$t("all")),1)],512),[[Y,l.form.transport_type]]),(a(!0),i(b,null,v(l.errors.transport_type,(t,n)=>(a(),i("span",{key:n,class:"text-danger"},r(t),1))),128))])]),e("div",fe,[e("div",pe,[e("label",ve,[u(r(s.$t("users"))+" ",1),o[19]||(o[19]=e("span",{class:"text-danger"},"*",-1))]),m(k,{id:"select_users",mode:"tags",modelValue:l.form.user_id,"onUpdate:modelValue":o[3]||(o[3]=t=>l.form.user_id=t),"close-on-select":!1,searchable:!0,"create-option":!1,label:"label",onSearchChange:l.inputsearch,options:l.users.map(t=>({value:t.id,label:t.name,mobile:t.mobile})),placeholder:s.$t("select_users"),"search-function":C.customSearch,"filter-results":!1,"no-options-text":s.$t("no_users_found")},null,8,["modelValue","onSearchChange","options","placeholder","search-function","no-options-text"]),(a(!0),i(b,null,v(l.errors.user_ids,(t,n)=>(a(),i("span",{key:n,class:"text-danger"},r(t),1))),128))])]),e("div",be,[e("div",ge,[e("label",he,r(s.$t("user_specific")),1),g(e("input",{type:"checkbox",id:"select_all_user","onUpdate:modelValue":o[4]||(o[4]=t=>l.form.user_specific=t),class:"form-check-input",checked:l.form.user_id?l.form.user_id.length>0:!1},null,8,ye),[[Z,l.form.user_specific]])])]),e("div",ke,[e("div",xe,[e("label",we,[u(r(s.$t("code"))+" ",1),o[20]||(o[20]=e("span",{class:"text-danger"},"*",-1))]),g(e("input",{type:"text",class:"form-control",placeholder:s.$t("enter_code"),id:"code","onUpdate:modelValue":o[5]||(o[5]=t=>l.form.code=t)},null,8,Ce),[[w,l.form.code]]),(a(!0),i(b,null,v(l.errors.code,(t,n)=>(a(),i("span",{key:n,class:"text-danger"},r(t),1))),128))])]),e("div",Me,[e("div",Ve,[e("label",Be,[u(r(s.$t("minimum_trip_amount"))+" ",1),o[21]||(o[21]=e("span",{class:"text-danger"},"*",-1))]),g(e("input",{type:"text",class:"form-control",placeholder:s.$t("enter_minimum_trip_amount"),id:"minimum_trip_amount","onUpdate:modelValue":o[6]||(o[6]=t=>l.form.minimum_trip_amount=t)},null,8,Le),[[w,l.form.minimum_trip_amount]]),(a(!0),i(b,null,v(l.errors.minimum_trip_amount,(t,n)=>(a(),i("span",{key:n,class:"text-danger"},r(t),1))),128))])]),e("div",Se,[e("div",Ue,[e("label",qe,[u(r(s.$t("maximum_discount_amount"))+" ",1),o[22]||(o[22]=e("span",{class:"text-danger"},"*",-1))]),g(e("input",{type:"text",class:"form-control",placeholder:s.$t("enter_maximum_discount_amount"),id:"maximum_discount_amount","onUpdate:modelValue":o[7]||(o[7]=t=>l.form.maximum_discount_amount=t)},null,8,He),[[w,l.form.maximum_discount_amount]]),(a(!0),i(b,null,v(l.errors.maximum_discount_amount,(t,n)=>(a(),i("span",{key:n,class:"text-danger"},r(t),1))),128))])]),e("div",Fe,[e("div",Pe,[e("label",Re,[u(r(s.$t("cummulative_maximum_discount_amount"))+" ",1),o[23]||(o[23]=e("span",{class:"text-danger"},"*",-1))]),g(e("input",{type:"text",class:"form-control",placeholder:s.$t("enter_cummulative_maximum_discount_amount"),id:"cummulative_maximum_discount_amount","onUpdate:modelValue":o[8]||(o[8]=t=>l.form.cummulative_maximum_discount_amount=t)},null,8,Te),[[w,l.form.cummulative_maximum_discount_amount]]),(a(!0),i(b,null,v(l.errors.cummulative_maximum_discount_amount,(t,n)=>(a(),i("span",{key:n,class:"text-danger"},r(t),1))),128))])]),e("div",De,[e("div",Ne,[e("label",je,[u(r(s.$t("discount_percentage"))+" ",1),o[24]||(o[24]=e("span",{class:"text-danger"},"*",-1))]),g(e("input",{type:"text",class:"form-control",placeholder:s.$t("enter_discount_percentage"),id:"discount_percent","onUpdate:modelValue":o[9]||(o[9]=t=>l.form.discount_percent=t)},null,8,Ae),[[w,l.form.discount_percent]]),(a(!0),i(b,null,v(l.errors.discount_percent,(t,n)=>(a(),i("span",{key:n,class:"text-danger"},r(t),1))),128))])]),e("div",Oe,[e("div",Ee,[e("label",ze,[u(r(s.$t("from_to_date"))+" ",1),o[25]||(o[25]=e("span",{class:"text-danger"},"*",-1))]),m(x,{placeholder:s.$t("select_date"),modelValue:l.form.date,"onUpdate:modelValue":o[10]||(o[10]=t=>l.form.date=t),config:l.rangeDateconfig,class:"form-control flatpickr-input",id:"demo-datepicker"},null,8,["placeholder","modelValue","config"]),(a(!0),i(b,null,v(l.errors.date,(t,n)=>(a(),i("span",{key:n,class:"text-danger"},r(t),1))),128))])]),e("div",Ie,[e("div",Je,[e("label",Ke,[u(r(s.$t("how_many_times_the_user_can_use_same_promo_code"))+" ",1),o[26]||(o[26]=e("span",{class:"text-danger"},"*",-1))]),g(e("input",{type:"text",class:"form-control",placeholder:s.$t("enter_how_many_times_the_user_can_use_same_promo_code"),id:"uses_per_user","onUpdate:modelValue":o[11]||(o[11]=t=>l.form.uses_per_user=t)},null,8,We),[[w,l.form.uses_per_user]]),(a(!0),i(b,null,v(l.errors.uses_per_user,(t,n)=>(a(),i("span",{key:n,class:"text-danger"},r(t),1))),128))])]),e("div",Ye,[e("div",Ze,[e("button",Ge,r(_.promo?s.$t("update"):s.$t("save")),1)])])])]),_:1},8,["form","rules"])],32)]),_:1})]),_:1})]),_:1})]),_:1}),e("div",null,[l.successMessage?(a(),i("div",Xe,[e("div",Qe,[o[27]||(o[27]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),o[28]||(o[28]=e("strong",null,"Success",-1)),u(" - "+r(l.successMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-success",onClick:o[13]||(o[13]=(...t)=>l.dismissMessage&&l.dismissMessage(...t)),"aria-label":"Close Success Message"})])])):T("",!0),l.alertMessage?(a(),i("div",$e,[e("div",eo,[o[29]||(o[29]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),o[30]||(o[30]=e("strong",null,"Alert",-1)),u(" - "+r(l.alertMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-danger",onClick:o[14]||(o[14]=(...t)=>l.dismissMessage&&l.dismissMessage(...t)),"aria-label":"Close Alert Message"})])])):T("",!0)]),m(L,{modelValue:f.promocode,"onUpdate:modelValue":o[16]||(o[16]=t=>f.promocode=t),"hide-footer":"",title:s.$t("promo_code"),class:"v-modal-custom",size:"lg"},{default:p(()=>[o[32]||(o[32]=e("p",{class:"text-muted mb-0"},"How Coupon Works:",-1)),o[33]||(o[33]=e("div",{class:"d-flex mt-4"},[e("div",{class:"flex-shrink-0"},[e("i",{class:"ri-checkbox-circle-fill text-success"})]),e("div",{class:"flex-grow-1 ms-2"},[e("p",{class:"text-muted mb-0"}," The coupon code will work based on its settings, such as the date range, how many times each user can use it, the total number of uses, maximum discount, and minimum trip amount. ")])],-1)),o[34]||(o[34]=e("div",{class:"d-flex mt-4"},[e("div",{class:"flex-shrink-0"},[e("i",{class:"ri-checkbox-circle-fill text-success"})]),e("div",{class:"flex-grow-1 ms-2"},[e("p",{class:"text-muted mb-0"}," The driver will still receive the full payment, so they won't be affected by rides where a coupon is applied. ")])],-1)),o[35]||(o[35]=e("div",{class:"swiper-pagination dynamic-pagination"},null,-1)),e("div",oo,[m(M,{href:"javascript:void(0);",class:"btn btn-link link-success fw-medium",onClick:o[15]||(o[15]=t=>f.promocode=!1)},{default:p(()=>[...o[31]||(o[31]=[e("i",{class:"ri-close-line me-1 align-middle"},null,-1),u(" Close ",-1)])]),_:1})])]),_:1},8,["modelValue","title"])]),_:1})}const co=D(oe,[["render",so]]);export{co as default};
