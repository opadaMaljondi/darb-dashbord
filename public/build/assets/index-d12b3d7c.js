import{_ as q,Z as G,O as J,P as K,B as W,D as Z,r as m,T as j,R as Q,S as X,g as d,i as c,y as O,w as u,W as x,a as V,N as $,l,n as e,J as r,t as ee,K as te,k as _,L as E,F,q as se,p as ae,z as M,C as I}from"./vendor-54d6cb1e.js";import{L as oe}from"./main-b839be26.js";import{P as ne}from"./page-header-ff719701.js";import{P as re}from"./Pagination-b5e3d5c9.js";import{s as le}from"./search-06463c60.js";import{s as ie}from"./searchbar-3bdb3315.js";import{u as de,l as ce}from"./footer-7e4f68d9.js";import{_ as ue}from"./search-file-ab3e1046.js";import"./app-cb082573.js";const ge={data(){return{rightOffcanvas:!1}},components:{Layout:oe,PageHeader:ne,Head:G,Pagination:re,Multiselect:J,flatPickr:K,Link:W,search:le,searchbar:ie},props:{successMessage:String,alertMessage:String,app_for:String},setup(o){const{t}=Z(),b=m(""),{selectedLocation:s}=de(),y=j({driver_service_location:"all",limit:10}),w=m([]),p=m({}),C=m(!1),g=m(!1),S=m(null),P=m({}),k=m(o.successMessage||""),B=m(o.alertMessage||""),L=()=>{k.value="",B.value=""},D=n=>o.app_for&&o.app_for=="demo"?"***********":n.mobile,H=()=>{g.value=!0},N=()=>{y.reset(),v(),g.value=!1},a=async n=>{x.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!"}).then(async i=>{if(i.isConfirmed)try{await f(n)}catch(h){console.error(t("error_deleting_data"),h),x.fire(t("error"),t("failed_to_delete_the_data"),"error")}})},T=()=>{C.value=!1},f=async n=>{try{await V.delete(`/drivers-rating/delete/${n}`);const i=w.value.findIndex(h=>h.id===n);i!==-1&&w.value.splice(i,1),C.value=!1,x.fire("success",t("driver_rating_deleted_successfully"),"success")}catch{x.fire(t("error"),t("failed_to_delete_driver_rating"),"error")}},v=async(n=1)=>{try{const i=y.data();b.value.length>0&&(i.search=b.value),i.page=n;const h=await V.get("/drivers-rating/list",{params:i});w.value=h.data.results,p.value=h.data.paginator,Y(p.value.total),g.value=!1}catch(i){console.error(t("error_fetching_drivers_rating"),i)}},R=async n=>{b.value=n,v()},A=n=>(p.value.current_page-1)*p.value.per_page+n+1,z=async n=>{localStorage.setItem("drivers-rating/list",n),v(n)};Q(s,n=>{console.log("value",n),y.driver_service_location=n,v()});const U=async n=>{$.get(`/drivers-rating/view-profile/${n.id}`)},Y=()=>{P.value=[10,25,50,100,200,500]};return{results:w,modalShow:C,deleteItemId:S,successMessage:k,alertMessage:B,filterData:H,deleteModal:a,closeModal:T,mobileFromUser:D,deleteData:f,dismissMessage:L,SerialNumber:A,fetchSearch:R,searchTerm:b,paginator:p,modalFilter:g,clearFilter:N,fetchDatas:v,filter:y,handlePageChanged:z,viewProfile:U,paginatorOption:P,changeEntriesPerPage:()=>{v()},selectedLocation:s}},computed:{...ce,...X(["permissions"])},mounted(){this.filter.driver_service_location=this.selectedLocation,this.fetchDatas();const o=localStorage.getItem("drivers-rating/list");o?this.handlePageChanged(Number(o)):this.handlePageChanged(1)}},me={class:"d-flex align-items-center mt-3"},_e={class:"me-2 text-muted"},fe=["value"],pe={class:"ms-2 text-muted"},ve={class:"d-flex align-items-center gap-2"},he={class:"table-responsive"},be={class:"table align-middle position-relative table-nowrap"},ye={class:"table-active"},we={scope:"col"},Ce={scope:"col"},Pe={scope:"col"},Me={scope:"col"},ke={scope:"col"},Be={key:0},xe={class:"dropdown"},Se={class:"dropdown-menu dropdown-menu-end"},Le={key:1},De={colspan:"7",class:"text-center"},He={key:0,class:"custom-alert alert alert-success alert-border-left fade show",data:"alert",id:"alertMsg"},Ne={class:"alert-content"},Te={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",data:"alert",id:"alertMsg"},Ee={class:"alert-content"};function Fe(o,t,b,s,y,w){const p=d("Head"),C=d("PageHeader"),g=d("BCol"),S=d("searchbar"),P=d("BRow"),k=d("BCardHeader"),B=d("Link"),L=d("BCardBody"),D=d("BCard"),H=d("Pagination"),N=d("Layout");return c(),O(N,null,{default:u(()=>[l(p,{title:"Drivers Rating"}),l(C,{title:o.$t("driver_rating"),pageTitle:o.$t("driver_rating")},null,8,["title","pageTitle"]),l(P,null,{default:u(()=>[l(g,{lg:"12"},{default:u(()=>[l(D,{"no-body":"",id:"tasksList"},{default:u(()=>[l(k,{class:"border-0"},{default:u(()=>[l(P,{class:"g-2"},{default:u(()=>[l(g,{md:"3"},{default:u(()=>[e("div",me,[e("label",_e,r(o.$t("show")),1),ee(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>s.filter.limit=a),onChange:t[1]||(t[1]=(...a)=>s.changeEntriesPerPage&&s.changeEntriesPerPage(...a)),class:"form-select form-select-sm w-auto"},[(c(!0),_(F,null,E(s.paginatorOption,a=>(c(),_("option",{key:a,value:a},r(a),9,fe))),128))],544),[[te,s.filter.limit]]),e("label",pe,r(o.$t("entries")),1)])]),_:1}),l(g,{md:"3"}),l(g,{md:"auto",class:"ms-auto"},{default:u(()=>[e("div",ve,[l(S,{onSearch:s.fetchSearch},null,8,["onSearch"])])]),_:1})]),_:1})]),_:1}),l(L,{class:"border border-dashed border-end-0 border-start-0"},{default:u(()=>[e("div",he,[e("table",be,[e("thead",ye,[e("tr",null,[e("th",we,r(o.$t("name")),1),e("th",Ce,r(o.$t("transport_type")),1),e("th",Pe,r(o.$t("mobile_number")),1),e("th",Me,r(o.$t("rating")),1),e("th",ke,r(o.$t("action")),1)])]),s.results.length>0?(c(),_("tbody",Be,[(c(!0),_(F,null,E(s.results,(a,T)=>(c(),_("tr",{key:T},[e("td",null,r(a.name),1),e("td",null,r(a.transport_type),1),e("td",null,r(a.mobile),1),e("td",null,[e("div",null,[(c(),_(F,null,E(5,f=>e("i",{key:f,class:se([{"bx bxs-star":f<=Math.floor(a.rating),"bx bxs-star-half":f===Math.ceil(a.rating)&&a.rating%1!==0,"bx bx-star":f>a.rating},"align-center text-muted me-2"])},null,2)),64))])]),e("td",null,[e("div",xe,[t[5]||(t[5]=e("a",{class:"text-reset",href:"#","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},[e("span",{class:"text-muted fs-18"},[e("i",{class:"mdi mdi-dots-vertical"})])],-1)),e("ul",Se,[o.permissions.includes("driver-rating-view")?(c(),O(B,{key:0,class:"dropdown-item",onClick:ae(f=>s.viewProfile(a),["prevent"])},{default:u(()=>[t[4]||(t[4]=e("i",{class:"bx bx-show-alt align-center text-muted me-2"},null,-1)),M(" "+r(o.$t("view")),1)]),_:1},8,["onClick"])):I("",!0)])])])]))),128))])):(c(),_("tbody",Le,[e("tr",null,[e("td",De,[t[6]||(t[6]=e("img",{src:ue,alt:"Loading...",style:{width:"100px"}},null,-1)),e("h5",null,r(o.$t("no_data_found")),1)])])]))])])]),_:1})]),_:1})]),_:1})]),_:1}),e("div",null,[s.successMessage?(c(),_("div",He,[e("div",Ne,[t[7]||(t[7]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),t[8]||(t[8]=M()),t[9]||(t[9]=e("strong",null,"Success",-1)),M(" - "+r(s.successMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-success",onClick:t[2]||(t[2]=(...a)=>s.dismissMessage&&s.dismissMessage(...a)),"aria-label":"Close Success Message"})])])):I("",!0),s.alertMessage?(c(),_("div",Te,[e("div",Ee,[t[10]||(t[10]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),t[11]||(t[11]=M()),t[12]||(t[12]=e("strong",null,"Alert",-1)),M(" - "+r(s.alertMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-danger",onClick:t[3]||(t[3]=(...a)=>s.dismissMessage&&s.dismissMessage(...a)),"aria-label":"Close Alert Message"})])])):I("",!0)]),l(H,{paginator:s.paginator,onPageChanged:s.handlePageChanged},null,8,["paginator","onPageChanged"])]),_:1})}const Je=q(ge,[["render",Fe]]);export{Je as default};
