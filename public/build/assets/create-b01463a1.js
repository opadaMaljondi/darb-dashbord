import{_ as N,Z as P,O as T,D as j,r as g,T as E,o as z,g as v,i as l,y as J,w as k,a as B,N as A,l as b,n as s,k as i,z as u,J as a,t as y,K as V,F as c,L as m,C as M,M as R,p as K}from"./vendor-8caf5d52.js";import{L as Z}from"./main-cc7bd0ce.js";import{P as G}from"./page-header-18309276.js";import{P as Q}from"./Pagination-0518e4bd.js";import{i as W}from"./imageUpload-5fcb01e8.js";import{F as X}from"./FormValidation-f14f6003.js";import{I as Y}from"./ImageUpload-fc3b7bc8.js";import"./footer-502c2797.js";import"./app-974c65a1.js";/* empty css                                                    */const $={components:{Layout:Z,PageHeader:G,Head:P,Pagination:Q,Multiselect:T,FormValidation:X,imageUpload:W,ImageUpload:Y},props:{successMessage:String,alertMessage:String,countries:Array,serviceLocation:Array,owner:Object,driver:Object},setup(r){var O;const{t:o}=j(),f=g([]),e=E({owner_id:r.driver&&r.driver.owner_id||"",service_location_id:r.driver&&r.driver.service_location_id||"",country:r.driver?r.driver.country||"":"null",name:r.driver&&r.driver.name||"",mobile:r.driver&&r.driver.mobile||"",email:r.driver&&r.driver.email||"",transport_type:r.driver&&r.driver.transport_type||"",password:"",confirm_password:"",gender:r.driver&&r.driver.gender||"",profile_picture:r.driver&&r.driver.profile_picture||""}),q={owner_id:{required:!0},name:{required:!0},service_location_id:{required:!0},country:{required:!0},mobile:{required:!0,regex:/^\d+$/},gender:{required:!0},profile_picture:{required:!0}},I=g(null),w=g({}),S=g(!1),C=g(r.successMessage||""),p=g(r.alertMessage||""),x=g((O=r.owner)==null?void 0:O.name),L=g(r.countries),F=()=>{C.value="",p.value=""},D=n=>{const _=n.target.files[0];e.profile_picture=_,_&&new FileReader().readAsDataURL(_)},H=g(r.driver?r.driver.profile_picture:"/default-profile.jpeg"),U=async()=>{try{const n=await B.get("/fleet-drivers/list-owners",{params:{service_location_id:e.service_location_id}});f.value=n.data.results||[]}catch(n){console.error("Error fetching owners:",n),f.value=[]}};return z(()=>{var n,_;r.driver||(e.owner_id=(n=r.owner)==null?void 0:n.id,e.service_location_id=(_=r.owner)==null?void 0:_.service_location_id),e.service_location_id&&U()}),{form:e,successMessage:C,alertMessage:p,handleSubmit:async()=>{if(w.value=I.value.validate(),!(Object.keys(w.value).length>0))try{if(e.mobile&&(!r.driver||e.mobile!==r.driver.mobile)&&(await B.get(`/fleet-drivers/check-mobile/${e.mobile}${r.driver?`/${r.driver.id}`:""}`)).data.exists){w.value.mobile=o("mobile_number_already_exists");return}if(e.email&&(!r.driver||e.email!==r.driver.email)&&(await B.get(`/fleet-drivers/check-email/${e.email}${r.driver?`/${r.driver.id}`:""}`)).data.exists){w.value.email=o("email_already_exists");return}const n=new FormData;for(const h in e)h==="iconFile"&&e[h]?n.append("profile_picture",e[h]):n.append(h,e[h]);let _;S.value=!0,r.driver&&r.driver.id?_=await B.post(`/fleet-drivers/update/${r.driver.id}`,n):_=await B.post("/fleet-drivers/store",n),_.status===201?(C.value=o("fleet_drivers_created_successfully"),e.reset(),r.driver&&r.driver.approve==1?A.get("/fleet-drivers"):A.get("/fleet-drivers/pending")):p.value=o("failed_to_create_fleet_drivers")}catch(n){n.response&&n.response.status===422?w.value=n.response.data.errors:(console.error(o("error_creating_fleet_drivers"),n),p.value=o("failed_to_create_fleet_drivers_catch"))}},dismissMessage:F,owner_name:x,onFileChange:D,validationRules:q,validationRef:I,imageSrc:H,countries:L,fetchOwners:U,owners:f,errors:w,handleImageSelected:(n,_)=>{e[_]=n},handleImageRemoved:n=>{e[n]=null},isButtonDisabled:S}}},ee={class:"row"},re={key:0,class:"col-sm-6"},se={class:"mb-3"},oe={for:"service_location_id",class:"form-label"},te={value:"",disabled:""},le=["value"],ae={key:1,class:"col-sm-6"},ie={class:"mb-3"},ne={for:"owner",class:"form-label"},de={value:"",disabled:""},ce=["value"],me={class:"col-sm-6"},_e={class:"mb-3"},ue={for:"country",class:"form-label"},fe={disabled:"",value:""},ve=["value"],ge={class:"col-sm-6"},be={class:"mb-3"},ye={for:"name",class:"form-label"},we=["placeholder"],he={class:"col-sm-6"},pe={class:"mb-3"},ke={for:"mobile_number",class:"form-label"},Me=["placeholder"],Ce={class:"col-sm-6"},Be={class:"mb-3"},Re={for:"email",class:"form-label"},Se=["placeholder"],Ue={key:2,class:"col-sm-6"},Ve={class:"mb-3"},Ie={for:"password",class:"form-label"},xe=["placeholder"],Le={key:3,class:"col-sm-6"},Fe={class:"mb-3"},De={for:"confirm_password",class:"form-label"},He=["placeholder"],qe={class:"col-sm-6"},Oe={class:"mb-3"},Ae={for:"select_gender",class:"form-label"},Ne={disabled:"",value:""},Pe={value:"male"},Te={value:"female"},je={value:"others"},Ee={class:"col-12"},ze={class:"mb-3 row"},Je={for:"icon",class:"form-label d-flex"},Ke={class:"col-sm-6"},Ze={class:"col-lg-12"},Ge={class:"text-end"},Qe=["disabled"],We={key:0,class:"custom-alert alert alert-success alert-border-left fade show",role:"alert",id:"alertMsg"},Xe={class:"alert-content"},Ye={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",role:"alert",id:"alertMsg"},$e={class:"alert-content"};function er(r,o,f,e,q,I){const w=v("Head"),S=v("PageHeader"),C=v("BCardHeader"),p=v("ImageUpload"),x=v("FormValidation"),L=v("BCardBody"),F=v("BCard"),D=v("BCol"),H=v("BRow"),U=v("Layout");return l(),J(U,null,{default:k(()=>[b(w,{title:"Approved Drivers"}),b(S,{title:r.$t("create"),pageTitle:r.$t("approved_drivers"),pageLink:"/fleet-drivers"},null,8,["title","pageTitle"]),b(H,null,{default:k(()=>[b(D,{lg:"12"},{default:k(()=>[b(F,{"no-body":"",id:"tasksList"},{default:k(()=>[b(C,{class:"border-0"}),b(L,{class:"border border-dashed border-end-0 border-start-0"},{default:k(()=>[s("form",{onSubmit:o[12]||(o[12]=K((...t)=>e.handleSubmit&&e.handleSubmit(...t),["prevent"]))},[b(x,{form:e.form,rules:e.validationRules,ref:"validationRef"},{default:k(()=>[s("div",ee,[f.owner?M("",!0):(l(),i("div",re,[s("div",se,[s("label",oe,[u(a(r.$t("select_area"))+" ",1),o[15]||(o[15]=s("span",{class:"text-danger"},"*",-1))]),y(s("select",{class:"form-control",id:"service_location_id","onUpdate:modelValue":o[0]||(o[0]=t=>e.form.service_location_id=t),onChange:o[1]||(o[1]=(...t)=>e.fetchOwners&&e.fetchOwners(...t))},[s("option",te,a(r.$t("select_area")),1),(l(!0),i(c,null,m(f.serviceLocation,t=>(l(),i("option",{key:t.id,value:t.id},a(t.name),9,le))),128))],544),[[V,e.form.service_location_id]]),(l(!0),i(c,null,m(e.errors.service_location_id,(t,d)=>(l(),i("span",{key:d,class:"text-danger"},a(t),1))),128))])])),f.owner?M("",!0):(l(),i("div",ae,[s("div",ie,[s("label",ne,[u(a(r.$t("owner"))+" ",1),o[16]||(o[16]=s("span",{class:"text-danger"},"*",-1))]),y(s("select",{class:"form-control",id:"owner","onUpdate:modelValue":o[2]||(o[2]=t=>e.form.owner_id=t)},[s("option",de,a(r.$t("select_owner")),1),(l(!0),i(c,null,m(e.owners,t=>(l(),i("option",{key:t.id,value:t.id},a(t.company_name),9,ce))),128))],512),[[V,e.form.owner_id]]),(l(!0),i(c,null,m(e.errors.owner_id,(t,d)=>(l(),i("span",{key:d,class:"text-danger"},a(t),1))),128))])])),s("div",me,[s("div",_e,[s("label",ue,[u(a(r.$t("country"))+" ",1),o[17]||(o[17]=s("span",{class:"text-danger"},"*",-1))]),y(s("select",{id:"select_country",class:"form-select","onUpdate:modelValue":o[3]||(o[3]=t=>e.form.country=t)},[s("option",fe,a(r.$t("choose_country")),1),(l(!0),i(c,null,m(e.countries,t=>(l(),i("option",{key:t.id,value:t.id},a(t.name),9,ve))),128))],512),[[V,e.form.country]]),(l(!0),i(c,null,m(e.errors.country,(t,d)=>(l(),i("span",{key:d,class:"text-danger"},a(t),1))),128))])]),s("div",ge,[s("div",be,[s("label",ye,[u(a(r.$t("name"))+" ",1),o[18]||(o[18]=s("span",{class:"text-danger"},"*",-1))]),y(s("input",{type:"text",class:"form-control",placeholder:r.$t("enter_name"),id:"name","onUpdate:modelValue":o[4]||(o[4]=t=>e.form.name=t)},null,8,we),[[R,e.form.name]]),(l(!0),i(c,null,m(e.errors.name,(t,d)=>(l(),i("span",{key:d,class:"text-danger"},a(t),1))),128))])]),s("div",he,[s("div",pe,[s("label",ke,[u(a(r.$t("enter_mobile_number"))+" ",1),o[19]||(o[19]=s("span",{class:"text-danger"},"*",-1))]),y(s("input",{type:"text",class:"form-control",placeholder:r.$t("enter_mobile_number"),id:"mobile_number","onUpdate:modelValue":o[5]||(o[5]=t=>e.form.mobile=t)},null,8,Me),[[R,e.form.mobile]]),(l(!0),i(c,null,m(e.errors.mobile,(t,d)=>(l(),i("span",{key:d,class:"text-danger"},a(t),1))),128))])]),s("div",Ce,[s("div",Be,[s("label",Re,[u(a(r.$t("email"))+" ",1),o[20]||(o[20]=s("span",{class:"text-danger"},"*",-1))]),y(s("input",{type:"email",class:"form-control",placeholder:r.$t("enter_email"),id:"email","onUpdate:modelValue":o[6]||(o[6]=t=>e.form.email=t)},null,8,Se),[[R,e.form.email]]),(l(!0),i(c,null,m(e.errors.email,(t,d)=>(l(),i("span",{key:d,class:"text-danger"},a(t),1))),128))])]),f.driver?M("",!0):(l(),i("div",Ue,[s("div",Ve,[s("label",Ie,[u(a(r.$t("password"))+" ",1),o[21]||(o[21]=s("span",{class:"text-danger"},"*",-1))]),y(s("input",{type:"password",class:"form-control",placeholder:r.$t("enter_password"),id:"password","onUpdate:modelValue":o[7]||(o[7]=t=>e.form.password=t)},null,8,xe),[[R,e.form.password]]),(l(!0),i(c,null,m(e.errors.password,(t,d)=>(l(),i("span",{key:d,class:"text-danger"},a(t),1))),128))])])),f.driver?M("",!0):(l(),i("div",Le,[s("div",Fe,[s("label",De,[u(a(r.$t("confirm_password"))+" ",1),o[22]||(o[22]=s("span",{class:"text-danger"},"*",-1))]),y(s("input",{type:"password",class:"form-control",placeholder:r.$t("confirm_password"),id:"confirm_password","onUpdate:modelValue":o[8]||(o[8]=t=>e.form.confirm_password=t)},null,8,He),[[R,e.form.confirm_password]]),(l(!0),i(c,null,m(e.errors.confirm_password,(t,d)=>(l(),i("span",{key:d,class:"text-danger"},a(t),1))),128))])])),s("div",qe,[s("div",Oe,[s("label",Ae,[u(a(r.$t("gender"))+" ",1),o[23]||(o[23]=s("span",{class:"text-danger"},"*",-1))]),y(s("select",{id:"select_gender",class:"form-select","onUpdate:modelValue":o[9]||(o[9]=t=>e.form.gender=t)},[s("option",Ne,a(r.$t("select")),1),s("option",Pe,a(r.$t("male")),1),s("option",Te,a(r.$t("female")),1),s("option",je,a(r.$t("others")),1)],512),[[V,e.form.gender]]),(l(!0),i(c,null,m(e.errors.gender,(t,d)=>(l(),i("span",{key:d,class:"text-danger"},a(t),1))),128))])]),s("div",Ee,[s("div",ze,[s("label",Je,a(r.$t("profile")),1),s("div",Ke,[b(p,{imageType:"driver",initialImageUrl:e.form.profile_picture,flexStyle:"0 0 calc(50% - 20px)",aspectRatio:"5 / 5",onImageSelected:o[10]||(o[10]=t=>e.handleImageSelected(t,"profile_picture")),onImageRemoved:o[11]||(o[11]=()=>e.handleImageRemoved("profile_picture"))},null,8,["initialImageUrl"]),(l(!0),i(c,null,m(e.errors.profile_picture,(t,d)=>(l(),i("span",{key:d,class:"text-danger"},a(t),1))),128))])])]),s("div",Ze,[s("div",Ge,[s("button",{type:"submit",class:"btn btn-primary",disabled:e.isButtonDisabled},a(f.driver?r.$t("update"):r.$t("save")),9,Qe)])])])]),_:1},8,["form","rules"])],32)]),_:1})]),_:1})]),_:1})]),_:1}),s("div",null,[e.successMessage?(l(),i("div",We,[s("div",Xe,[o[24]||(o[24]=s("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),o[25]||(o[25]=s("strong",null,"Success",-1)),u(" - "+a(e.successMessage)+" ",1),s("button",{type:"button",class:"btn-close btn-close-success",onClick:o[13]||(o[13]=(...t)=>e.dismissMessage&&e.dismissMessage(...t)),"aria-label":"Close Success Message"})])])):M("",!0),e.alertMessage?(l(),i("div",Ye,[s("div",$e,[o[26]||(o[26]=s("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),o[27]||(o[27]=s("strong",null,"Alert",-1)),u(" - "+a(e.alertMessage)+" ",1),s("button",{type:"button",class:"btn-close btn-close-danger",onClick:o[14]||(o[14]=(...t)=>e.dismissMessage&&e.dismissMessage(...t)),"aria-label":"Close Alert Message"})])])):M("",!0)])]),_:1})}const _r=N($,[["render",er]]);export{_r as default};
