import{_ as N,B as O,Z as Q,S as Y,T as G,D as J,r as f,R as q,o as K,g as c,U as W,i as u,y as L,w as l,a as x,W as v,l as i,n as o,z as I,J as d,t as j,M as Z,q as z,k as y,C as h,p as U,L as X,F as $}from"./vendor-8caf5d52.js";import{L as ee}from"./main-cc7bd0ce.js";import{P as te}from"./page-header-18309276.js";import{l as oe}from"./footer-502c2797.js";import{I as se}from"./ImageUpload-fc3b7bc8.js";import"./app-974c65a1.js";const re={components:{Layout:ee,PageHeader:te,Link:O,Head:Q,ImageUpload:se},computed:{...oe,...Y(["permissions"])},props:{app_for:String},setup(){const s=G({name:null,icon:null}),{t:e}=J(),m=f(null),t=f([]),V=f({}),k=f(""),C=f(""),B=f(""),g=f(10),P=f(1),w=f(0),_=async()=>{try{const r=await x.get("/preferences/list",{params:{page:P.value,perPage:g.value,searchQuery:B.value}});t.value=r.data.results,V.value={currentPage:r.data.paginator.current_page,lastPage:r.data.paginator.last_page,from:r.data.paginator.from,to:r.data.paginator.to,total:r.data.paginator.total},w.value=r.data.paginator.total}catch(r){console.error(e("error_fetching_preferences"),r)}},T=()=>{k.value="",C.value=""},M=()=>{s.reset(),m.value=null},E=r=>{m.value=r,s.icon=r.icon,s.name=r.name,s.clearErrors()},A=()=>{const{name:r,icon:n}=s,p={},b={name:{test:()=>!r,message:e("required")},icon:{test:()=>!n,message:e("required")}};return Object.keys(b).forEach(S=>{b[S].test()&&(p[S]=b[S].message)}),p},F=async()=>{const r=A();if(Object.keys(r).length===0)try{let n;m.value?n=await x.post(`/preferences/${m.value.id}`,s.data(),{headers:{"Content-Type":"multipart/form-data"}}):n=await x.post("/preferences",s.data(),{headers:{"Content-Type":"multipart/form-data"}}),k.value=n.data.successMessage,C.value=n.data.alertMessage,setTimeout(()=>{k.value="",C.value=""},2e3),_(),s.reset(),M()}catch(n){if(console.error(e("error_handling_form_submission"),n),n.response&&n.response.status===422){const p=n.response.data.errors;s.errors=p}else console.error(e("an_unexpected_error_occurred"),n)}else s.errors=r},R=r=>{s.errors[r]=""},a=async r=>{try{await x.delete(`/preferences/${r}`),v.fire("Success","Preference deleted successfully","success"),_()}catch(n){console.error(e("error_deleting_preference"),n),v.fire(e("error"),e("failed_to_delete_preference"),"error")}},D=async r=>{v.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!"}).then(async n=>{if(n.isConfirmed)try{await a(r)}catch(p){console.error(e("error_deleting_preference"),p),v.fire(e("error"),e("failed_to_delete_preference"),"error")}})},H=async(r,n)=>{v.fire({title:e("are_you_sure"),text:e("you_are_about_to_change_status"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:e("yes"),cancelButtonText:e("cancel")}).then(async p=>{if(p.isConfirmed)try{await x.post(`/preferences/update-status/${r}`,{id:r,status:n});const b=t.value.findIndex(S=>S.id===r);b!==-1&&(t.value[b].active=n),v.fire(e("changed"),e("status_updated_successfully"),"success")}catch(b){console.error(e("error_updating_status"),b),v.fire(e("error"),e("failed_to_update_status"),"error")}})};return q(P,()=>{_()}),q(B,()=>{_()}),K(()=>{_()}),{form:s,preferences:t,selectedPreference:m,paginator:V,successMessage:k,alertMessage:C,searchQuery:B,perPage:g,currentPage:P,rows:w,createPreference:M,editPreference:E,handleSubmit:F,deleteModal:D,deletePreference:a,dismissMessage:T,hideError:R,fetchPreferences:_,handleImageSelected:(r,n)=>{s[n]=r},handleImageRemoved:r=>{s[r]=null},toggleActiveStatus:H}}},ae={class:"form-group mt-3"},ne={for:"name",class:"form-label"},le=["readonly"],ie={key:0,class:"text-danger"},de={class:"form-group mt-3"},ce={class:"form-label"},ue={key:0,class:"text-danger"},me={class:"mt-4"},fe=["disabled"],ge={class:"table-responsive table-card mb-4"},_e={class:"table table-bordered align-middle table-nowrap mb-0 overflow-auto"},pe={class:"table-light"},be=["disabled","onClick","id","checked"],ve=["src"],ye={class:"d-flex"},he={class:"d-flex justify-content-sm-end"},Ce={key:0,class:"custom-alert alert alert-success alert-border-left fade show",language:"alert",id:"alertMsg"},we={class:"alert-content"},ke={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",language:"alert",id:"alertMsg"},Be={class:"alert-content"};function Pe(s,e,m,t,V,k){const C=c("Head"),B=c("PageHeader"),g=c("BCol"),P=c("ImageUpload"),w=c("BRow"),_=c("BCardHeader"),T=c("BCard"),M=c("BButton"),E=c("BCardBody"),A=c("b-pagination"),F=c("Layout"),R=W("b-tooltip");return u(),L(F,null,{default:l(()=>[i(C,{title:"Preferences"}),i(B,{title:s.$t("preferences"),pageTitle:s.$t("preferences")},null,8,["title","pageTitle"]),i(w,null,{default:l(()=>[i(g,{lg:"12"},{default:l(()=>[i(T,{"no-body":"",id:"tasksList"},{default:l(()=>[i(_,{class:"border-0"},{default:l(()=>[o("form",{onSubmit:e[5]||(e[5]=U((...a)=>t.handleSubmit&&t.handleSubmit(...a),["prevent"])),onKeydown:e[6]||(e[6]=(...a)=>t.hideError&&t.hideError(...a))},[i(w,null,{default:l(()=>[i(g,{md:"4"},{default:l(()=>[o("div",ae,[o("label",ne,[I(d(s.$t("name")),1),e[10]||(e[10]=o("span",{class:"text-danger"},"*",-1))]),j(o("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=a=>t.form.name=a),class:z(["form-control",{"is-invalid":t.form.errors.name}]),readonly:m.app_for=="demo"||!s.permissions.includes("create_preference"),onFocus:e[1]||(e[1]=a=>t.hideError("name"))},null,42,le),[[Z,t.form.name]]),t.form.errors.name?(u(),y("div",ie,d(t.form.errors.name),1)):h("",!0)])]),_:1}),i(g,{class:"ps-5",md:"4"},{default:l(()=>[o("div",de,[o("label",ce,d(s.$t("icon")),1),(u(),L(P,{imageType:"icon",initialImageUrl:t.form.icon,key:t.form.icon,flexStyle:"0 0 calc(30% - 20px)",aspectRatio:"1 / 1",onImageSelected:e[2]||(e[2]=a=>t.handleImageSelected(a,"icon")),onImageRemoved:e[3]||(e[3]=()=>t.handleImageRemoved("icon")),onChange:s.onFileChange},null,8,["initialImageUrl","onChange"])),t.form.errors.icon?(u(),y("div",ue,d(t.form.errors.icon),1)):h("",!0)])]),_:1}),i(g,{md:"4"},{default:l(()=>[o("div",me,[o("button",{disabled:m.app_for=="demo"||!s.permissions.includes("create_preference"),type:"submit",class:"btn btn-success m-2 float-start"},d(t.selectedPreference?s.$t("update"):s.$t("create")),9,fe),t.selectedPreference?(u(),y("button",{key:0,type:"button",onClick:e[4]||(e[4]=(...a)=>t.createPreference&&t.createPreference(...a)),class:"btn btn-secondary m-2 float-start"},d(s.$t("cancel")),1)):h("",!0)])]),_:1})]),_:1})],32)]),_:1})]),_:1}),i(T,null,{default:l(()=>[i(E,{class:"border border-dashed border-end-0 border-start-0"},{default:l(()=>[i(w,null,{default:l(()=>[i(g,{md:"12"},{default:l(()=>[o("div",ge,[o("table",_e,[o("thead",pe,[o("tr",null,[o("th",null,d(s.$t("s_no")),1),o("th",null,d(s.$t("name")),1),o("th",null,d(s.$t("status")),1),o("th",null,d(s.$t("icon")),1),o("th",null,d(s.$t("action")),1)])]),o("tbody",null,[(u(!0),y($,null,X(t.preferences,(a,D)=>(u(),y("tr",{key:a.id},[o("td",null,d((t.currentPage-1)*t.perPage+D+1),1),o("td",null,d(a.name),1),o("td",null,[o("div",{class:z({"form-check":!0,"form-switch":!0,"form-switch-lg":!0,"form-switch-success":a.active})},[o("input",{class:"form-check-input",disabled:!s.permissions.includes("toggle_preference"),type:"checkbox",role:"switch",onClick:U(H=>t.toggleActiveStatus(a.id,!a.active),["prevent"]),id:"status_"+a.id,checked:a.active},null,8,be)],2)]),o("td",null,[o("img",{src:a.icon,alt:"",class:"avatar-xs rounded-circle me-2"},null,8,ve)]),o("td",null,[o("div",ye,[s.permissions.includes("edit_preference")?j((u(),L(M,{key:0,onClick:U(H=>t.editPreference(a),["prevent"]),class:"btn btn-soft-warning btn-sm m-2",disabled:m.app_for=="demo","data-bs-toggle":"tooltip",title:s.$t("edit")},{default:l(()=>e[11]||(e[11]=[o("i",{class:"bx bxs-edit-alt bx-xs"},null,-1)])),_:2,__:[11]},1032,["onClick","disabled","title"])),[[R,void 0,void 0,{hover:!0}]]):h("",!0),m.app_for!="demo"&&s.permissions.includes("delete_preference")?j((u(),L(M,{key:1,class:"btn btn-soft-danger btn-sm m-2",size:"sm",type:"button",onClick:U(H=>t.deleteModal(a.id),["prevent"]),"data-bs-toggle":"tooltip",title:s.$t("delete")},{default:l(()=>e[12]||(e[12]=[o("i",{class:"bx bx-trash bx-xs"},null,-1)])),_:2,__:[12]},1032,["onClick","title"])),[[R,void 0,void 0,{hover:!0}]]):h("",!0)])])]))),128))])])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o("div",he,[i(A,{modelValue:t.currentPage,"onUpdate:modelValue":e[7]||(e[7]=a=>t.currentPage=a),"total-rows":t.rows,"per-page":t.perPage,"aria-controls":"my-table",align:"right"},null,8,["modelValue","total-rows","per-page"])]),t.successMessage?(u(),y("div",Ce,[o("div",we,[e[13]||(e[13]=o("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[14]||(e[14]=I()),e[15]||(e[15]=o("strong",null,"Success",-1)),I(" - "+d(t.successMessage)+" ",1),o("button",{type:"button",class:"btn-close btn-close-success",onClick:e[8]||(e[8]=(...a)=>t.dismissMessage&&t.dismissMessage(...a)),"aria-label":"Close Success Message"})])])):h("",!0),t.alertMessage?(u(),y("div",ke,[o("div",Be,[e[16]||(e[16]=o("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[17]||(e[17]=I()),e[18]||(e[18]=o("strong",null,"Alert",-1)),I(" - "+d(t.alertMessage)+" ",1),o("button",{type:"button",class:"btn-close btn-close-danger",onClick:e[9]||(e[9]=(...a)=>t.dismissMessage&&t.dismissMessage(...a)),"aria-label":"Close Alert Message"})])])):h("",!0)]),_:1})}const Ue=N(re,[["render",Pe]]);export{Ue as default};
