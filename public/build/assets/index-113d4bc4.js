import{_ as $,Z as ee,O as te,P as se,B as ae,D as oe,r as m,T as ne,R as le,S as ie,g as c,U as re,i as u,y as x,w as l,W as p,a as U,N as j,l as i,n as t,J as d,t as C,K as de,k as v,L as q,F as Y,z as b,C as w,H as ce,q as ue,p as H,X as Z}from"./vendor-54d6cb1e.js";import{L as fe}from"./main-b839be26.js";import{P as _e}from"./page-header-ff719701.js";import{P as me}from"./Pagination-b5e3d5c9.js";import{s as ge}from"./searchbar-3bdb3315.js";import{u as pe,l as ve}from"./footer-7e4f68d9.js";import{_ as he}from"./search-file-ab3e1046.js";import"./app-cb082573.js";const be={data(){return{rightOffcanvas:!1}},components:{Layout:fe,PageHeader:_e,Head:ee,Pagination:me,Multiselect:te,flatPickr:se,Link:ae,searchbar:ge},props:{successMessage:String,alertMessage:String,app_for:String,zones:{type:Object,required:!0},settings:Object},setup(o){const{t:e}=oe(),z=m(""),{selectedLocation:s}=pe(),k=ne({status:null,service_location_id:null,limit:10}),y=m([]),M=m({}),D=m(o.successMessage||""),g=m(o.alertMessage||""),L=m(!1),f=m(!1),T=m(null),P=m({}),O=m(o.settings.enable_peak_zone_feature==1),I=()=>{D.value="",g.value=""},A=async(n,r)=>{p.fire({title:e("are_you_sure"),text:e("you_are_about_to_change_status"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:e("yes"),cancelButtonText:e("cancel")}).then(async h=>{if(h.isConfirmed)try{await U.post("/zones/update-status",{id:n,status:r});const V=y.value.findIndex(Q=>Q.id===n);V!==-1&&(y.value[V].active=r),p.fire(e("changed"),e("status_updated_successfully"),"success")}catch(V){console.error(e("error_updating_status"),V),p.fire(e("error"),e("failed_to_update_status"),"error")}})},S=m(!1),F=()=>{_(),f.value=!0,S.value=!1},N=()=>{k.reset(),_(),S.value=!1},E=()=>{L.value=!1},B=async n=>{try{await U.delete(`/zones/delete/${n}`);const r=y.value.findIndex(h=>h.id===n);r!==-1&&y.value.splice(r,1),L.value=!1,p.fire(e("success"),e("zone_deleted_successfully"),"success")}catch(r){r.response&&r.response.status==403&&(g.value=r.response.data.alertMessage,setTimeout(()=>{g.value=""},5e3)),p.fire(e("error"),e("failed_to_delete_zone"),"error")}},a=async n=>{p.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!"}).then(async r=>{if(r.isConfirmed)try{await B(n)}catch(h){console.error(e("error_deleting_data"),h),p.fire(e("error"),e("failed_to_delete_the_data"),"error")}})},R=async n=>{z.value=n,_()},_=async(n=1)=>{try{const r=k.data();r.search=z.value,r.page=n;const h=await U.get("/zones/fetch",{params:r});y.value=h.data.results,M.value=h.data.paginator,X(M.value.total),f.value=!1,k.status!==""&&(r.status=k.status)}catch(r){console.error(e("error_fetching_zones"),r)}},G=async n=>{localStorage.setItem("zones/fetch",n),_(n)},J=async n=>{j.get(`/zones/edit/${n.id}`)},K=async n=>{j.get(`/zones/surge/${n.id}`)},W=async n=>{j.get(`/zones/map/${n.id}`)},X=()=>{P.value=[10,25,50,100,200,500]};return le(s,n=>{k.service_location_id=n,_()}),{results:y,deleteItemId:T,successMessage:D,alertMessage:g,filterData:F,deleteModal:a,closeModal:E,deleteData:B,dismissMessage:I,searchTerm:z,paginator:M,modalFilter:f,fetchSearch:R,clearFilter:N,fetchDatas:_,filter:k,selectedLocation:s,handlePageChanged:G,editData:J,mapData:W,toggleActiveStatus:A,surgeData:K,rightOffcanvas:S,paginatorOption:P,changeEntriesPerPage:()=>{_()},enable_peak_zone_feature:O,handleUpdate:async()=>{try{await U.post("/zones/peakzone-setting/update",{enable_peak_zone_feature:O.value?1:0}),p.fire(e("success"),e("peak_zone_settings_updated_successfully"),"success")}catch{p.fire(e("error"),e("failed_to_update_peak_zone_settings"),"error")}}}},computed:{...ve,...ie(["permissions"])},mounted(){this.filter.service_location_id=this.selectedLocation,this.fetchDatas();const o=localStorage.getItem("zones/fetch");o?this.handlePageChanged(Number(o)):this.handlePageChanged(1)}},ke={class:"d-flex align-items-center mt-3"},ye={class:"me-2 text-muted"},Ce=["value"],we={class:"ms-2 text-muted"},ze={class:"d-flex align-items-center gap-2"},Be={class:"card-header"},Me={class:"row"},Pe={class:"col-sm-6"},Se={class:"mb-3"},xe={class:"border rounded"},De={class:"row"},Le={class:"col"},Oe={class:"form-check-label p-2 mt-2",for:"enable_peak_zone_feature"},Ve={class:"col"},Ue={class:"form-check form-switch form-switch-md float-end p-2"},He=["disabled"],Te={class:"table"},Ie={class:"table align-middle position-relative table-nowrap"},Ae={class:"table-active"},Fe={scope:"col"},Ne={scope:"col"},Ee={scope:"col"},Re={key:0},je={class:"d-flex"},qe={class:"flex-grow-1"},Ye={key:0},Ze=["onClick","id","checked"],Ge={key:1},Je={colspan:"4",class:"text-center"},Ke={key:0,class:"custom-alert alert alert-success alert-border-left fade show",data:"alert",id:"alertMsg"},We={class:"alert-content"},Xe={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",data:"alert",id:"alertMsg"},Qe={class:"alert-content"},$e={class:"offcanvas-body"},et={class:"mb-4"},tt={for:"status-select",class:"form-label text-muted text-uppercase fw-semibold mb-3"},st={class:"form-check form-check-inline"},at={class:"form-check-label",for:"statusActive"},ot={class:"form-check form-check-inline"},nt={class:"form-check-label",for:"statusInactive"},lt={class:"offcanvas-footer border-top p-3 text-center hstack gap-2"};function it(o,e,z,s,k,y){const M=c("Head"),D=c("PageHeader"),g=c("BCol"),L=c("searchbar"),f=c("BButton"),T=c("Link"),P=c("BRow"),O=c("BCardHeader"),I=c("BCardBody"),A=c("BCard"),S=c("BForm"),F=c("BOffcanvas"),N=c("Pagination"),E=c("Layout"),B=re("b-tooltip");return u(),x(E,null,{default:l(()=>[i(M,{title:"Zone"}),i(D,{title:o.$t("zone"),pageTitle:o.$t("zone")},null,8,["title","pageTitle"]),i(P,null,{default:l(()=>[i(g,{lg:"12"},{default:l(()=>[i(A,{"no-body":"",id:"tasksList"},{default:l(()=>[i(O,{class:"border-0"},{default:l(()=>[i(P,{class:"g-2"},{default:l(()=>[i(g,{md:"3"},{default:l(()=>[t("div",ke,[t("label",ye,d(o.$t("show")),1),C(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>s.filter.limit=a),onChange:e[1]||(e[1]=(...a)=>s.changeEntriesPerPage&&s.changeEntriesPerPage(...a)),class:"form-select form-select-sm w-auto"},[(u(!0),v(Y,null,q(s.paginatorOption,a=>(u(),v("option",{key:a,value:a},d(a),9,Ce))),128))],544),[[de,s.filter.limit]]),t("label",we,d(o.$t("entries")),1)])]),_:1}),i(g,{md:"3"}),i(g,{md:"auto",class:"ms-auto"},{default:l(()=>[t("div",ze,[i(L,{onSearch:s.fetchSearch},null,8,["onSearch"]),i(f,{variant:"danger",onClick:e[2]||(e[2]=a=>s.rightOffcanvas=!0)},{default:l(()=>[e[10]||(e[10]=t("i",{class:"ri-filter-2-line me-1 align-bottom"},null,-1)),b(" "+d(o.$t("filters")),1)]),_:1}),o.permissions.includes("add-zone")?(u(),x(T,{key:0,href:"/zones/create"},{default:l(()=>[i(f,{variant:"primary",class:"float-end",disabled:z.app_for==="demo"},{default:l(()=>[e[11]||(e[11]=t("i",{class:"ri-add-line align-bottom me-1"},null,-1)),b(" "+d(o.$t("add_zone")),1)]),_:1},8,["disabled"])]),_:1})):w("",!0)])]),_:1})]),_:1})]),_:1}),t("div",Be,[t("div",Me,[t("div",Pe,[t("div",Se,[t("div",xe,[t("div",De,[t("div",Le,[t("label",Oe,d(o.$t("enable_peak_zone_feature")),1)]),t("div",Ve,[t("div",Ue,[C(t("input",{disabled:z.app_for==="demo",type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=a=>s.enable_peak_zone_feature=a),class:"form-check-input",id:"enable_peak_zone_feature",onChange:e[4]||(e[4]=(...a)=>s.handleUpdate&&s.handleUpdate(...a))},null,40,He),[[ce,s.enable_peak_zone_feature]])])])])])])])])]),i(I,{class:"border border-dashed border-end-0 border-start-0"},{default:l(()=>[t("div",Te,[t("table",Ie,[t("thead",Ae,[t("tr",null,[t("th",Fe,d(o.$t("name")),1),t("th",Ne,d(o.$t("status")),1),t("th",Ee,d(o.$t("action")),1)])]),s.results.length>0?(u(),v("tbody",Re,[(u(!0),v(Y,null,q(s.results,(a,R)=>(u(),v("tr",{key:R},[t("td",null,[t("div",je,[t("div",qe,d(a.name),1)])]),o.permissions.includes("toggle-zone")?(u(),v("td",Ye,[t("div",{class:ue({"form-check":!0,"form-switch":!0,"form-switch-lg":!0,"form-switch-success":a.active})},[t("input",{class:"form-check-input",type:"checkbox",role:"switch",onClick:H(_=>s.toggleActiveStatus(a.id,!a.active),["prevent"]),id:"status_"+a.id,checked:a.active},null,8,Ze)],2)])):w("",!0),t("td",null,[o.permissions.includes("edit-price")?C((u(),x(f,{key:0,class:"btn btn-soft-warning btn-sm m-2",onClick:H(_=>s.editData(a),["prevent"]),"data-bs-toggle":"tooltip",title:o.$t("edit")},{default:l(()=>[...e[12]||(e[12]=[t("i",{class:"bx bxs-edit-alt bx-xs"},null,-1)])]),_:1},8,["onClick","title"])),[[B,void 0,void 0,{hover:!0}]]):w("",!0),o.permissions.includes("view-zone-map")?C((u(),x(f,{key:1,class:"btn btn-soft-info btn-sm m-2",size:"sm",type:"button",onClick:H(_=>s.mapData(a),["prevent"]),"data-bs-toggle":"tooltip",title:o.$t("zone_map_view")},{default:l(()=>[...e[13]||(e[13]=[t("i",{class:"ri-earth-line bx-xs"},null,-1)])]),_:1},8,["onClick","title"])),[[B,void 0,void 0,{hover:!0}]]):w("",!0),o.permissions.includes("delete-price")?C((u(),x(f,{key:2,class:"btn btn-soft-danger btn-sm m-2",size:"sm",type:"button",onClick:H(_=>s.deleteModal(a.id),["prevent"]),"data-bs-toggle":"tooltip",title:o.$t("delete")},{default:l(()=>[...e[14]||(e[14]=[t("i",{class:"bx bx-trash bx-xs"},null,-1)])]),_:1},8,["onClick","title"])),[[B,void 0,void 0,{hover:!0}]]):w("",!0)])]))),128))])):(u(),v("tbody",Ge,[t("tr",null,[t("td",Je,[e[15]||(e[15]=t("img",{src:he,alt:"Loading...",style:{width:"100px"}},null,-1)),t("h5",null,d(o.$t("no_data_found")),1)])])]))])])]),_:1})]),_:1})]),_:1})]),_:1}),t("div",null,[s.successMessage?(u(),v("div",Ke,[t("div",We,[e[16]||(e[16]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[17]||(e[17]=b()),e[18]||(e[18]=t("strong",null,"Success",-1)),b(" - "+d(s.successMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-success",onClick:e[5]||(e[5]=(...a)=>s.dismissMessage&&s.dismissMessage(...a)),"aria-label":"Close Success Message"})])])):w("",!0),s.alertMessage?(u(),v("div",Xe,[t("div",Qe,[e[19]||(e[19]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[20]||(e[20]=b()),e[21]||(e[21]=t("strong",null,"Alert",-1)),b(" - "+d(s.alertMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-danger",onClick:e[6]||(e[6]=(...a)=>s.dismissMessage&&s.dismissMessage(...a)),"aria-label":"Close Alert Message"})])])):w("",!0)]),i(F,{modelValue:s.rightOffcanvas,"onUpdate:modelValue":e[9]||(e[9]=a=>s.rightOffcanvas=a),placement:"end",title:o.$t("zone_filters"),"header-class":"bg-light","body-class":"p-0 overflow-hidden","footer-class":"border-top p-3 text-center"},{default:l(()=>[i(S,null,{default:l(()=>[t("div",$e,[t("div",et,[t("label",tt,d(o.$t("status")),1),t("div",null,[t("div",st,[C(t("input",{class:"form-check-input",type:"radio",name:"status",id:"statusActive","onUpdate:modelValue":e[7]||(e[7]=a=>s.filter.status=a),value:"1"},null,512),[[Z,s.filter.status]]),t("label",at,d(o.$t("active")),1)]),t("div",ot,[C(t("input",{class:"form-check-input",type:"radio",name:"status",id:"statusInactive","onUpdate:modelValue":e[8]||(e[8]=a=>s.filter.status=a),value:"0"},null,512),[[Z,s.filter.status]]),t("label",nt,d(o.$t("inactive")),1)])])])]),t("div",lt,[i(f,{variant:"light",class:"w-100",onClick:s.clearFilter},{default:l(()=>[b(d(o.$t("clear_filter")),1)]),_:1},8,["onClick"]),i(f,{type:"submit",variant:"success",class:"w-100",onClick:s.filterData},{default:l(()=>[b(d(o.$t("apply")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue","title"]),i(N,{paginator:s.paginator,onPageChanged:s.handlePageChanged},null,8,["paginator","onPageChanged"])]),_:1})}const ht=$(be,[["render",it]]);export{ht as default};
