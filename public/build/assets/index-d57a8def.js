import{_ as T,Z as R,O as E,P as O,B as A,r as d,D as N,T as H,S as W,g as n,i as c,y as Z,w as _,W as L,a as U,l as f,n as e,J as u,k as p,z as m,t as J,M as j,F as q,L as G,C as h,p as P}from"./vendor-54d6cb1e.js";import{L as I}from"./main-b839be26.js";import{P as K}from"./page-header-ff719701.js";import{P as Q}from"./Pagination-b5e3d5c9.js";import{s as X}from"./search-06463c60.js";import{s as Y}from"./searchbar-3bdb3315.js";import{l as $}from"./footer-7e4f68d9.js";import{F as ee}from"./FormValidation-cabc17c8.js";import"./app-cb082573.js";const se={data(){return{rightOffcanvas:!1,dispatcher_addons:!1}},components:{Layout:I,PageHeader:K,Head:R,Pagination:Q,Multiselect:E,flatPickr:O,Link:A,search:X,searchbar:Y,FormValidation:ee},props:{successMessage:String,alertMessage:String,app_for:String},setup(a){d("");const{t:s}=N();H({all:"",locked:"",limit:10});const v=d(a.successMessage||""),t=d(a.alertMessage||""),g=d(null),k=d({}),r=H({purchase_code:null,dispatcher_zip_file:null,key:null}),M={purchase_code:{required:!0}},b=d(!1),z=o=>{if(a.app_for=="demo"){L.fire(s("error"),s("you_are_not_authorised"),"error");return}const i=o.target.files[0];if(i&&i.type==="application/zip"||i.type==="application/x-zip-compressed"||i.name.endsWith(".zip")){b.value=!1,r.dispatcher_zip_file=i;return}else b.value=!0,r.dispatcher_zip_file=null},y=d(!1),F=async o=>{if(o==null||o.preventDefault(),a.app_for=="demo"){L.fire(s("error"),s("you_are_not_authorised"),"error");return}if(r.dispatcher_zip_file&&!D(r.dispatcher_zip_file)){b.value=!0;return}try{let i=new FormData;r.dispatcher_zip_file&&i.append("dispatcher_zip_file",r.dispatcher_zip_file),y.value=!0;let V=await U.post("/dispatcher-addons/dipathcer-files",i,{headers:{"Content-Type":"multipart/form-data"}});console.log("response",V),V.status===201?v.value=s("files_uploaded_successfully"):(t.value=s("failed_to_files_uploaded"),y.value=!1)}catch(i){console.error(s("error_files_uploaded"),i),t.value=s("failed_to_files_uploaded_catch"),y.value=!1}},D=o=>o&&o.type==="application/zip"||o.type==="application/x-zip-compressed"||o.name.endsWith(".zip"),w=d(!1),C=d(!1),B=d(!0),x=d(!1),l=d(!1);return{successMessage:v,alertMessage:t,form:r,validationRules:M,validationRef:g,errors:k,zipFileError:b,handleFileUpload:z,handleSubmit:F,verifyPurchaseCode:async()=>{if(k.value=g.value.validate(),!(Object.keys(k.value).length>0))try{const o=new FormData;r.purchase_code&&(o.append("purchase_code",r.purchase_code),o.append("key","Restart")),l.value=!0;let i;i=await U.post("dispatcher-addons/verfication-submit",o),console.log("response",i.data.success),i.data.success==!0?(v.value=s("purchase_code_verified_successfully"),setTimeout(()=>{v.value=""},5e3),r.reset(),w.value=!0,C.value=!0,B.value=!1,x.value=!1):(t.value=s("failed_to_verify_the_purchase_code"),x.value=!0,l.value=!1,setTimeout(()=>{t.value=""},5e3))}catch(o){o.response&&o.response.status===422?(k.value=o.response.data.errors,l.value=!1):o.response&&o.response.status===403?(t.value=o.response.data.alertMessage,l.value=!1):(l.value=!1,console.error(s("error_verify_the_purchase_code"),o),t.value=s("failed_to_verify_the_purchase_code_catch"))}},showUploadOption:w,codeSuccesss:C,showHideForm:B,codeError:x,isButtonDisabled:l,uploadButtonDisabled:y}},computed:{...$,...W(["permissions"])},mounted(){}},te={class:"text-success float-end d-flex align-items-center me-3 text-decoration-underline text-decoration-underline-success"},ae={class:"row mb-3"},le={key:0,class:"col-sm-6"},oe={class:"mb-3"},ie={for:"purchase_code",class:"form-label"},re=["placeholder"],de={key:1,class:"col-sm-1 mt-4"},ne={class:"text-end"},ce=["disabled"],ue={key:2,class:"text-success fs-16"},fe={key:3,class:"text-danger fs-14"},pe={key:0,class:"row"},_e={class:"col-sm-6"},me={class:"mb-3"},ve={for:"dispatcher_zip_file",class:"form-label"},he=["disabled"],ge={key:0,class:"text-danger"},be={class:"col-lg-12"},ye={class:"text-end"},ke=["disabled"],xe={key:0,class:"custom-alert alert alert-success alert-border-left fade show",data:"alert",id:"alertMsg"},we={class:"alert-content"},Ce={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",data:"alert",id:"alertMsg"},Be={class:"alert-content"};function Me(a,s,v,t,g,k){const r=n("Head"),M=n("PageHeader"),b=n("BLink"),z=n("BCardHeader"),y=n("FormValidation"),F=n("BCardBody"),D=n("BCard"),w=n("BCol"),C=n("BRow"),B=n("BModal"),x=n("Layout");return c(),Z(x,null,{default:_(()=>[f(r,{title:"Dispatcher Addons"}),f(M,{title:a.$t("dispatcher_addons"),pageTitle:a.$t("dispatcher_addons")},null,8,["title","pageTitle"]),f(C,null,{default:_(()=>[f(w,{lg:"12"},{default:_(()=>[f(D,{"no-body":"",id:"tasksList"},{default:_(()=>[f(z,{class:"border-0"},{default:_(()=>[f(b,{onClick:s[0]||(s[0]=l=>g.dispatcher_addons=!g.dispatcher_addons)},{default:_(()=>[e("h6",te,u(a.$t("how_it_works")),1)]),_:1})]),_:1}),f(F,{class:"border border-dashed border-end-0 border-start-0"},{default:_(()=>[e("form",{onSubmit:s[5]||(s[5]=P(()=>{},["prevent"]))},[f(y,{ref:"validationRef",form:t.form,rules:t.validationRules},{default:_(()=>[e("div",ae,[t.showHideForm?(c(),p("div",le,[e("div",oe,[e("label",ie,[m(u(a.$t("purchase_code")),1),s[9]||(s[9]=e("span",{class:"text-danger"},"*",-1))]),J(e("input",{type:"text",class:"form-control",placeholder:a.$t("enter_purchase_code"),id:"purchase_code","onUpdate:modelValue":s[1]||(s[1]=l=>t.form.purchase_code=l)},null,8,re),[[j,t.form.purchase_code]]),(c(!0),p(q,null,G(t.errors.purchase_code,(l,S)=>(c(),p("span",{key:S,class:"text-danger"},u(l),1))),128))])])):h("",!0),t.showHideForm?(c(),p("div",de,[e("div",ne,[e("button",{type:"button",class:"btn btn-primary",onClick:s[2]||(s[2]=P((...l)=>t.verifyPurchaseCode&&t.verifyPurchaseCode(...l),["prevent"])),disabled:t.isButtonDisabled||v.app_for==="demo"},u(a.$t("verify")),9,ce)])])):h("",!0),t.codeSuccesss?(c(),p("div",ue,[s[10]||(s[10]=e("i",{class:"ri-checkbox-circle-fill fs-14 align-middle"},null,-1)),m(" "+u(a.$t("purchase_code_has_been_verified")),1)])):h("",!0),t.codeError?(c(),p("div",fe,[s[11]||(s[11]=e("i",{class:"ri-close-circle-fill fs-15 align-middle"},null,-1)),m(" "+u(a.$t("code_has_invalid")),1)])):h("",!0)]),t.showUploadOption?(c(),p("div",pe,[e("div",_e,[e("div",me,[e("label",ve,[m(u(a.$t("dispatcher_zip_file"))+" ",1),s[12]||(s[12]=e("span",{class:"text-danger"},"*",-1))]),e("input",{disabled:v.app_for==="demo",type:"file",class:"form-control",onChange:s[3]||(s[3]=(...l)=>t.handleFileUpload&&t.handleFileUpload(...l))},null,40,he),t.zipFileError?(c(),p("div",ge,u(a.$t("please_upload_a_dispatcher_zip_file")),1)):h("",!0)])]),e("div",be,[e("div",ye,[e("button",{type:"button",class:"btn btn-primary",onClick:s[4]||(s[4]=P(l=>t.handleSubmit(a.event),["prevent"])),disabled:t.uploadButtonDisabled&&v.app_for==="demo"},u(a.$t("upload")),9,ke)])])])):h("",!0)]),_:1},8,["form","rules"])],32)]),_:1})]),_:1})]),_:1})]),_:1}),e("div",null,[t.successMessage?(c(),p("div",xe,[e("div",we,[s[13]||(s[13]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),s[14]||(s[14]=m()),s[15]||(s[15]=e("strong",null,"Success",-1)),m(" - "+u(t.successMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-success",onClick:s[6]||(s[6]=(...l)=>a.dismissMessage&&a.dismissMessage(...l)),"aria-label":"Close Success Message"})])])):h("",!0),t.alertMessage?(c(),p("div",Ce,[e("div",Be,[s[16]||(s[16]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),s[17]||(s[17]=m()),s[18]||(s[18]=e("strong",null,"Alert",-1)),m(" - "+u(t.alertMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-danger",onClick:s[7]||(s[7]=(...l)=>a.dismissMessage&&a.dismissMessage(...l)),"aria-label":"Close Alert Message"})])])):h("",!0)]),f(B,{modelValue:g.dispatcher_addons,"onUpdate:modelValue":s[8]||(s[8]=l=>g.dispatcher_addons=l),"hide-footer":"",title:a.$t("dispatcher_addons"),class:"v-modal-custom",size:"md"},{default:_(()=>[...s[19]||(s[19]=[e("div",{class:"container"},[e("ul",{class:"list-unstyled vstack gap-3"},[e("li",null,[e("div",{class:"d-flex"},[e("div",{class:"flex-shrink-0 text-success me-1"},[e("i",{class:"ri-checkbox-circle-fill fs-15 align-middle"})]),e("div",{class:"flex-grow-1"},"Enter the Purchase Code and Verify it")])]),e("li",null,[e("div",{class:"d-flex"},[e("div",{class:"flex-shrink-0 text-success me-1"},[e("i",{class:"ri-checkbox-circle-fill fs-15 align-middle"})]),e("div",{class:"flex-grow-1"},"After, verify the Purchase Code it show the Zip file Uplaod Section.")])]),e("li",null,[e("div",{class:"d-flex"},[e("div",{class:"flex-shrink-0 text-success me-1"},[e("i",{class:"ri-checkbox-circle-fill fs-15 align-middle"})]),e("div",{class:"flex-grow-1"},"Upload the Dispatcher Zip File in the Form and click the Upload Button.")])]),e("li",null,[e("div",{class:"d-flex"},[e("div",{class:"flex-shrink-0 text-success me-1"},[e("i",{class:"ri-checkbox-circle-fill fs-15 align-middle"})]),e("div",{class:"flex-grow-1"},[m("Once the files uploaded, then run "),e("div",{class:"d-flex mt-3"},[e("div",{class:"flex-shrink-0 text-success me-1"}," - "),e("div",{class:"flex-grow-1"}," npm run build ")]),e("div",{class:"d-flex mt-3"},[e("div",{class:"flex-shrink-0 text-success me-1"}," - "),e("div",{class:"flex-grow-1"}," php artisan migrate ")]),e("div",{class:"d-flex mt-3"},[e("div",{class:"flex-shrink-0 text-success me-1"}," - "),e("div",{class:"flex-grow-1"}," php artisan db:seed ")])])])])])],-1)])]),_:1},8,["modelValue","title"])]),_:1})}const Te=T(se,[["render",Me]]);export{Te as default};
