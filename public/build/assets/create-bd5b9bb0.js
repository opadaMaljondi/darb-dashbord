import{_ as te,Z as se,D as ae,r as v,T as ne,o as N,g as C,i as r,y as q,w as z,a as E,N as j,l as x,n as e,p as le,J as l,t as u,K as G,k as d,L as F,F as B,C as _,q as ie,M as h,z as y}from"./vendor-8caf5d52.js";import{L as re}from"./main-cc7bd0ce.js";import{P as de}from"./page-header-18309276.js";import{u as ce}from"./footer-502c2797.js";import"./app-974c65a1.js";const _e={components:{Layout:re,PageHeader:de,Head:se},props:{googleMapKey:String,successMessage:String,default_lat:String,default_lng:String,alertMessage:String,existingZones:Array,enable_maximum_distance_feature:Boolean,settings:Object},setup(a){const{googleMapKey:o}=a,{t:m}=ae(),{languages:t,fetchData:U}=ce(),V=v("English"),A=v(a.settings.enable_peak_zone_feature==1),b=ne({service_location_id:"",languageFields:{},unit:"",maximum_outstation_distance:a.enable_maximum_distance_feature?"":0,maximum_distance:a.enable_maximum_distance_feature?"":0}),S=v(a.successMessage||""),k=v(a.alertMessage||""),w=v([]),M=v(""),s=v([]),p=v(null);let g=[];const L=v(null),O=v(null),K=()=>{M.value.length<3?s.value=[]:setTimeout(()=>{H(M.value)},300)},H=n=>{const c="https://places.googleapis.com/v1/places:autocomplete",i={"Content-Type":"application/json","X-Goog-Api-Key":a.googleMapKey,"X-Goog-FieldMask":"suggestions.placePrediction.placeId,suggestions.placePrediction.place,suggestions.placePrediction.text"};fetch(c,{method:"POST",headers:i,body:JSON.stringify({input:n})}).then(f=>f.json()).then(f=>{var P;((P=f.suggestions)==null?void 0:P.length)>0&&(s.value=f.suggestions.filter(T=>T.placePrediction).map(T=>({placeId:T.placePrediction.placeId,formattedAddress:T.placePrediction.text.text})))}).catch(f=>{console.error("Error fetching autocomplete results:",f)})},R=async n=>{const c={"X-Goog-Api-Key":a.googleMapKey,"X-Goog-FieldMask":"viewport,location"};fetch(`https://places.googleapis.com/v1/places/${n.placeId}?fields=viewport,location`,{headers:c}).then(i=>i.json()).then(i=>{M.value="",s.value=[];const I=new google.maps.LatLng(i.location.latitude,i.location.longitude);if(p.value.setCenter(I),i.viewport&&i.viewport.high&&i.viewport.low){const f=new google.maps.LatLngBounds(new google.maps.LatLng(i.viewport.low.latitude,i.viewport.low.longitude),new google.maps.LatLng(i.viewport.high.latitude,i.viewport.high.longitude));p.value.fitBounds(f)}else p.value.setZoom(15)}).catch(i=>{console.error("Error fetching autocomplete results:",i)})},Z=async()=>{const n=await E.get("list");w.value=n.data.results},X=n=>{google.maps.event.addListener(n,"click",()=>{O.value!==n&&(g.forEach(c=>{c.setOptions({fillColor:"#0000FF",editable:!1})}),n.setOptions({fillColor:"#00FF00",editable:!0}),O.value=n)})},Y=()=>{L.value=new google.maps.drawing.DrawingManager({drawingMode:google.maps.drawing.OverlayType.POLYGON,drawingControl:!1,drawingControlOptions:{position:google.maps.ControlPosition.TOP_CENTER,drawingModes:[google.maps.drawing.OverlayType.POLYGON]},polygonOptions:{fillColor:"#0000FF",fillOpacity:.3,strokeWeight:1,clickable:!0,editable:!1,zIndex:1}}),L.value.setMap(p.value),google.maps.event.addListener(L.value,"overlaycomplete",function(n){n.type===google.maps.drawing.OverlayType.POLYGON&&(g.push(n.overlay),X(n.overlay))})},J=()=>{p.value=new google.maps.Map(document.getElementById("map"),{center:{lat:parseFloat(a.default_lat),lng:parseFloat(a.default_lng)},zoom:10}),a.existingZones.forEach(n=>{new google.maps.Polygon({paths:n,fillColor:"#FF0000",fillOpacity:.5,strokeWeight:1,clickable:!1,editable:!1,zIndex:1,map:p.value})}),Y()},D=n=>{if(L.value){let c=n=="draw"?google.maps.drawing.OverlayType.POLYGON:null;L.value.setDrawingMode(c)}},W=()=>{if(O.value){const n=g.indexOf(O.value);D("grab"),n>-1&&(g[n].setMap(null),g.splice(n,1))}},Q=()=>{g.forEach(n=>{n.setMap(null),O.value=null}),g=[]},$=async()=>{const n=oe();if(Object.keys(n).length===0)try{if(g.length===0){k.value=m("at_least_one_completed_polygon_is_required");return}const c=g.map(f=>f.getPath().getArray().map(P=>[P.lng(),P.lat()])),i={...b.data(),coordinates:JSON.stringify(c)};(await E.post("store",i)).status===201?(S.value=m("zone_created_successfully"),b.reset(),j.get("/zones")):k.value=m("failed_to_create_zone")}catch(c){c.response&&c.response.status===403?(k.value=c.response.data.alertMessage,setTimeout(()=>{j.get("/zones")},5e3)):c.response&&c.response.status===422?(k.value=c.response.data.message,b.errors={coordinates:c.response.data.message}):(b.errors={},k.value=m("failed_to_create_zone_catch"),console.error(m("error_updating_zone"),c))}else b.errors=n},ee=n=>{V.value=n};N(async()=>{Object.keys(t).length==0&&await U()});const oe=()=>{const{service_location_id:n,unit:c}=b,i={};return c?delete i.unit:i.unit=m("unit_is_required"),n?delete i.service_location_id:i.service_location_id=m("service_location_is_required"),g.length===0?i.coordinates=m("at_least_one_completed_polygon_is_required"):delete i.coordinates,a.enable_maximum_distance_feature&&(maximum_distance?delete i.maximum_distance:i.maximum_distance=m("required"),maximum_outstation_distance?delete i.maximum_outstation_distance:i.maximum_outstation_distance=m("required")),i};return N(()=>{if(!o){console.error(m("google_map_api_key_is_null_or_undefined"));return}const n=document.createElement("script");n.src=`https://maps.googleapis.com/maps/api/js?key=${o}&libraries=places,drawing`,n.onload=()=>{J(),Z()},document.head.appendChild(n)}),{form:b,successMessage:S,alertMessage:k,handleSubmit:$,serviceLocations:w,search:M,suggestions:s,handleInput:K,selectSuggestion:R,setActiveTab:ee,removeAllPolygons:Q,removeSelectedPolygon:W,changeDrawingMode:D,activeTab:V,languages:t,enable_peak_zone_feature:A}},computed:{selectedUnitLabel(){return this.form.unit==1?this.$t("kilo_meter"):this.form.unit==2?this.$t("miles"):""}}},me={class:"row"},ue={class:"col-lg-6"},pe={class:"card"},ge={class:"card-body"},fe={class:"mb-3"},ve={for:"service_location",class:"form-label"},be={value:"",disabled:""},he=["value"],ye={key:0,class:"text-danger"},ke={class:"nav nav-tabs nav-tabs-custom nav-success nav-justified",role:"tablist"},we={class:"nav-item",role:"presentation"},ze=["onClick"],xe=["id"],Me={class:"col-sm-6 mt-3"},Ce={class:"mb-3"},Le=["for"],Oe=["placeholder","id","onUpdate:modelValue","required"],Pe={class:"mb-3"},Se={for:"select_unit",class:"form-label"},Te={disabled:"",value:""},Fe={value:"1"},Be={value:"2"},Ve={key:0,class:"text-danger"},Ae={key:0,class:"mb-3"},Ie={for:"maximum_distance",class:"form-label"},Ue=["placeholder"],De={key:0,class:"text-danger"},Ne={key:1,class:"mb-3"},qe={for:"maximum_outstation_distance",class:"form-label"},Ee=["placeholder"],je={key:0,class:"text-danger"},Ge={key:2,class:"row"},Ke={class:"col-sm-6"},He={class:"mb-3"},Re={for:"peak_zone_ride_count",class:"form-label"},Ze={class:"input-group"},Xe=["readonly","placeholder"],Ye={key:0,class:"text-danger"},Je={class:"col-sm-6"},We={class:"mb-3"},Qe={for:"peak_zone_radius",class:"form-label"},$e={class:"input-group"},eo=["readonly","placeholder"],oo={key:0,class:"text-danger"},to={key:3,class:"row"},so={class:"col-sm-6"},ao={class:"mb-3"},no={for:"peak_zone_history_duration",class:"form-label"},lo=["readonly","placeholder"],io={key:0,class:"text-danger"},ro={class:"col-sm-6"},co={class:"mb-3"},_o={for:"peak_zone_duration",class:"form-label"},mo={class:"input-group"},uo=["readonly","placeholder"],po={key:0,class:"text-danger"},go={key:0,class:"row"},fo={class:"col-sm-6"},vo={class:"mb-3"},bo={for:"distance_price_percentage",class:"form-label"},ho={href:"",class:"text-success","data-bs-toggle":"modal","data-bs-target":"#surge"},yo={class:"input-group"},ko=["readonly","placeholder"],wo={key:0,class:"text-danger"},zo={class:"text-end"},xo={type:"submit",class:"btn btn-primary"},Mo={class:"mb-3"},Co={key:0,class:"text-danger"},Lo={class:"col-lg-6 col-md-10 col-sm-10"},Oo={class:"card"},Po={class:"card-body"},So={class:"autocomplete-container"},To={class:"input-group"},Fo=["placeholder"],Bo={key:0,class:"autocomplete-results"},Vo=["onClick"],Ao={class:"col-lg-1 col-md-2 col-sm-2",style:{position:"absolute","z-index":"50",top:"20%"}},Io={class:"d-flex align-items-center"},Uo={class:"card-body"},Do={class:"d-flex align-items-center"},No={class:"card-body"},qo={class:"d-flex align-items-center"},Eo={class:"card-body"},jo={class:"d-flex align-items-center"},Go={class:"card-body"},Ko={key:0,class:"custom-alert alert alert-success alert-border-left fade show",role:"alert",id:"alertMsg"},Ho={class:"alert-content"},Ro={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",role:"alert",id:"alertMsg"},Zo={class:"alert-content"};function Xo(a,o,m,t,U,V){const A=C("Head"),b=C("PageHeader"),S=C("BCol"),k=C("BRow"),w=C("BButton"),M=C("Layout");return r(),q(M,null,{default:z(()=>[x(A,{title:"Zones"}),x(b,{title:a.$t("create"),pageTitle:a.$t("zone"),pageLink:"/zones"},null,8,["title","pageTitle"]),e("div",me,[e("div",ue,[e("div",pe,[e("div",ge,[e("form",{onSubmit:o[9]||(o[9]=le((...s)=>t.handleSubmit&&t.handleSubmit(...s),["prevent"]))},[e("div",fe,[e("label",ve,l(a.$t("service_location")),1),u(e("select",{class:"form-select",id:"service_location","onUpdate:modelValue":o[0]||(o[0]=s=>t.form.service_location_id=s)},[e("option",be,l(a.$t("select_service_location")),1),(r(!0),d(B,null,F(t.serviceLocations,s=>(r(),d("option",{key:s.id,value:s.id},l(s.name),9,he))),128))],512),[[G,t.form.service_location_id]]),t.form.errors.service_location_id?(r(),d("span",ye,l(t.form.errors.service_location_id),1)):_("",!0)]),e("ul",ke,[(r(!0),d(B,null,F(t.languages,s=>(r(),q(k,{key:s.code},{default:z(()=>[x(S,{lg:"12"},{default:z(()=>[e("li",we,[e("a",{class:ie(["nav-link",{active:t.activeTab===s.label}]),onClick:p=>t.setActiveTab(s.label),role:"tab","aria-selected":"true"},l(s.label),11,ze)])]),_:2},1024)]),_:2},1024))),128))]),(r(!0),d(B,null,F(t.languages,s=>(r(),d("div",{class:"tab-content text-muted",key:s.code},[t.activeTab===s.label?(r(),d("div",{key:0,class:"tab-pane active show",id:`${s.label}`,role:"tabpanel"},[e("div",Me,[e("div",Ce,[e("label",{for:`name-${s.code}`,class:"form-label"},l(a.$t("name")),9,Le),u(e("input",{type:"text",class:"form-control",placeholder:a.$t("enter_name_in",{language:`${s.label}`}),id:`name-${s.code}`,"onUpdate:modelValue":p=>t.form.languageFields[s.code]=p,required:s.code==="en"},null,8,Oe),[[h,t.form.languageFields[s.code]]])])])],8,xe)):_("",!0)]))),128)),e("div",Pe,[e("label",Se,l(a.$t("select_unit")),1),u(e("select",{id:"select_unit",class:"form-select","onUpdate:modelValue":o[1]||(o[1]=s=>t.form.unit=s)},[e("option",Te,l(a.$t("choose_unit")),1),e("option",Fe,l(a.$t("kilo_meter")),1),e("option",Be,l(a.$t("miles")),1)],512),[[G,t.form.unit]]),t.form.errors.unit?(r(),d("span",Ve,l(t.form.errors.unit),1)):_("",!0)]),m.enable_maximum_distance_feature?(r(),d("div",Ae,[e("label",Ie,[y(l(a.$t("maximum_distance"))+" ",1),o[16]||(o[16]=e("span",{class:"text-danger"},"*",-1))]),u(e("input",{type:"number",step:"any",class:"form-control",placeholder:a.$t("enter_maximum_distance"),id:"maximum_distance","onUpdate:modelValue":o[2]||(o[2]=s=>t.form.maximum_distance=s)},null,8,Ue),[[h,t.form.maximum_distance,void 0,{number:!0}]]),t.form.errors.enter_maximum_distance?(r(),d("span",De,l(t.form.errors.enter_maximum_distance),1)):_("",!0)])):_("",!0),m.enable_maximum_distance_feature?(r(),d("div",Ne,[e("label",qe,[y(l(a.$t("maximum_outstation_distance"))+" ",1),o[17]||(o[17]=e("span",{class:"text-danger"},"*",-1))]),u(e("input",{type:"number",step:"any",class:"form-control",placeholder:a.$t("enter_maximum_outstation_distance"),id:"maximum_outstation_distance","onUpdate:modelValue":o[3]||(o[3]=s=>t.form.maximum_outstation_distance=s)},null,8,Ee),[[h,t.form.maximum_outstation_distance,void 0,{number:!0}]]),t.form.errors.maximum_outstation_distance?(r(),d("span",je,l(t.form.errors.maximum_outstation_distance),1)):_("",!0)])):_("",!0),t.enable_peak_zone_feature?(r(),d("div",Ge,[e("div",Ke,[e("div",He,[e("label",Re,[y(l(a.$t("peak_zone_ride_count"))+" ",1),o[18]||(o[18]=e("span",{class:"text-danger"},"*",-1))]),e("div",Ze,[u(e("input",{type:"number",readonly:a.app_for==="demo",class:"form-control",placeholder:a.$t("enter_peak_zone_ride_count"),id:"peak_zone_ride_count","onUpdate:modelValue":o[4]||(o[4]=s=>t.form.peak_zone_ride_count=s)},null,8,Xe),[[h,t.form.peak_zone_ride_count]]),t.form.errors.peak_zone_ride_count?(r(),d("span",Ye,l(t.form.errors.peak_zone_ride_count),1)):_("",!0)])])]),e("div",Je,[e("div",We,[e("label",Qe,[y(l(a.$t("peak_zone_radius"))+" ",1),o[19]||(o[19]=e("span",{class:"text-danger"},"*",-1))]),e("div",$e,[u(e("input",{type:"number",readonly:a.app_for==="demo",class:"form-control",placeholder:a.$t("enter_peak_zone_radius"),id:"peak_zone_radius","onUpdate:modelValue":o[5]||(o[5]=s=>t.form.peak_zone_radius=s)},null,8,eo),[[h,t.form.peak_zone_radius]]),t.form.errors.peak_zone_radius?(r(),d("span",oo,l(t.form.errors.peak_zone_radius),1)):_("",!0)])])])])):_("",!0),t.enable_peak_zone_feature?(r(),d("div",to,[e("div",so,[e("div",ao,[e("label",no,[y(l(a.$t("peak_zone_history_duration"))+" ",1),o[20]||(o[20]=e("span",{class:"text-danger"},"*",-1))]),u(e("input",{type:"number",readonly:a.app_for==="demo",class:"form-control",placeholder:a.$t("enter_peak_zone_history_duration"),id:"peak_zone_history_duration","onUpdate:modelValue":o[6]||(o[6]=s=>t.form.peak_zone_history_duration=s)},null,8,lo),[[h,t.form.peak_zone_history_duration]]),t.form.errors.peak_zone_history_duration?(r(),d("span",io,l(t.form.errors.peak_zone_history_duration),1)):_("",!0)])]),e("div",ro,[e("div",co,[e("label",_o,[y(l(a.$t("peak_zone_duration"))+" ",1),o[21]||(o[21]=e("span",{class:"text-danger"},"*",-1))]),e("div",mo,[u(e("input",{type:"number",readonly:a.app_for==="demo",class:"form-control",placeholder:a.$t("enter_peak_zone_duration"),id:"peak_zone_duration","onUpdate:modelValue":o[7]||(o[7]=s=>t.form.peak_zone_duration=s)},null,8,uo),[[h,t.form.peak_zone_duration]]),t.form.errors.peak_zone_duration?(r(),d("span",po,l(t.form.errors.peak_zone_duration),1)):_("",!0)])])]),t.enable_peak_zone_feature?(r(),d("div",go,[e("div",fo,[e("div",vo,[e("label",bo,[y(l(a.$t("distance_price_percentage"))+" ",1),o[22]||(o[22]=e("span",{class:"text-danger"},"*",-1)),e("a",ho,l(a.$t("how_it_works")),1)]),e("div",yo,[u(e("input",{type:"number",readonly:a.app_for==="demo",class:"form-control",placeholder:a.$t("enter_distance_price_percentage"),id:"distance_price_percentage","onUpdate:modelValue":o[8]||(o[8]=s=>t.form.distance_price_percentage=s)},null,8,ko),[[h,t.form.distance_price_percentage]]),t.form.errors.distance_price_percentage?(r(),d("span",wo,l(t.form.errors.distance_price_percentage),1)):_("",!0)])])])])):_("",!0)])):_("",!0),e("div",zo,[e("button",xo,l(a.$t("save")),1)]),e("div",Mo,[t.form.errors.coordinates?(r(),d("span",Co,l(t.form.errors.coordinates),1)):_("",!0)])],32)])])]),e("div",Lo,[e("div",Oo,[e("div",Po,[e("div",So,[e("div",To,[u(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[10]||(o[10]=s=>t.search=s),placeholder:a.$t("search_for_a_city"),id:"pac-input",autocomplete:"off",onInput:o[11]||(o[11]=(...s)=>t.handleInput&&t.handleInput(...s))},null,40,Fo),[[h,t.search]])]),t.suggestions.length>0?(r(),d("div",Bo,[(r(!0),d(B,null,F(t.suggestions,s=>(r(),d("div",{key:s.placeId,class:"autocomplete-item",onClick:p=>t.selectSuggestion(s)},l(s.formattedAddress),9,Vo))),128))])):_("",!0)]),o[27]||(o[27]=e("div",{id:"map",style:{height:"400px",position:"relative","z-index":"10"}},null,-1)),e("div",Ao,[e("div",Io,[e("div",Uo,[x(w,{onClick:o[12]||(o[12]=s=>t.changeDrawingMode("grab")),class:"align-center btn-dark border border-light","data-bs-toggle":"tooltip","data-bs-placement":"right",title:"Select"},{default:z(()=>o[23]||(o[23]=[e("i",{class:"bx bxs-hand-up fs-16"},null,-1)])),_:1,__:[23]})])]),e("div",Do,[e("div",No,[x(w,{onClick:o[13]||(o[13]=s=>t.changeDrawingMode("draw")),class:"align-center btn-dark border border-light","data-bs-toggle":"tooltip","data-bs-placement":"right",title:"Add"},{default:z(()=>o[24]||(o[24]=[e("i",{class:"bx bx-plus fs-16"},null,-1)])),_:1,__:[24]})])]),e("div",qo,[e("div",Eo,[x(w,{onClick:t.removeSelectedPolygon,class:"align-center btn-dark border border-light","data-bs-toggle":"tooltip","data-bs-placement":"right",title:"Remove selected polygon"},{default:z(()=>o[25]||(o[25]=[e("i",{class:"bx bx-x fs-16"},null,-1)])),_:1,__:[25]},8,["onClick"])])]),e("div",jo,[e("div",Go,[x(w,{onClick:t.removeAllPolygons,class:"align-center btn-dark border border-light","data-bs-toggle":"tooltip","data-bs-placement":"right",title:"Remove all"},{default:z(()=>o[26]||(o[26]=[e("i",{class:"bx bx-trash fs-16"},null,-1)])),_:1,__:[26]},8,["onClick"])])])])]),o[28]||(o[28]=e("div",{class:"card-footer"},[e("div",{class:"alert alert-warning f-18",role:"alert"},[e("strong",null,"Avoid drawing multiple zones that overlap with each other.")])],-1))])])]),t.successMessage?(r(),d("div",Ko,[e("div",Ho,[o[29]||(o[29]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),o[30]||(o[30]=e("strong",null,"Success",-1)),y(" - "+l(t.successMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-success",onClick:o[14]||(o[14]=(...s)=>a.dismissMessage&&a.dismissMessage(...s)),"aria-label":"Close Success Message"})])])):_("",!0),t.alertMessage?(r(),d("div",Ro,[e("div",Zo,[o[31]||(o[31]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),o[32]||(o[32]=e("strong",null,"Alert",-1)),y(" - "+l(t.alertMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-danger",onClick:o[15]||(o[15]=(...s)=>a.dismissMessage&&a.dismissMessage(...s)),"aria-label":"Close Alert Message"})])])):_("",!0),o[33]||(o[33]=e("div",{id:"surge",class:"modal fade",tabindex:"-1","aria-labelledby":"surgeLabel","aria-hidden":"true",style:{display:"none"}},[e("div",{class:"modal-dialog"},[e("div",{class:"modal-content"},[e("div",{class:"modal-header"},[e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]),e("div",{class:"modal-body"},[e("h5",{class:"fs-15"}," Peak Zone Surge Percentage "),e("p",{class:"text-muted"}," The percentage with which the price per distance increases when the ride is created within the peakzone ")])])])],-1))]),_:1,__:[33]})}const et=te(_e,[["render",Xo],["__scopeId","data-v-9524d25d"]]);export{et as default};
