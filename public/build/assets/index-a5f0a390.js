import{_ as le,Z as ne,O as ie,P as re,B as ce,D as de,r as _,T as ue,R as fe,a as Y,S as _e,g as u,U as ge,i as d,y,w as n,W as M,N as D,l as r,n as t,J as i,t as P,K as me,k as g,L as Z,F as G,z as k,C as m,q as ve,p as S}from"./vendor-8caf5d52.js";import{L as pe}from"./main-cc7bd0ce.js";import{P as he}from"./page-header-18309276.js";import{P as be}from"./Pagination-0518e4bd.js";import{s as ye}from"./searchbar-e42e22fa.js";import{u as ke,l as Ce}from"./footer-502c2797.js";import{_ as Be}from"./search-file-ab3e1046.js";import"./app-974c65a1.js";const we={data(){return{rightOffcanvas:!1,SearchQuery:""}},components:{Layout:pe,PageHeader:he,Head:ne,Pagination:be,Multiselect:ie,flatPickr:re,Link:ce,searchbar:ye},props:{successMessage:String,alertMessage:String,zones:{type:Array,required:!0},vehicleTypes:{type:Array,required:!0},show_driver_level_feature:Boolean,show_incentive_feature_for_driver:Boolean,enable_fixed_fare:Boolean},setup(o){const{t:e}=de(),p=_(""),s=ue({service_location_id:null,zone_id:[],type_id:[],limit:10}),C=_([]),U=_({}),O=_(!1),z=_(!1),x=_(null),A=_({}),{selectedLocation:f}=ke(),F=_(o.successMessage||""),B=_(o.alertMessage||""),T=_(""),L=_(""),N=_(o.zones),E=_(o.vehicleTypes),H=()=>{F.value="",B.value=""};fe(f,l=>{s.service_location_id=l,w()});const $=async(l,c)=>{M.fire({title:e("are_you_sure"),text:e("you_are_about_to_change_status"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:e("yes"),cancelButtonText:e("cancel")}).then(async v=>{if(v.isConfirmed)try{await Y.post("/set-prices/update-status",{id:l,status:c});const I=C.value.findIndex(oe=>oe.id===l);I!==-1&&(C.value[I].active=c),M.fire(e("changed"),e("status_updated_successfully"),"success")}catch(I){console.error(e("error_updating_status"),I),M.fire(e("error"),e("failed_to_update_status"),"error")}})},R=l=>l.charAt(0).toUpperCase()+l.slice(1),V=_(!1),h=()=>{w(),z.value=!0,V.value=!1},a=()=>{s.reset(),T.value="",L.value="",w(),V.value=!1},q=()=>{O.value=!1},b=async l=>{try{await Y.delete(`/set-prices/delete/${l}`);const c=C.value.findIndex(v=>v.id===l);c!==-1&&C.value.splice(c,1),O.value=!1,M.fire(e("success"),e("vehicle_price_deleted_successfully"),"success")}catch(c){c.response&&c.response.status==403&&(B.value=c.response.data.alertMessage,setTimeout(()=>{B.value=""},5e3)),M.fire(e("error"),e("failed_to_delete_vehicle_price"),"error")}},J=async l=>{M.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!"}).then(async c=>{if(c.isConfirmed)try{await b(l)}catch(v){console.error(e("error_deleting_data"),v),M.fire(e("error"),e("failed_to_delete_the_data"),"error")}})},K=async l=>{p.value=l,w()},w=async(l=1)=>{try{const c=s.data();c.page=l,c.zone=T.value,c.vehicle_type_id=L.value,c.include="vehicleType,zone",s.status!==""&&(c.status=s.status),p.value.length>0&&(c.search=p.value);const v=await Y.get("/set-prices/list",{params:c});console.log("list-data"),console.log(v.data.results),C.value=v.data.results,U.value=v.data.paginator,ae(U.value.total),z.value=!1}catch(c){console.error(e("error_fetching_set_prices"),c)}},Q=async l=>{localStorage.setItem("set-prices/list",l),w(l)},W=async l=>{D.get(`/set-prices/edit/${l.id}`)},j=async l=>{D.get(`set-prices/packages/${l.id}`)},X=async l=>{D.get(`drivers-levelup/${l.id}`)},ee=async l=>{D.get(`incentives/${l.id}`)},te=async l=>{D.get(`farefix/${l.id}`)},se=async l=>{D.get(`set-prices/surge/${l.id}`)},ae=()=>{A.value=[10,25,50,100,200,500]};return{results:C,modalShow:O,deleteItemId:x,successMessage:F,alertMessage:B,filterData:h,deleteModal:J,closeModal:q,dismissMessage:H,searchTerm:p,fetchSearch:K,paginator:U,modalFilter:z,clearFilter:a,fetchDatas:w,filter:s,handlePageChanged:Q,editData:W,packagesData:j,surgeData:se,toggleActiveStatus:$,capitalizeFirstLetter:R,zone:T,vehicleType:L,zoneOptions:N,vehicleTypeOptions:E,rightOffcanvas:V,levelUpData:X,incentiveData:ee,paginatorOption:A,selectedLocation:f,changeEntriesPerPage:()=>{w()},fixFareData:te}},computed:{...Ce,..._e(["permissions"])},mounted(){this.filter.service_location_id=this.selectedLocation,this.fetchDatas();const o=localStorage.getItem("set-prices/list");o?this.handlePageChanged(Number(o)):this.handlePageChanged(1)}},Me={class:"d-flex align-items-center mt-3"},Pe={class:"me-2 text-muted"},Se=["value"],xe={class:"ms-2 text-muted"},De={class:"d-flex align-items-center gap-2"},Oe={class:"table-responsive"},ze={class:"table align-middle position-relative table-nowrap"},Te={class:"table-active"},Le={scope:"col"},Ve={scope:"col"},Ue={scope:"col"},Ae={scope:"col"},Fe={scope:"col",class:"mx-5"},He={key:0},Ie={key:0},Ne={key:1},Ee={key:2},$e={key:0},Re=["onClick","id","checked"],qe={class:"d-flex"},Ye={key:1},Ze={colspan:"7",class:"text-center"},Ge={key:0,class:"custom-alert alert alert-success alert-border-left fade show",data:"alert",id:"alertMsg"},Je={class:"alert-content"},Ke={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",data:"alert",id:"alertMsg"},Qe={class:"alert-content"},We={class:"offcanvas-title",id:"offcanvasRightLabel"},je={class:"p-4"},Xe={class:"mb-3"},et={class:"form-label"},tt={class:"mb-3"},st={class:"form-label"},at={class:"offcanvas-footer p-4 text-center hstack gap-2"};function ot(o,e,p,s,C,U){const O=u("Head"),z=u("PageHeader"),x=u("BCol"),A=u("searchbar"),f=u("BButton"),F=u("Link"),B=u("BRow"),T=u("BCardHeader"),L=u("BCardBody"),N=u("BCard"),E=u("pagination"),H=u("Multiselect"),$=u("BOffcanvasBody"),R=u("BOffcanvas"),V=u("Layout"),h=ge("b-tooltip");return d(),y(V,null,{default:n(()=>[r(O,{title:"Set Prices"}),r(z,{title:o.$t("set_prices"),pageTitle:o.$t("set_prices")},null,8,["title","pageTitle"]),r(B,null,{default:n(()=>[r(x,{lg:"12"},{default:n(()=>[r(N,{"no-body":"",id:"tasksList"},{default:n(()=>[r(T,{class:"border-0"},{default:n(()=>[r(B,{class:"g-2"},{default:n(()=>[r(x,{md:"3"},{default:n(()=>[t("div",Me,[t("label",Pe,i(o.$t("show")),1),P(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>s.filter.limit=a),onChange:e[1]||(e[1]=(...a)=>s.changeEntriesPerPage&&s.changeEntriesPerPage(...a)),class:"form-select form-select-sm w-auto"},[(d(!0),g(G,null,Z(s.paginatorOption,a=>(d(),g("option",{key:a,value:a},i(a),9,Se))),128))],544),[[me,s.filter.limit]]),t("label",xe,i(o.$t("entries")),1)])]),_:1}),r(x,{md:"3"}),r(x,{md:"auto",class:"ms-auto"},{default:n(()=>[t("div",De,[r(A,{onSearch:s.fetchSearch},null,8,["onSearch"]),r(f,{variant:"danger",onClick:e[2]||(e[2]=a=>s.rightOffcanvas=!0)},{default:n(()=>[e[10]||(e[10]=t("i",{class:"ri-filter-2-line me-1 align-bottom"},null,-1)),k(" "+i(o.$t("filters")),1)]),_:1,__:[10]}),o.permissions.includes("add-price")?(d(),y(F,{key:0,href:"/set-prices/create"},{default:n(()=>[r(f,{variant:"primary",class:"float-end"},{default:n(()=>[e[11]||(e[11]=t("i",{class:"ri-add-line align-bottom me-1"},null,-1)),k(" "+i(o.$t("add_set_price")),1)]),_:1,__:[11]})]),_:1})):m("",!0)])]),_:1})]),_:1})]),_:1}),r(L,{class:"border border-dashed border-end-0 border-start-0"},{default:n(()=>[t("div",Oe,[t("table",ze,[t("thead",Te,[t("tr",null,[t("th",Le,i(o.$t("zone")),1),t("th",Ve,i(o.$t("transport_type")),1),t("th",Ue,i(o.$t("vehicle_type")),1),t("th",Ae,i(o.$t("status")),1),t("th",Fe,i(o.$t("action")),1)])]),s.results.length>0?(d(),g("tbody",He,[(d(!0),g(G,null,Z(s.results,(a,q)=>(d(),g("tr",{key:q},[t("td",null,i(a.zone_name),1),t("td",null,[a.transport_type==="taxi"?(d(),g("span",Ie,i(o.$t("taxi")),1)):a.transport_type==="delivery"?(d(),g("span",Ne,i(o.$t("delivery")),1)):(d(),g("span",Ee,i(o.$t("all")),1))]),t("td",null,i(a.name),1),o.permissions.includes("toggle-price")?(d(),g("td",$e,[t("div",{class:ve({"form-check":!0,"form-switch":!0,"form-switch-lg":!0,"form-switch-success":a.active})},[t("input",{class:"form-check-input",type:"checkbox",role:"switch",onClick:S(b=>s.toggleActiveStatus(a.id,!a.active),["prevent"]),id:"status_"+a.id,checked:a.active},null,8,Re)],2)])):m("",!0),t("td",null,[t("div",qe,[o.permissions.includes("edit-price")?P((d(),y(f,{key:0,class:"btn btn-soft-warning btn-sm m-2",onClick:S(b=>s.editData(a),["prevent"]),"data-bs-toggle":"tooltip",title:o.$t("edit")},{default:n(()=>e[12]||(e[12]=[t("i",{class:"bx bxs-edit-alt bx-xs"},null,-1)])),_:2,__:[12]},1032,["onClick","title"])),[[h,void 0,void 0,{hover:!0}]]):m("",!0),o.permissions.includes("add-package-price")?P((d(),y(f,{key:1,onClick:S(b=>s.packagesData(a),["prevent"]),class:"btn btn-soft-success btn-sm m-2","data-bs-toggle":"tooltip",title:o.$t("set_package_prices")},{default:n(()=>e[13]||(e[13]=[t("i",{class:"bx bx-gift bx-xs"},null,-1)])),_:2,__:[13]},1032,["onClick","title"])),[[h,void 0,void 0,{hover:!0}]]):m("",!0),o.permissions.includes("add-package-price")&&p.show_driver_level_feature?P((d(),y(f,{key:2,onClick:S(b=>s.levelUpData(a),["prevent"]),class:"btn btn-soft-dark btn-sm m-2","data-bs-toggle":"tooltip",title:o.$t("drivers-levelup")},{default:n(()=>e[14]||(e[14]=[t("i",{class:"ri-medal-fill bx-xs"},null,-1)])),_:2,__:[14]},1032,["onClick","title"])),[[h,void 0,void 0,{hover:!0}]]):m("",!0),o.permissions.includes("add-package-price")&&p.show_incentive_feature_for_driver?P((d(),y(f,{key:3,onClick:S(b=>s.incentiveData(a),["prevent"]),class:"btn btn-soft-secondary btn-sm m-2","data-bs-toggle":"tooltip",title:o.$t("incentives")},{default:n(()=>e[15]||(e[15]=[t("i",{class:"ri-coins-line bx-xs"},null,-1)])),_:2,__:[15]},1032,["onClick","title"])),[[h,void 0,void 0,{hover:!0}]]):m("",!0),o.permissions.includes("zone-surge")?P((d(),y(f,{key:4,onClick:S(b=>s.surgeData(a),["prevent"]),class:"btn btn-soft-danger btn-sm m-2","data-bs-toggle":"tooltip",title:o.$t("surge")},{default:n(()=>e[16]||(e[16]=[t("i",{class:"ri-flashlight-line bx-xs"},null,-1)])),_:2,__:[16]},1032,["onClick","title"])),[[h,void 0,void 0,{hover:!0}]]):m("",!0),o.permissions.includes("edit-price")&&p.enable_fixed_fare?P((d(),y(f,{key:5,class:"btn btn-soft-secondary btn-sm m-2",onClick:S(b=>s.fixFareData(a),["prevent"]),"data-bs-toggle":"tooltip",title:o.$t("farefix")},{default:n(()=>e[17]||(e[17]=[t("i",{class:"bx bxs-traffic-cone bx-xs"},null,-1)])),_:2,__:[17]},1032,["onClick","title"])),[[h,void 0,void 0,{hover:!0}]]):m("",!0)])])]))),128))])):(d(),g("tbody",Ye,[t("tr",null,[t("td",Ze,[e[18]||(e[18]=t("img",{src:Be,alt:"Loading...",style:{width:"100px"}},null,-1)),t("h5",null,i(o.$t("no_data_found")),1)])])]))])])]),_:1})]),_:1}),r(E,{paginator:s.paginator,onPageChanged:s.handlePageChanged},null,8,["paginator","onPageChanged"])]),_:1})]),_:1}),s.successMessage?(d(),g("div",Ge,[t("div",Je,[e[19]||(e[19]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[20]||(e[20]=k()),e[21]||(e[21]=t("strong",null,"Success",-1)),k(" - "+i(s.successMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-success",onClick:e[3]||(e[3]=(...a)=>s.dismissMessage&&s.dismissMessage(...a)),"aria-label":"Close Success Message"})])])):m("",!0),s.alertMessage?(d(),g("div",Ke,[t("div",Qe,[e[22]||(e[22]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[23]||(e[23]=k()),e[24]||(e[24]=t("strong",null,"Alert",-1)),k(" - "+i(s.alertMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-danger",onClick:e[4]||(e[4]=(...a)=>s.dismissMessage&&s.dismissMessage(...a)),"aria-label":"Close Alert Message"})])])):m("",!0),r(R,{modelValue:s.rightOffcanvas,"onUpdate:modelValue":e[8]||(e[8]=a=>s.rightOffcanvas=a),placement:"end","onUpdate:show":e[9]||(e[9]=a=>s.rightOffcanvas=a)},{header:n(()=>[t("h5",We,i(o.$t("filters")),1),r(f,{variant:"white",class:"text-reset p-0",onClick:e[5]||(e[5]=a=>s.rightOffcanvas=!1)},{default:n(()=>e[25]||(e[25]=[t("i",{class:"mdi mdi-close"},null,-1)])),_:1,__:[25]})]),default:n(()=>[r($,{class:"p-0 overflow-hidden"},{default:n(()=>[t("div",je,[t("div",Xe,[t("label",et,i(o.$t("zone")),1),r(H,{modelValue:s.filter.zone_id,"onUpdate:modelValue":e[6]||(e[6]=a=>s.filter.zone_id=a),"close-on-select":!1,searchable:!0,multiple:"",placeholder:"Select Zone",mode:"tags",options:s.zoneOptions.map(a=>({value:a.id,label:a.name}))},null,8,["modelValue","options"])]),t("div",tt,[t("label",st,i(o.$t("vehicle_type")),1),r(H,{modelValue:s.filter.type_id,"onUpdate:modelValue":e[7]||(e[7]=a=>s.filter.type_id=a),"close-on-select":!1,searchable:!0,multiple:"",placeholder:"Select Vehicle Type",mode:"tags",options:s.vehicleTypeOptions.map(a=>({value:a.id,label:a.name}))},null,8,["modelValue","options"])])]),t("div",at,[r(f,{type:"button",variant:"light",class:"w-100",onClick:s.clearFilter},{default:n(()=>[k(i(o.$t("clear_filter")),1)]),_:1},8,["onClick"]),r(f,{type:"button",variant:"success",class:"w-100",onClick:s.filterData},{default:n(()=>[k(i(o.$t("filters")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue"])]),_:1})}const gt=le(we,[["render",ot]]);export{gt as default};
