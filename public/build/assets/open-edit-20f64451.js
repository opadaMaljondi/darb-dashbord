import{_ as G,Z as J,D as K,r as z,T as Y,Y as f,o as Q,g as x,i as r,y as F,w as E,a as N,N as P,l as S,k as i,n as e,p as W,J as n,t as p,K as O,F as B,L as D,C as d,q as X,M as b,z as v}from"./vendor-8caf5d52.js";import{L as $}from"./main-cc7bd0ce.js";import{P as ee}from"./page-header-18309276.js";import{u as oe}from"./footer-502c2797.js";import"./app-974c65a1.js";const te={components:{Layout:$,PageHeader:ee,Head:J},props:{zone:Object,successMessage:String,alertMessage:String,existingZones:Array,enable_maximum_distance_feature:Boolean,settings:Object},setup(a){const{zone:o}=a,{t:m}=K(),{languages:t,fetchData:U}=oe(),C=z("English"),w=z(a.successMessage||""),k=z(a.alertMessage||""),T=z(a.settings.enable_peak_zone_feature==1),g=Y({service_location_id:o.service_location_id,languageFields:o?o.languageFields||{}:{},unit:o.unit,coordinates:o.coordinates||[],maximum_outstation_distance:o.maximum_outstation_distance??(a.enable_maximum_distance_feature?"":0),maximum_distance:o.maximum_distance??(a.maximum_distance?"":0),peak_zone_radius:o.peak_zone_radius??(a.peak_zone_radius?"":0),peak_zone_duration:o.peak_zone_duration??(a.peak_zone_duration?"":0),peak_zone_history_duration:o.peak_zone_history_duration??(a.peak_zone_history_duration?"":0),peak_zone_ride_count:o.peak_zone_ride_count??(a.peak_zone_ride_count?"":0),distance_price_percentage:o.distance_price_percentage??(a.distance_price_percentage?"":0)}),M=z([]);let s,y,h=[];const q=f.latLngBounds(),A=async()=>{const _=await N.get("/zones/list");M.value=_.data.results},H=()=>{if(o&&o.coordinates){s=f.map("map").setView([0,0],10),f.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"Â© OpenStreetMap"}).addTo(s);const _=new f.FeatureGroup;s.addLayer(_),a.existingZones.forEach(c=>{const l=c.map(u=>[u.lat,u.lng]);f.polygon(l,{color:"red",interactive:!1}).addTo(s)}),o.coordinates.forEach(c=>{const l=c[0].map(u=>[u.coordinates[1],u.coordinates[0]]);y=f.polygon(l,{color:"blue",weight:3,fillOpacity:.2}).addTo(_),q.extend(y.getBounds()),h.push(y)}),s.fitBounds(q),Z(_)}},Z=_=>{const c=new f.Control.Draw({edit:{featureGroup:_,remove:!0},draw:{polygon:{allowIntersection:!1},rectangle:!1,circle:!1,polyline:!1,marker:!1}});s.addControl(c),s.on(f.Draw.Event.CREATED,function(l){const u=l.layer;_.addLayer(u),h.push(u)}),s.on(f.Draw.Event.DELETED,function(l){l.layers.eachLayer(function(V){h=h.filter(L=>L!==V)})})},j=async()=>{const _=I();if(Object.keys(_).length===0)try{if(h.length===0){k.value=m("at_least_one_completed_polygon_is_required");return}const c=h.map(V=>V.getLatLngs()[0].map(L=>[L.lng,L.lat])),l={...g.data(),coordinates:JSON.stringify(c)};(await N.post(`/zones/update/${o.id}`,l)).status===200?(w.value=m("zone_created_successfully"),g.reset(),P.get("/zones")):console.error(m("failed_to_update_zone"))}catch(c){c.response&&c.response.status===403?(k.value=c.response.data.alertMessage,setTimeout(()=>{P.get("/zones")},5e3)):console.error(m("error_updating_zone"),c)}else g.errors=_},I=()=>{const{service_location_id:_,unit:c}=g,l={};return c?delete l.unit:l.unit="Unit is required",_?delete l.service_location_id:l.service_location_id=m("service_location_is_required"),a.enable_maximum_distance_feature&&(maximum_distance?delete l.maximum_distance:l.maximum_distance=m("required"),maximum_outstation_distance?delete l.maximum_outstation_distance:l.maximum_outstation_distance=m("required")),l},R=_=>{C.value=_};return Q(async()=>{Object.keys(t).length==0&&await U(),H(),A()}),{form:g,serviceLocations:M,handleSubmit:j,setActiveTab:R,languages:t,activeTab:C,successMessage:w,alertMessage:k,enable_peak_zone_feature:T}}},se={key:0,class:"row"},ae={class:"col-lg-6"},ne={class:"card"},re={class:"card-body"},ie={class:"mb-3"},le={for:"service_location",class:"form-label"},de={value:"",disabled:""},_e=["value"],ce={key:0,class:"text-danger"},me={class:"nav nav-tabs nav-tabs-custom nav-success nav-justified",role:"tablist"},ue={class:"nav-item",role:"presentation"},pe=["onClick"],fe=["id"],be={class:"col-sm-6 mt-3"},ve={class:"mb-3"},ge=["for"],ye=["placeholder","id","onUpdate:modelValue","required"],he={class:"mb-3"},ke={for:"select_unit",class:"form-label"},ze={disabled:"",value:""},xe={value:"1"},we={value:"2"},Me={key:0,class:"text-danger"},Le={key:0,class:"mb-3"},Ce={for:"maximum_distance",class:"form-label"},Te=["placeholder"],Ve={key:0,class:"text-danger"},Ee={key:1,class:"mb-3"},Se={for:"maximum_outstation_distance",class:"form-label"},Be=["placeholder"],De={key:0,class:"text-danger"},Ue={key:2,class:"row"},qe={class:"col-sm-6"},Fe={class:"mb-3"},Ne={for:"peak_zone_ride_count",class:"form-label"},Pe={class:"input-group"},Oe=["readonly","placeholder"],Ae={key:0,class:"text-danger"},He={class:"col-sm-6"},Ze={class:"mb-3"},je={for:"peak_zone_radius",class:"form-label"},Ie={class:"input-group"},Re=["readonly","placeholder"],Ge={key:0,class:"text-danger"},Je={key:3,class:"row"},Ke={class:"col-sm-6"},Ye={class:"mb-3"},Qe={for:"peak_zone_history_duration",class:"form-label"},We=["readonly","placeholder"],Xe={key:0,class:"text-danger"},$e={class:"col-sm-6"},eo={class:"mb-3"},oo={for:"peak_zone_duration",class:"form-label"},to={class:"input-group"},so=["readonly","placeholder"],ao={key:0,class:"text-danger"},no={key:0,class:"row"},ro={class:"col-sm-6"},io={class:"mb-3"},lo={for:"distance_price_percentage",class:"form-label"},_o={href:"",class:"text-success","data-bs-toggle":"modal","data-bs-target":"#surge"},co={class:"input-group"},mo=["readonly","placeholder"],uo={key:0,class:"text-danger"},po={class:"text-end"},fo={type:"submit",class:"btn btn-primary"},bo={class:"mb-3"},vo={key:0,class:"text-danger"},go={key:1,class:"alert alert-success"},yo={key:2,class:"custom-alert alert alert-danger alert-border-left fade show",role:"alert",id:"alertMsg"},ho={class:"alert-content"};function ko(a,o,m,t,U,C){const w=x("Head"),k=x("PageHeader"),T=x("BCol"),g=x("BRow"),M=x("Layout");return r(),F(M,null,{default:E(()=>[S(w,{title:"Edit Zone"}),S(k,{title:a.$t("edit"),pageTitle:a.$t("zone"),pageLink:"/zones"},null,8,["title","pageTitle"]),m.zone?(r(),i("div",se,[e("div",ae,[e("div",ne,[e("div",re,[e("form",{onSubmit:o[9]||(o[9]=W((...s)=>t.handleSubmit&&t.handleSubmit(...s),["prevent"]))},[e("div",ie,[e("label",le,n(a.$t("service_location")),1),p(e("select",{class:"form-select",id:"service_location","onUpdate:modelValue":o[0]||(o[0]=s=>t.form.service_location_id=s)},[e("option",de,n(a.$t("select_service_location")),1),(r(!0),i(B,null,D(t.serviceLocations,s=>(r(),i("option",{key:s.id,value:s.id},n(s.name),9,_e))),128))],512),[[O,t.form.service_location_id]]),t.form.errors.service_location_id?(r(),i("span",ce,n(t.form.errors.service_location_id),1)):d("",!0)]),e("ul",me,[(r(!0),i(B,null,D(t.languages,s=>(r(),F(g,{key:s.code},{default:E(()=>[S(T,{lg:"12"},{default:E(()=>[e("li",ue,[e("a",{class:X(["nav-link",{active:t.activeTab===s.label}]),onClick:y=>t.setActiveTab(s.label),role:"tab","aria-selected":"true"},n(s.label),11,pe)])]),_:2},1024)]),_:2},1024))),128))]),(r(!0),i(B,null,D(t.languages,s=>(r(),i("div",{class:"tab-content text-muted",key:s.code},[t.activeTab===s.label?(r(),i("div",{key:0,class:"tab-pane active show",id:`${s.label}`,role:"tabpanel"},[e("div",be,[e("div",ve,[e("label",{for:`name-${s.code}`,class:"form-label"},n(a.$t("name")),9,ge),p(e("input",{type:"text",class:"form-control",placeholder:`Enter Name in ${s.label}`,id:`name-${s.code}`,"onUpdate:modelValue":y=>t.form.languageFields[s.code]=y,required:s.code==="en"},null,8,ye),[[b,t.form.languageFields[s.code]]])])])],8,fe)):d("",!0)]))),128)),e("div",he,[e("label",ke,n(a.$t("select_unit")),1),p(e("select",{id:"select_unit",class:"form-select","onUpdate:modelValue":o[1]||(o[1]=s=>t.form.unit=s)},[e("option",ze,n(a.$t("choose_unit")),1),e("option",xe,n(a.$t("kilo_meter")),1),e("option",we,n(a.$t("miles")),1)],512),[[O,t.form.unit]]),t.form.errors.unit?(r(),i("span",Me,n(t.form.errors.unit),1)):d("",!0)]),m.enable_maximum_distance_feature?(r(),i("div",Le,[e("label",Ce,[v(n(a.$t("maximum_distance"))+" ",1),o[11]||(o[11]=e("span",{class:"text-danger"},"*",-1))]),p(e("input",{type:"number",step:"any",class:"form-control",placeholder:a.$t("enter_maximum_distance"),id:"maximum_distance","onUpdate:modelValue":o[2]||(o[2]=s=>t.form.maximum_distance=s)},null,8,Te),[[b,t.form.maximum_distance,void 0,{number:!0}]]),t.form.errors.enter_maximum_distance?(r(),i("span",Ve,n(t.form.errors.enter_maximum_distance),1)):d("",!0)])):d("",!0),m.enable_maximum_distance_feature?(r(),i("div",Ee,[e("label",Se,[v(n(a.$t("maximum_outstation_distance"))+" ",1),o[12]||(o[12]=e("span",{class:"text-danger"},"*",-1))]),p(e("input",{type:"number",step:"any",class:"form-control",placeholder:a.$t("enter_maximum_outstation_distance"),id:"maximum_outstation_distance","onUpdate:modelValue":o[3]||(o[3]=s=>t.form.maximum_outstation_distance=s)},null,8,Be),[[b,t.form.maximum_outstation_distance,void 0,{number:!0}]]),t.form.errors.maximum_outstation_distance?(r(),i("span",De,n(t.form.errors.maximum_outstation_distance),1)):d("",!0)])):d("",!0),t.enable_peak_zone_feature?(r(),i("div",Ue,[e("div",qe,[e("div",Fe,[e("label",Ne,[v(n(a.$t("peak_zone_ride_count"))+" ",1),o[13]||(o[13]=e("span",{class:"text-danger"},"*",-1))]),e("div",Pe,[p(e("input",{type:"number",readonly:a.app_for==="demo",class:"form-control",placeholder:a.$t("enter_peak_zone_ride_count"),id:"peak_zone_ride_count","onUpdate:modelValue":o[4]||(o[4]=s=>t.form.peak_zone_ride_count=s)},null,8,Oe),[[b,t.form.peak_zone_ride_count]]),t.form.errors.peak_zone_ride_count?(r(),i("span",Ae,n(t.form.errors.peak_zone_ride_count),1)):d("",!0)])])]),e("div",He,[e("div",Ze,[e("label",je,[v(n(a.$t("peak_zone_radius"))+" ",1),o[14]||(o[14]=e("span",{class:"text-danger"},"*",-1))]),e("div",Ie,[p(e("input",{type:"number",readonly:a.app_for==="demo",class:"form-control",placeholder:a.$t("enter_peak_zone_radius"),id:"peak_zone_radius","onUpdate:modelValue":o[5]||(o[5]=s=>t.form.peak_zone_radius=s)},null,8,Re),[[b,t.form.peak_zone_radius]]),t.form.errors.peak_zone_radius?(r(),i("span",Ge,n(t.form.errors.peak_zone_radius),1)):d("",!0)])])])])):d("",!0),t.enable_peak_zone_feature?(r(),i("div",Je,[e("div",Ke,[e("div",Ye,[e("label",Qe,[v(n(a.$t("peak_zone_history_duration"))+" ",1),o[15]||(o[15]=e("span",{class:"text-danger"},"*",-1))]),p(e("input",{type:"number",readonly:a.app_for==="demo",class:"form-control",placeholder:a.$t("enter_peak_zone_history_duration"),id:"peak_zone_history_duration","onUpdate:modelValue":o[6]||(o[6]=s=>t.form.peak_zone_history_duration=s)},null,8,We),[[b,t.form.peak_zone_history_duration]]),t.form.errors.peak_zone_history_duration?(r(),i("span",Xe,n(t.form.errors.peak_zone_history_duration),1)):d("",!0)])]),e("div",$e,[e("div",eo,[e("label",oo,[v(n(a.$t("peak_zone_duration"))+" ",1),o[16]||(o[16]=e("span",{class:"text-danger"},"*",-1))]),e("div",to,[p(e("input",{type:"number",readonly:a.app_for==="demo",class:"form-control",placeholder:a.$t("enter_peak_zone_duration"),id:"peak_zone_duration","onUpdate:modelValue":o[7]||(o[7]=s=>t.form.peak_zone_duration=s)},null,8,so),[[b,t.form.peak_zone_duration]]),t.form.errors.peak_zone_duration?(r(),i("span",ao,n(t.form.errors.peak_zone_duration),1)):d("",!0)])])]),t.enable_peak_zone_feature?(r(),i("div",no,[e("div",ro,[e("div",io,[e("label",lo,[v(n(a.$t("distance_price_percentage"))+" ",1),o[17]||(o[17]=e("span",{class:"text-danger"},"*",-1)),e("a",_o,n(a.$t("how_it_works")),1)]),e("div",co,[p(e("input",{type:"number",readonly:a.app_for==="demo",class:"form-control",placeholder:a.$t("enter_distance_price_percentage"),id:"distance_price_percentage","onUpdate:modelValue":o[8]||(o[8]=s=>t.form.distance_price_percentage=s)},null,8,mo),[[b,t.form.distance_price_percentage]]),t.form.errors.distance_price_percentage?(r(),i("span",uo,n(t.form.errors.distance_price_percentage),1)):d("",!0)])])])])):d("",!0)])):d("",!0),e("div",po,[e("button",fo,n(a.$t("update")),1)]),e("div",bo,[t.form.errors.coordinates?(r(),i("span",vo,n(t.form.errors.coordinates),1)):d("",!0)])],32)])])]),o[18]||(o[18]=e("div",{class:"col-lg-6"},[e("div",{class:"card"},[e("div",{class:"card-body"},[e("div",{id:"map",style:{height:"400px"}})])])],-1))])):d("",!0),t.successMessage?(r(),i("div",go,n(t.successMessage),1)):d("",!0),t.alertMessage?(r(),i("div",yo,[e("div",ho,[o[19]||(o[19]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),o[20]||(o[20]=e("strong",null,"Alert",-1)),v(" - "+n(t.alertMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-danger",onClick:o[10]||(o[10]=(...s)=>a.dismissMessage&&a.dismissMessage(...s)),"aria-label":"Close Alert Message"})])])):d("",!0),o[21]||(o[21]=e("div",{id:"surge",class:"modal fade",tabindex:"-1","aria-labelledby":"surgeLabel","aria-hidden":"true",style:{display:"none"}},[e("div",{class:"modal-dialog"},[e("div",{class:"modal-content"},[e("div",{class:"modal-header"},[e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]),e("div",{class:"modal-body"},[e("h5",{class:"fs-15"}," Peak Zone Surge Percentage "),e("p",{class:"text-muted"}," The percentage with which the price per distance increases when the ride is created within the peakzone ")])])])],-1))]),_:1,__:[21]})}const Co=G(te,[["render",ko],["__scopeId","data-v-ce9a68cc"]]);export{Co as default};
