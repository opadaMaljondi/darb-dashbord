import{_ as T,Z as N,O as A,P as E,D as j,T as q,r as g,R as O,a as H,G as z,o as G,g as _,i as n,y as I,w as v,N as J,l as m,n as e,k as d,J as a,t as h,K as V,F as k,L as M,C as p,X as P,z as D,p as K}from"./vendor-8caf5d52.js";import{L as X}from"./main-cc7bd0ce.js";import{P as Y}from"./page-header-18309276.js";import{P as Z}from"./Pagination-0518e4bd.js";import{i as Q}from"./imageUpload-5fcb01e8.js";import{F as W}from"./FormValidation-f14f6003.js";import"./footer-502c2797.js";import"./app-974c65a1.js";/* empty css                                                    */const x={components:{Layout:X,PageHeader:Y,Head:N,Pagination:Z,Multiselect:A,FormValidation:W,imageUpload:Q,flatPickr:E},props:{successMessage:String,alertMessage:String,validate:Function,owners:Array},setup(l){const{t:s}=j(),c=q({date:"",trip_status:"0",select_date_option:"",file_format:"",owner:"",fleet_id:""}),t=g([]),R={select_date_option:{required:!0},file_format:{required:!0}};O(()=>c.owner,r=>{r?C(r):t.value=[]});const C=async r=>{try{const i=await H.get(`/report/list-fleets?owner_id=${r}`);t.value=i.data.fleets.map(o=>({...o,fleetLabel:`${o.id} - ${o.vehicleType?o.vehicleType.vehicle_type_name:"Unknown"}`}))}catch(i){console.error("Error fetching fleets:",i),f.value.select_fleet=[s("failed_to_load_fleets")]}},B=g(null),f=g({}),b=g(l.successMessage||""),y=g(l.alertMessage||""),L=()=>{b.value="",y.value=""},w=g(!1),S=async()=>{if(f.value=B.value.validate(),!(Object.keys(f.value).length>0)){w.value=!0;try{console.log("Form Data:",c.data());const r=await H.post("/report/fleet-report-download",c.data(),{responseType:"blob"}),i=window.URL.createObjectURL(new Blob([r.data])),o=document.createElement("a");o.href=i,o.setAttribute("download",`fleet_report.${c.file_format}`),document.body.appendChild(o),o.click(),o.remove(),b.value=s("report_downloaded_successfully"),c.reset(),J.get("/report/fleet-report")}catch(r){r.response&&r.response.status===422?f.value=r.response.data.errors:(console.error(s("error_downloading_report"),r),y.value=s("failed_to_download_report"))}finally{w.value=!1}}},F=z(()=>{if(c.date&&c.date.length===2){const r=new Date(c.date[0]),i=new Date(c.date[1]),o=r.toLocaleString("default",{month:"short"}),u=i.toLocaleString("default",{month:"short"});return`${r.getDate()} ${o} - ${i.getDate()} ${u}`}return""});return G(()=>{var r;((r=l.owners)==null?void 0:r.length)==1&&(c.owner=l.owners[0].id),c.owner&&C(c.owner)}),{form:c,successMessage:b,alertMessage:y,handleSubmit:S,dismissMessage:L,validationRules:R,validationRef:B,errors:f,formattedDate:F,rangeDateconfig:{mode:"range",dateFormat:"d M, Y",maxDate:"today"},fleets:t,fetchFleets:C,loading:w}}},$={class:"row"},ee={key:0,class:"col-sm-6"},te={class:"mb-3"},oe={for:"owner",class:"form-label"},se={disabled:"",value:""},ae=["value"],le={key:0,class:"text-danger"},re={class:"col-sm-6"},ne={class:"mb-3"},ie={for:"fleet_id",class:"form-label"},de={disabled:"",value:""},ce=["value"],_e={key:0,class:"text-danger"},me={class:"col-sm-6"},fe={class:"mb-3"},ue={for:"trip_status",class:"form-label"},pe={class:"mt-3"},ge={class:"form-check form-check-inline"},ve={class:"form-check-label",for:"completed"},he={class:"form-check form-check-inline"},be={class:"form-check-label",for:"cancelled"},ye={key:0,class:"text-danger"},we={class:"col-sm-6"},ke={class:"mb-3"},Me={for:"select_date_option",class:"form-label"},Ce={disabled:"",value:""},Be={value:"today"},Ve={value:"this_week"},De={value:"this_month"},Le={value:"this_year"},Se={value:"date"},Fe={key:1,class:"col-sm-6"},Re={class:"mb-4"},Ue={for:"datepicker-range",class:"form-label"},He={class:"col-sm-6"},Pe={class:"mb-3"},Te={for:"file_format",class:"form-label"},Ne={disabled:"",selected:"",value:""},Ae={value:"xlsx"},Ee={value:"csv"},je={class:"col-lg-12"},qe={class:"text-end"},Oe=["disabled"],ze={key:0,class:"custom-alert alert alert-success alert-border-left fade show",role:"alert",id:"alertMsg"},Ge={class:"alert-content"},Ie={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",role:"alert",id:"alertMsg"},Je={class:"alert-content"};function Ke(l,s,c,t,R,C){const B=_("Head"),f=_("PageHeader"),b=_("BCardHeader"),y=_("flat-pickr"),L=_("FormValidation"),w=_("BCardBody"),S=_("BCard"),F=_("BCol"),U=_("BRow"),r=_("Layout");return n(),I(r,null,{default:v(()=>[m(B,{title:"Fleet Report"}),m(f,{title:l.$t("fleet_finance_report"),pageTitle:l.$t("fleet_report")},null,8,["title","pageTitle"]),m(U,null,{default:v(()=>[m(F,{lg:"12"},{default:v(()=>[m(S,{"no-body":"",id:"tasksList"},{default:v(()=>[m(b,{class:"border-0"}),m(w,{class:"border border-dashed border-end-0 border-start-0"},{default:v(()=>[e("form",{onSubmit:s[7]||(s[7]=K((...i)=>t.handleSubmit&&t.handleSubmit(...i),["prevent"]))},[m(L,{form:t.form,rules:t.validationRules,ref:"validationRef"},{default:v(()=>{var i;return[e("div",$,[((i=c.owners)==null?void 0:i.length)>1?(n(),d("div",ee,[e("div",te,[e("label",oe,a(l.$t("owner")),1),h(e("select",{id:"owner",class:"form-select","onUpdate:modelValue":s[0]||(s[0]=o=>t.form.owner=o)},[e("option",se,a(l.$t("select")),1),(n(!0),d(k,null,M(c.owners,o=>(n(),d("option",{key:o.id,value:o.id},a(o.name),9,ae))),128))],512),[[V,t.form.owner]]),t.errors.owner?(n(),d("span",le,a(t.errors.owner),1)):p("",!0)])])):p("",!0),e("div",re,[e("div",ne,[e("label",ie,a(l.$t("fleet_id")),1),h(e("select",{id:"fleet_id",class:"form-select","onUpdate:modelValue":s[1]||(s[1]=o=>t.form.fleet_id=o)},[e("option",de,a(l.$t("select")),1),(n(!0),d(k,null,M(t.fleets,o=>(n(),d("option",{key:o.id,value:o.id},a(o.vehicle_type_name),9,ce))),128))],512),[[V,t.form.fleet_id]]),t.errors.fleet_id?(n(),d("span",_e,a(t.errors.fleet_id),1)):p("",!0)])]),e("div",me,[e("div",fe,[e("label",ue,a(l.$t("trip_status")),1),e("div",pe,[e("div",ge,[h(e("input",{class:"form-check-input",type:"radio",name:"trip_status",id:"completed",value:0,"onUpdate:modelValue":s[2]||(s[2]=o=>t.form.trip_status=o)},null,512),[[P,t.form.trip_status]]),e("label",ve,a(l.$t("completed")),1)]),e("div",he,[h(e("input",{class:"form-check-input",type:"radio",name:"trip_status",id:"cancelled",value:1,"onUpdate:modelValue":s[3]||(s[3]=o=>t.form.trip_status=o)},null,512),[[P,t.form.trip_status]]),e("label",be,a(l.$t("cancelled")),1)])]),t.errors.trip_status?(n(),d("span",ye,a(t.errors.trip_status),1)):p("",!0)])]),e("div",we,[e("div",ke,[e("label",Me,[D(a(l.$t("date_option"))+" ",1),s[10]||(s[10]=e("span",{class:"text-danger"},"*",-1))]),h(e("select",{id:"select_date_option",class:"form-select","onUpdate:modelValue":s[4]||(s[4]=o=>t.form.select_date_option=o)},[e("option",Ce,a(l.$t("select")),1),e("option",Be,a(l.$t("today")),1),e("option",Ve,a(l.$t("this_week")),1),e("option",De,a(l.$t("this_month")),1),e("option",Le,a(l.$t("this_year")),1),e("option",Se,a(l.$t("date")),1)],512),[[V,t.form.select_date_option]]),(n(!0),d(k,null,M(t.errors.select_date_option,(o,u)=>(n(),d("span",{key:u,class:"text-danger"},a(o),1))),128))])]),t.form.select_date_option==="date"?(n(),d("div",Fe,[e("div",Re,[e("label",Ue,a(l.$t("from_to_date")),1),m(y,{placeholder:l.$t("select_date"),modelValue:t.form.date,"onUpdate:modelValue":s[5]||(s[5]=o=>t.form.date=o),config:t.rangeDateconfig,class:"form-control flatpickr-input",id:"datepicker-range"},null,8,["placeholder","modelValue","config"]),(n(!0),d(k,null,M(t.errors.date,(o,u)=>(n(),d("span",{key:u,class:"text-danger"},a(o),1))),128))])])):p("",!0),e("div",He,[e("div",Pe,[e("label",Te,[D(a(l.$t("file_format"))+" ",1),s[11]||(s[11]=e("span",{class:"text-danger"},"*",-1))]),h(e("select",{id:"file_format",class:"form-select","onUpdate:modelValue":s[6]||(s[6]=o=>t.form.file_format=o)},[e("option",Ne,a(l.$t("select_file_format")),1),e("option",Ae,a(l.$t("excel")),1),e("option",Ee,a(l.$t("csv")),1)],512),[[V,t.form.file_format]]),(n(!0),d(k,null,M(t.errors.file_format,(o,u)=>(n(),d("span",{key:u,class:"text-danger"},a(o),1))),128))])]),e("div",je,[e("div",qe,[e("button",{type:"submit",class:"btn btn-primary",disabled:t.loading},a(l.$t("download")),9,Oe)])])])]}),_:1},8,["form","rules"])],32)]),_:1})]),_:1})]),_:1})]),_:1}),e("div",null,[t.successMessage?(n(),d("div",ze,[e("div",Ge,[s[12]||(s[12]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),s[13]||(s[13]=e("strong",null,"Success",-1)),D(" - "+a(t.successMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-success",onClick:s[8]||(s[8]=(...i)=>t.dismissMessage&&t.dismissMessage(...i)),"aria-label":"Close Success Message"})])])):p("",!0),t.alertMessage?(n(),d("div",Ie,[e("div",Je,[s[14]||(s[14]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),s[15]||(s[15]=e("strong",null,"Alert",-1)),D(" - "+a(t.alertMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-danger",onClick:s[9]||(s[9]=(...i)=>t.dismissMessage&&t.dismissMessage(...i)),"aria-label":"Close Alert Message"})])])):p("",!0)])]),_:1})}const ot=T(x,[["render",Ke]]);export{ot as default};
