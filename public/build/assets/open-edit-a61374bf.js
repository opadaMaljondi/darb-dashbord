import{_ as R,Z as G,D as K,r as x,T as Y,Y as y,o as Q,g as w,i,y as N,w as E,a as q,N as F,l as V,k as l,n as e,p as W,J as r,t as f,K as O,F as S,L as B,C as d,q as X,M as b,z as g}from"./vendor-54d6cb1e.js";import{L as $}from"./main-b839be26.js";import{P as ee}from"./page-header-ff719701.js";import{u as oe}from"./footer-7e4f68d9.js";import"./app-cb082573.js";const te={components:{Layout:$,PageHeader:ee,Head:G},props:{zone:Object,successMessage:String,alertMessage:String,existingZones:Array,enable_maximum_distance_feature:Boolean,settings:Object},setup(a){const{zone:o}=a,{t:u}=K(),{languages:t,fetchData:D}=oe(),C=x("English"),A=x(a.successMessage||""),z=x(a.alertMessage||""),T=x(a.settings.enable_peak_zone_feature==1),h=Y({service_location_id:o.service_location_id,languageFields:o?o.languageFields||{}:{},unit:o.unit,coordinates:o.coordinates||[],maximum_outstation_distance:o.maximum_outstation_distance??(a.enable_maximum_distance_feature?"":0),maximum_distance:o.maximum_distance??(a.maximum_distance?"":0),peak_zone_radius:o.peak_zone_radius??(a.peak_zone_radius?"":0),peak_zone_duration:o.peak_zone_duration??(a.peak_zone_duration?"":0),peak_zone_history_duration:o.peak_zone_history_duration??(a.peak_zone_history_duration?"":0),peak_zone_ride_count:o.peak_zone_ride_count??(a.peak_zone_ride_count?"":0),distance_price_percentage:o.distance_price_percentage??(a.distance_price_percentage?"":0)}),M=x([]);let s,k,v=[];const U=y.latLngBounds(),P=async()=>{const m=await q.get("/zones/list");M.value=m.data.results},Z=()=>{if(o&&o.coordinates){s=y.map("map").setView([0,0],10),y.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"Â© OpenStreetMap"}).addTo(s);const m=new y.FeatureGroup;s.addLayer(m),a.existingZones&&Array.isArray(a.existingZones)&&a.existingZones.forEach(n=>{if(n&&Array.isArray(n)){const p=n.map(_=>[_.lat,_.lng]);y.polygon(p,{color:"red",interactive:!1}).addTo(s)}});let c=[];if(Array.isArray(o.coordinates))c=o.coordinates;else if(o.coordinates&&typeof o.coordinates=="object"&&o.coordinates.coordinates)c=o.coordinates.coordinates;else if(typeof o.coordinates=="string")try{const n=JSON.parse(o.coordinates);c=Array.isArray(n)?n:n.coordinates||[]}catch(n){console.error("Error parsing coordinates:",n),c=[]}Array.isArray(c)&&c.length>0&&(c.forEach(n=>{if(Array.isArray(n)&&n.length>0&&Array.isArray(n[0])){const p=n[0].map(_=>_&&_.coordinates&&Array.isArray(_.coordinates)?[_.coordinates[1],_.coordinates[0]]:Array.isArray(_)&&_.length>=2?[_[1],_[0]]:null).filter(_=>_!==null);p.length>0&&(k=y.polygon(p,{color:"blue",weight:3,fillOpacity:.2}).addTo(m),U.extend(k.getBounds()),v.push(k))}}),v.length>0&&s.fitBounds(U)),j(m)}},j=m=>{const c=new y.Control.Draw({edit:{featureGroup:m,remove:!0},draw:{polygon:{allowIntersection:!1},rectangle:!1,circle:!1,polyline:!1,marker:!1}});s.addControl(c),s.on(y.Draw.Event.CREATED,function(n){const p=n.layer;m.addLayer(p),v.push(p)}),s.on(y.Draw.Event.DELETED,function(n){n.layers.eachLayer(function(_){v=v.filter(L=>L!==_)})})},H=async()=>{const m=I();if(Object.keys(m).length===0)try{if(v.length===0){z.value=u("at_least_one_completed_polygon_is_required");return}const c=v.map(_=>_.getLatLngs()[0].map(L=>[L.lng,L.lat])),n={...h.data(),coordinates:JSON.stringify(c)};(await q.post(`/zones/update/${o.id}`,n)).status===200?(A.value=u("zone_created_successfully"),h.reset(),F.get("/zones")):console.error(u("failed_to_update_zone"))}catch(c){c.response&&c.response.status===403?(z.value=c.response.data.alertMessage,setTimeout(()=>{F.get("/zones")},5e3)):console.error(u("error_updating_zone"),c)}else h.errors=m},I=()=>{const{service_location_id:m,unit:c}=h,n={};return c?delete n.unit:n.unit="Unit is required",m?delete n.service_location_id:n.service_location_id=u("service_location_is_required"),a.enable_maximum_distance_feature&&(maximum_distance?delete n.maximum_distance:n.maximum_distance=u("required"),maximum_outstation_distance?delete n.maximum_outstation_distance:n.maximum_outstation_distance=u("required")),n},J=m=>{C.value=m};return Q(async()=>{Object.keys(t).length==0&&await D(),Z(),P()}),{form:h,serviceLocations:M,handleSubmit:H,setActiveTab:J,languages:t,activeTab:C,successMessage:A,alertMessage:z,enable_peak_zone_feature:T}}},se={key:0,class:"row"},ae={class:"col-lg-6"},ne={class:"card"},re={class:"card-body"},ie={class:"mb-3"},le={for:"service_location",class:"form-label"},de={value:"",disabled:""},ce=["value"],_e={key:0,class:"text-danger"},me={class:"nav nav-tabs nav-tabs-custom nav-success nav-justified",role:"tablist"},ue={class:"nav-item",role:"presentation"},fe=["onClick"],pe=["id"],ye={class:"col-sm-6 mt-3"},be={class:"mb-3"},ge=["for"],he=["placeholder","id","onUpdate:modelValue","required"],ve={class:"mb-3"},ke={for:"select_unit",class:"form-label"},ze={disabled:"",value:""},xe={value:"1"},we={value:"2"},Ae={key:0,class:"text-danger"},Me={key:0,class:"mb-3"},Le={for:"maximum_distance",class:"form-label"},Ce=["placeholder"],Te={key:0,class:"text-danger"},Ee={key:1,class:"mb-3"},Ve={for:"maximum_outstation_distance",class:"form-label"},Se=["placeholder"],Be={key:0,class:"text-danger"},De={key:2,class:"row"},Ue={class:"col-sm-6"},Ne={class:"mb-3"},qe={for:"peak_zone_ride_count",class:"form-label"},Fe={class:"input-group"},Oe=["readonly","placeholder"],Pe={key:0,class:"text-danger"},Ze={class:"col-sm-6"},je={class:"mb-3"},He={for:"peak_zone_radius",class:"form-label"},Ie={class:"input-group"},Je=["readonly","placeholder"],Re={key:0,class:"text-danger"},Ge={key:3,class:"row"},Ke={class:"col-sm-6"},Ye={class:"mb-3"},Qe={for:"peak_zone_history_duration",class:"form-label"},We=["readonly","placeholder"],Xe={key:0,class:"text-danger"},$e={class:"col-sm-6"},eo={class:"mb-3"},oo={for:"peak_zone_duration",class:"form-label"},to={class:"input-group"},so=["readonly","placeholder"],ao={key:0,class:"text-danger"},no={key:0,class:"row"},ro={class:"col-sm-6"},io={class:"mb-3"},lo={for:"distance_price_percentage",class:"form-label"},co={href:"",class:"text-success","data-bs-toggle":"modal","data-bs-target":"#surge"},_o={class:"input-group"},mo=["readonly","placeholder"],uo={key:0,class:"text-danger"},fo={class:"text-end"},po={type:"submit",class:"btn btn-primary"},yo={class:"mb-3"},bo={key:0,class:"text-danger"},go={key:1,class:"alert alert-success"},ho={key:2,class:"custom-alert alert alert-danger alert-border-left fade show",role:"alert",id:"alertMsg"},vo={class:"alert-content"};function ko(a,o,u,t,D,C){const A=w("Head"),z=w("PageHeader"),T=w("BCol"),h=w("BRow"),M=w("Layout");return i(),N(M,null,{default:E(()=>[V(A,{title:"Edit Zone"}),V(z,{title:a.$t("edit"),pageTitle:a.$t("zone"),pageLink:"/zones"},null,8,["title","pageTitle"]),u.zone?(i(),l("div",se,[e("div",ae,[e("div",ne,[e("div",re,[e("form",{onSubmit:o[9]||(o[9]=W((...s)=>t.handleSubmit&&t.handleSubmit(...s),["prevent"]))},[e("div",ie,[e("label",le,r(a.$t("service_location")),1),f(e("select",{class:"form-select",id:"service_location","onUpdate:modelValue":o[0]||(o[0]=s=>t.form.service_location_id=s)},[e("option",de,r(a.$t("select_service_location")),1),(i(!0),l(S,null,B(t.serviceLocations,s=>(i(),l("option",{key:s.id,value:s.id},r(s.name),9,ce))),128))],512),[[O,t.form.service_location_id]]),t.form.errors.service_location_id?(i(),l("span",_e,r(t.form.errors.service_location_id),1)):d("",!0)]),e("ul",me,[(i(!0),l(S,null,B(t.languages,s=>(i(),N(h,{key:s.code},{default:E(()=>[V(T,{lg:"12"},{default:E(()=>[e("li",ue,[e("a",{class:X(["nav-link",{active:t.activeTab===s.label}]),onClick:k=>t.setActiveTab(s.label),role:"tab","aria-selected":"true"},r(s.label),11,fe)])]),_:2},1024)]),_:2},1024))),128))]),(i(!0),l(S,null,B(t.languages,s=>(i(),l("div",{class:"tab-content text-muted",key:s.code},[t.activeTab===s.label?(i(),l("div",{key:0,class:"tab-pane active show",id:`${s.label}`,role:"tabpanel"},[e("div",ye,[e("div",be,[e("label",{for:`name-${s.code}`,class:"form-label"},r(a.$t("name")),9,ge),f(e("input",{type:"text",class:"form-control",placeholder:`Enter Name in ${s.label}`,id:`name-${s.code}`,"onUpdate:modelValue":k=>t.form.languageFields[s.code]=k,required:s.code==="en"},null,8,he),[[b,t.form.languageFields[s.code]]])])])],8,pe)):d("",!0)]))),128)),e("div",ve,[e("label",ke,r(a.$t("select_unit")),1),f(e("select",{id:"select_unit",class:"form-select","onUpdate:modelValue":o[1]||(o[1]=s=>t.form.unit=s)},[e("option",ze,r(a.$t("choose_unit")),1),e("option",xe,r(a.$t("kilo_meter")),1),e("option",we,r(a.$t("miles")),1)],512),[[O,t.form.unit]]),t.form.errors.unit?(i(),l("span",Ae,r(t.form.errors.unit),1)):d("",!0)]),u.enable_maximum_distance_feature?(i(),l("div",Me,[e("label",Le,[g(r(a.$t("maximum_distance"))+" ",1),o[11]||(o[11]=e("span",{class:"text-danger"},"*",-1))]),f(e("input",{type:"number",step:"any",class:"form-control",placeholder:a.$t("enter_maximum_distance"),id:"maximum_distance","onUpdate:modelValue":o[2]||(o[2]=s=>t.form.maximum_distance=s)},null,8,Ce),[[b,t.form.maximum_distance,void 0,{number:!0}]]),t.form.errors.enter_maximum_distance?(i(),l("span",Te,r(t.form.errors.enter_maximum_distance),1)):d("",!0)])):d("",!0),u.enable_maximum_distance_feature?(i(),l("div",Ee,[e("label",Ve,[g(r(a.$t("maximum_outstation_distance"))+" ",1),o[12]||(o[12]=e("span",{class:"text-danger"},"*",-1))]),f(e("input",{type:"number",step:"any",class:"form-control",placeholder:a.$t("enter_maximum_outstation_distance"),id:"maximum_outstation_distance","onUpdate:modelValue":o[3]||(o[3]=s=>t.form.maximum_outstation_distance=s)},null,8,Se),[[b,t.form.maximum_outstation_distance,void 0,{number:!0}]]),t.form.errors.maximum_outstation_distance?(i(),l("span",Be,r(t.form.errors.maximum_outstation_distance),1)):d("",!0)])):d("",!0),t.enable_peak_zone_feature?(i(),l("div",De,[e("div",Ue,[e("div",Ne,[e("label",qe,[g(r(a.$t("peak_zone_ride_count"))+" ",1),o[13]||(o[13]=e("span",{class:"text-danger"},"*",-1))]),e("div",Fe,[f(e("input",{type:"number",readonly:a.app_for==="demo",class:"form-control",placeholder:a.$t("enter_peak_zone_ride_count"),id:"peak_zone_ride_count","onUpdate:modelValue":o[4]||(o[4]=s=>t.form.peak_zone_ride_count=s)},null,8,Oe),[[b,t.form.peak_zone_ride_count]]),t.form.errors.peak_zone_ride_count?(i(),l("span",Pe,r(t.form.errors.peak_zone_ride_count),1)):d("",!0)])])]),e("div",Ze,[e("div",je,[e("label",He,[g(r(a.$t("peak_zone_radius"))+" ",1),o[14]||(o[14]=e("span",{class:"text-danger"},"*",-1))]),e("div",Ie,[f(e("input",{type:"number",readonly:a.app_for==="demo",class:"form-control",placeholder:a.$t("enter_peak_zone_radius"),id:"peak_zone_radius","onUpdate:modelValue":o[5]||(o[5]=s=>t.form.peak_zone_radius=s)},null,8,Je),[[b,t.form.peak_zone_radius]]),t.form.errors.peak_zone_radius?(i(),l("span",Re,r(t.form.errors.peak_zone_radius),1)):d("",!0)])])])])):d("",!0),t.enable_peak_zone_feature?(i(),l("div",Ge,[e("div",Ke,[e("div",Ye,[e("label",Qe,[g(r(a.$t("peak_zone_history_duration"))+" ",1),o[15]||(o[15]=e("span",{class:"text-danger"},"*",-1))]),f(e("input",{type:"number",readonly:a.app_for==="demo",class:"form-control",placeholder:a.$t("enter_peak_zone_history_duration"),id:"peak_zone_history_duration","onUpdate:modelValue":o[6]||(o[6]=s=>t.form.peak_zone_history_duration=s)},null,8,We),[[b,t.form.peak_zone_history_duration]]),t.form.errors.peak_zone_history_duration?(i(),l("span",Xe,r(t.form.errors.peak_zone_history_duration),1)):d("",!0)])]),e("div",$e,[e("div",eo,[e("label",oo,[g(r(a.$t("peak_zone_duration"))+" ",1),o[16]||(o[16]=e("span",{class:"text-danger"},"*",-1))]),e("div",to,[f(e("input",{type:"number",readonly:a.app_for==="demo",class:"form-control",placeholder:a.$t("enter_peak_zone_duration"),id:"peak_zone_duration","onUpdate:modelValue":o[7]||(o[7]=s=>t.form.peak_zone_duration=s)},null,8,so),[[b,t.form.peak_zone_duration]]),t.form.errors.peak_zone_duration?(i(),l("span",ao,r(t.form.errors.peak_zone_duration),1)):d("",!0)])])]),t.enable_peak_zone_feature?(i(),l("div",no,[e("div",ro,[e("div",io,[e("label",lo,[g(r(a.$t("distance_price_percentage"))+" ",1),o[17]||(o[17]=e("span",{class:"text-danger"},"*",-1)),e("a",co,r(a.$t("how_it_works")),1)]),e("div",_o,[f(e("input",{type:"number",readonly:a.app_for==="demo",class:"form-control",placeholder:a.$t("enter_distance_price_percentage"),id:"distance_price_percentage","onUpdate:modelValue":o[8]||(o[8]=s=>t.form.distance_price_percentage=s)},null,8,mo),[[b,t.form.distance_price_percentage]]),t.form.errors.distance_price_percentage?(i(),l("span",uo,r(t.form.errors.distance_price_percentage),1)):d("",!0)])])])])):d("",!0)])):d("",!0),e("div",fo,[e("button",po,r(a.$t("update")),1)]),e("div",yo,[t.form.errors.coordinates?(i(),l("span",bo,r(t.form.errors.coordinates),1)):d("",!0)])],32)])])]),o[18]||(o[18]=e("div",{class:"col-lg-6"},[e("div",{class:"card"},[e("div",{class:"card-body"},[e("div",{id:"map",style:{height:"400px"}})])])],-1))])):d("",!0),t.successMessage?(i(),l("div",go,r(t.successMessage),1)):d("",!0),t.alertMessage?(i(),l("div",ho,[e("div",vo,[o[19]||(o[19]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),o[20]||(o[20]=e("strong",null,"Alert",-1)),g(" - "+r(t.alertMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-danger",onClick:o[10]||(o[10]=(...s)=>a.dismissMessage&&a.dismissMessage(...s)),"aria-label":"Close Alert Message"})])])):d("",!0),o[21]||(o[21]=e("div",{id:"surge",class:"modal fade",tabindex:"-1","aria-labelledby":"surgeLabel","aria-hidden":"true",style:{display:"none"}},[e("div",{class:"modal-dialog"},[e("div",{class:"modal-content"},[e("div",{class:"modal-header"},[e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]),e("div",{class:"modal-body"},[e("h5",{class:"fs-15"}," Peak Zone Surge Percentage "),e("p",{class:"text-muted"}," The percentage with which the price per distance increases when the ride is created within the peakzone ")])])])],-1))]),_:1})}const Lo=R(te,[["render",ko],["__scopeId","data-v-4e05a0cb"]]);export{Lo as default};
