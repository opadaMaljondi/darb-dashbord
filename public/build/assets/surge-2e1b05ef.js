import{_ as A,S as E,Z as R,P as $,B as q,D as G,r as M,a0 as I,g as _,i as g,y as z,w as r,a as J,W as N,l as d,n as e,J as m,k as h,L as x,z as k,C as B,F as W,t as Z,M as K}from"./vendor-54d6cb1e.js";import{L as Q}from"./main-b839be26.js";import{P as X}from"./page-header-ff719701.js";import{l as Y}from"./footer-7e4f68d9.js";import"./app-cb082573.js";const ee={data(){return{rightOffcanvas:!1}},computed:{...Y,...E(["permissions"])},components:{Layout:Q,PageHeader:X,Head:R,flatPickr:$,Link:q},props:{successMessage:String,alertMessage:String,zoneType:{type:Object,required:!0},surge:{type:Object,required:!0}},setup(o){const{t:a}=G(),T=M(o.successMessage||""),n=M(o.alertMessage||""),c=M(o.surge),S=M(o.zoneType),i=M({}),O=M("Sunday"),b=s=>{const t=s.getHours().toString().padStart(2,"0"),l=s.getMinutes().toString().padStart(2,"0");return`${t}:${l}`},f=s=>{const[t,l]=s.split(":").map(Number);return t*60+l},w={enableTime:!0,noCalendar:!0,dateFormat:"H:i",defaultDate:b(new Date)},v=I({Sunday:c?c.value.Sunday:[],Monday:c?c.value.Monday:[],Tuesday:c?c.value.Tuesday:[],Wednesday:c?c.value.Wednesday:[],Thursday:c?c.value.Thursday:[],Friday:c?c.value.Friday:[],Saturday:c?c.value.Saturday:[]}),C=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],V=s=>{if(D()){const t=new Date,l=new Date(t).addMinutes(60),p={index:v[s]?v[s].length+1:1,start_time:b(t),end_time:b(l),value:0};v[s].push(p)}F(s)},F=s=>{v[s].sort((t,l)=>{const p=f(t.start_time),u=f(l.start_time);return p-u})},D=()=>{let s=!0;return C.forEach(t=>{const l=v[t];l.length>1&&l.forEach((p,u)=>{if(u>0){const H=l[u-1],L=f(p.start_time)<f(H.end_time),U=f(p.end_time)<f(p.start_time);L?(i.value[t]||(i.value[t]={}),i.value[t][u]||(i.value[t][u]=[]),i.value[t][u]=a("surge_must_be_distinct"),s=!1):U?(i.value[t]||(i.value[t]={}),i.value[t][u]||(i.value[t][u]=[]),i.value[t][u]=a("surge_start_must_be_before_end"),s=!1):i.value[t]&&i.value[t][u]&&(delete i.value[t][u],Object.keys(i.value[t]).length===0&&delete i.value[t])}})}),s},P=async()=>{var s;try{if(D()){const t=await J.post(`/set-prices/surge/update/${(s=S==null?void 0:S.value)==null?void 0:s.id}`,{surge:v});c.value=t.data.surge,N.fire(a("success"),a("surge_updated_successfully"),"success")}}catch(t){console.log(t),N.fire(a("error"),a("surge_update_failed"),"error")}};return Date.prototype.addMinutes=function(s){return this.setMinutes(this.getMinutes()+s),this},{successMessage:T,alertMessage:n,fields:v,days:C,surgeUpdate:P,addField:V,sortBy:F,errors:i,removeField:(s,t)=>{v[s].splice(t,1)},activeDay:O,preloadingTime:w}}},se={class:"row"},te={class:"col-sm-3"},ae={class:"card border border-dashed border-primary"},oe={class:"card-body text-center"},le={class:"mb-3 flex-grow-1 text-start text-muted badge bg-secondary-subtle fs-18"},ne={class:"col-sm-3"},re={class:"card border border-dashed border-primary"},ie={class:"card-body text-center"},de={class:"mb-3 flex-grow-1 text-start text-muted badge bg-secondary-subtle fs-18"},ce={key:0,class:"text-danger"},ue={class:"text-muted"},me={class:"d-flex"},_e={class:"flex-grow-1 ms-2"},ge={class:"d-flex align-items-center gap-2"},fe={key:0,class:"d-flex flex-column align-items-center justify-content-center",style:{"min-height":"200px"}},ve={class:"text-muted mt-2"},pe={class:"col-sm-3"},be={class:"mb-3"},he={for:"from",class:"form-label"},ye={class:"col-sm-3"},ke={class:"mb-3"},Me={for:"to",class:"form-label"},Be={class:"col-sm-3"},Ce={class:"mb-3"},Te={for:"surge",class:"form-label"},Se=["onUpdate:modelValue","placeholder"],we={class:"col-sm-3"},Ve={class:"mt-3"},Fe={class:"form-check form-check-inline"},De=["onClick"],He={class:"col-sm-12"},Le={key:0,class:"text-danger"},Ue={class:"d-flex align-items-center gap-2"},ze={key:0,class:"custom-alert alert alert-success alert-border-left fade show",data:"alert",id:"alertMsg"},Oe={class:"alert-content"},Pe={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",data:"alert",id:"alertMsg"},je={class:"alert-content"};function Ne(o,a,T,n,c,S){const i=_("Head"),O=_("PageHeader"),b=_("BCol"),f=_("BRow"),w=_("BCardHeader"),v=_("BCard"),C=_("BButton"),V=_("flat-pickr"),F=_("BCardBody"),D=_("BTab"),P=_("BTabs"),j=_("Layout");return g(),z(j,null,{default:r(()=>[d(i,{title:"Surge"}),d(O,{title:o.$t("surge"),pageTitle:o.$t("surge"),pageLink:"/set-prices"},null,8,["title","pageTitle"]),d(v,{"no-body":"",id:""},{default:r(()=>[d(w,{class:"border-0"},{default:r(()=>[d(f,null,{default:r(()=>[d(b,{lg:"12"},{default:r(()=>[e("div",se,[e("div",te,[e("div",ae,[e("div",oe,[e("h4",le,m(o.$t("zone")),1),e("h5",null,m(T.zoneType.zone_name),1)])])]),e("div",ne,[e("div",re,[e("div",ie,[e("h4",de,m(o.$t("vehicle_type")),1),e("h5",null,m(T.zoneType.vehicle_type_name),1)])])])])]),_:1})]),_:1})]),_:1})]),_:1}),d(f,null,{default:r(()=>[d(b,{lg:"12"},{default:r(()=>[d(v,{"no-body":"",id:"tasksList"},{default:r(()=>[d(P,{"nav-class":"nav-tabs-custom nav-success mb-3 pt-3",justified:"",modelValue:n.activeDay,"onUpdate:modelValue":a[0]||(a[0]=s=>n.activeDay=s)},{default:r(()=>[(g(!0),h(W,null,x(n.days,(s,t)=>(g(),z(D,{key:t,active:n.activeDay===s},{title:r(()=>{var l;return[k(m(s)+" ",1),(l=n.errors)!=null&&l[s]?(g(),h("span",ce,"*")):B("",!0)]}),default:r(()=>[e("div",ue,[e("div",me,[e("div",_e,[o.permissions.includes("update-zone-surge")?(g(),z(w,{key:0,class:"border-0"},{default:r(()=>[d(f,{class:"g-2"},{default:r(()=>[d(b,{md:"auto",class:"ms-auto"},{default:r(()=>[e("div",ge,[d(C,{variant:"primary",onClick:l=>n.addField(s)},{default:r(()=>[a[3]||(a[3]=e("i",{class:"ri-add-line align-bottom me-1"},null,-1)),k(" "+m(o.$t("add_new_surge")),1)]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024)]),_:2},1024)):B("",!0),d(F,{class:"border border-dashed border-end-0 border-start-0"},{default:r(()=>[n.fields[s].length===0?(g(),h("div",fe,[a[4]||(a[4]=e("i",{class:"ri-file-add-line text-muted display-4"},null,-1)),e("p",ve,m(o.$t("add_surge")),1)])):(g(!0),h(W,{key:1},x(n.fields[s],(l,p)=>{var u,H,L,U;return g(),h("div",{key:l.index,class:"row d-flex align-items-center"},[e("div",pe,[e("div",be,[e("label",he,m(o.$t("from")),1),d(V,{modelValue:l.start_time,"onUpdate:modelValue":y=>l.start_time=y,onOnChange:y=>n.sortBy(s),placeholder:o.$t("from"),config:n.preloadingTime,class:"form-control flatpickr-input"},null,8,["modelValue","onUpdate:modelValue","onOnChange","placeholder","config"])])]),e("div",ye,[e("div",ke,[e("label",Me,m(o.$t("To")),1),d(V,{modelValue:l.end_time,"onUpdate:modelValue":y=>l.end_time=y,placeholder:o.$t("To"),config:n.preloadingTime,class:"form-control flatpickr-input"},null,8,["modelValue","onUpdate:modelValue","placeholder","config"])])]),e("div",Be,[e("div",Ce,[e("label",Te,m(o.$t("surge_value")),1),Z(e("input",{type:"text",class:"form-control","onUpdate:modelValue":y=>l.value=y,placeholder:o.$t("surge")},null,8,Se),[[K,l.value]])])]),e("div",we,[e("div",Ve,[e("div",Fe,[e("i",{class:"bx bx-trash text-danger fs-22 btn",onClick:y=>n.removeField(s,p)},null,8,De)])])]),e("div",He,[(H=(u=n.errors)==null?void 0:u[s])!=null&&H[p]?(g(),h("span",Le,m((U=(L=n.errors)==null?void 0:L[s])==null?void 0:U[p]),1)):B("",!0)])])}),128)),o.permissions.includes("update-zone-surge")?(g(),z(f,{key:2,class:"g-2"},{default:r(()=>[d(b,{md:"auto",class:"ms-auto"},{default:r(()=>[e("div",Ue,[d(C,{variant:"primary",onClick:l=>n.surgeUpdate(s)},{default:r(()=>[k(m(o.$t("update")),1)]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024)):B("",!0)]),_:2},1024)])])])]),_:2},1032,["active"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e("div",null,[n.successMessage?(g(),h("div",ze,[e("div",Oe,[a[5]||(a[5]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),a[6]||(a[6]=k()),a[7]||(a[7]=e("strong",null,"Success",-1)),k(" - "+m(n.successMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-success",onClick:a[1]||(a[1]=(...s)=>o.dismissMessage&&o.dismissMessage(...s)),"aria-label":"Close Success Message"})])])):B("",!0),n.alertMessage?(g(),h("div",Pe,[e("div",je,[a[8]||(a[8]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),a[9]||(a[9]=k()),a[10]||(a[10]=e("strong",null,"Alert",-1)),k(" - "+m(n.alertMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-danger",onClick:a[2]||(a[2]=(...s)=>o.dismissMessage&&o.dismissMessage(...s)),"aria-label":"Close Alert Message"})])])):B("",!0)])]),_:1})}const $e=A(ee,[["render",Ne]]);export{$e as default};
