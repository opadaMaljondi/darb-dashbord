import{_ as j,Z as G,O as J,P as K,B as Q,D as W,r as _,T as Z,R as $,a as E,S as X,g as c,U as ee,i as d,y as O,w as u,W as v,N as te,l as r,n as t,J as i,t as F,K as se,k as g,L as R,F as q,z as B,C as k,q as ae,p as U}from"./vendor-8caf5d52.js";import{L as oe}from"./main-cc7bd0ce.js";import{P as ne}from"./page-header-18309276.js";import{P as le}from"./Pagination-0518e4bd.js";import{s as ie}from"./searchbar-e42e22fa.js";import{u as re,l as ce}from"./footer-502c2797.js";import{_ as de}from"./search-file-ab3e1046.js";import"./app-974c65a1.js";const ue={data(){return{SearchQuery:""}},components:{Layout:oe,PageHeader:ne,Head:G,Pagination:le,Multiselect:J,flatPickr:K,Link:Q,searchbar:ie},props:{successMessage:String,alertMessage:String,zonetype:{type:Object,required:!0}},setup(o){var V;const{t:e}=W(),y=_(""),s=Z({service_location_id:null,zone_type:(V=o.zonetype)==null?void 0:V.id,limit:10}),m=_([]),w=_({}),x=_(!1),M=_(!1),b=_(null),P=_({}),{selectedLocation:C}=re(),S=_(o.successMessage||""),p=_(o.alertMessage||""),z=()=>{S.value="",p.value=""};$(C,l=>{s.service_location_id=l,h()});const T=async(l,n)=>{v.fire({title:e("are_you_sure"),text:e("you_are_about_to_change_status"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:e("yes"),cancelButtonText:e("cancel")}).then(async f=>{if(f.isConfirmed)try{await E.post("/farefix/update-status",{id:l,status:n});const L=m.value.findIndex(Y=>Y.id===l);L!==-1&&(m.value[L].active=n),v.fire(e("changed"),e("status_updated_successfully"),"success")}catch(L){console.error(e("error_updating_status"),L),v.fire(e("error"),e("failed_to_update_status"),"error")}})},D=async l=>{try{await E.delete(`/farefix/delete/${l}`);const n=m.value.findIndex(f=>f.id===l);n!==-1&&m.value.splice(n,1),x.value=!1,v.fire(e("success"),e("vehicle_price_deleted_successfully"),"success")}catch(n){n.response&&n.response.status==403&&(p.value=n.response.data.alertMessage,setTimeout(()=>{p.value=""},5e3)),v.fire(e("error"),e("failed_to_delete_vehicle_price"),"error")}},H=async l=>{v.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!"}).then(async n=>{if(n.isConfirmed)try{await D(l)}catch(f){console.error(e("error_deleting_data"),f),v.fire(e("error"),e("failed_to_delete_the_data"),"error")}})},I=async l=>{y.value=l,h()},h=async(l=1)=>{try{const n=s.data();n.page=l,n.include="vehicleType,zone",s.status!==""&&(n.status=s.status),y.value.length>0&&(n.search=y.value);const f=await E.get("/farefix/list",{params:n});console.log("list-data"),console.log(f.data.results),m.value=f.data.results,w.value=f.data.paginator,A(w.value.total),M.value=!1}catch(n){console.error(e("error_fetching_set_prices"),n)}},a=async l=>{localStorage.setItem("farefix/list",l),h(l)},N=async l=>{te.get(`/farefix/edit/${l.id}`)},A=()=>{P.value=[10,25,50,100,200,500]};return{results:m,modalShow:x,deleteItemId:b,successMessage:S,alertMessage:p,deleteModal:H,dismissMessage:z,searchTerm:y,fetchSearch:I,paginator:w,modalFilter:M,fetchDatas:h,filter:s,handlePageChanged:a,editData:N,toggleActiveStatus:T,paginatorOption:P,selectedLocation:C,changeEntriesPerPage:()=>{h()}}},computed:{...ce,...X(["permissions"])},mounted(){this.filter.service_location_id=this.selectedLocation,this.fetchDatas();const o=localStorage.getItem("farefix/list");o?this.handlePageChanged(Number(o)):this.handlePageChanged(1)}},fe={class:"d-flex align-items-center mt-3"},_e={class:"me-2 text-muted"},ge=["value"],me={class:"ms-2 text-muted"},pe={class:"d-flex align-items-center gap-2"},he={class:"table-responsive"},ve={class:"table align-middle position-relative table-nowrap"},ye={class:"table-active"},be={scope:"col"},Ce={scope:"col"},Be={scope:"col"},ke={scope:"col"},we={scope:"col",class:"mx-5"},xe={key:0},Me={key:0},Pe=["onClick","id","checked"],Se={class:"d-flex"},Le={key:1},ze={colspan:"7",class:"text-center"},Te={key:0,class:"custom-alert alert alert-success alert-border-left fade show",data:"alert",id:"alertMsg"},De={class:"alert-content"},He={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",data:"alert",id:"alertMsg"},Ie={class:"alert-content"};function Ne(o,e,y,s,m,w){const x=c("Head"),M=c("PageHeader"),b=c("BCol"),P=c("searchbar"),C=c("BButton"),S=c("Link"),p=c("BRow"),z=c("BCardHeader"),T=c("BCardBody"),D=c("BCard"),H=c("pagination"),I=c("Layout"),h=ee("b-tooltip");return d(),O(I,null,{default:u(()=>[r(x,{title:o.$t("farefix")},null,8,["title"]),r(M,{title:o.$t("farefix"),pageTitle:o.$t("farefix")},null,8,["title","pageTitle"]),r(p,null,{default:u(()=>[r(b,{lg:"12"},{default:u(()=>[r(D,{"no-body":"",id:"tasksList"},{default:u(()=>[r(z,{class:"border-0"},{default:u(()=>[r(p,{class:"g-2"},{default:u(()=>[r(b,{md:"3"},{default:u(()=>[t("div",fe,[t("label",_e,i(o.$t("show")),1),F(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>s.filter.limit=a),onChange:e[1]||(e[1]=(...a)=>s.changeEntriesPerPage&&s.changeEntriesPerPage(...a)),class:"form-select form-select-sm w-auto"},[(d(!0),g(q,null,R(s.paginatorOption,a=>(d(),g("option",{key:a,value:a},i(a),9,ge))),128))],544),[[se,s.filter.limit]]),t("label",me,i(o.$t("entries")),1)])]),_:1}),r(b,{md:"3"}),r(b,{md:"auto",class:"ms-auto"},{default:u(()=>{var a;return[t("div",pe,[r(P,{onSearch:s.fetchSearch},null,8,["onSearch"]),o.permissions.includes("add-price")?(d(),O(S,{key:0,href:`/farefix/create/${(a=y.zonetype)==null?void 0:a.id}`},{default:u(()=>[r(C,{variant:"primary",class:"float-end"},{default:u(()=>[e[4]||(e[4]=t("i",{class:"ri-add-line align-bottom me-1"},null,-1)),B(" "+i(o.$t("add_farefix")),1)]),_:1,__:[4]})]),_:1},8,["href"])):k("",!0)])]}),_:1})]),_:1})]),_:1}),r(T,{class:"border border-dashed border-end-0 border-start-0"},{default:u(()=>[t("div",he,[t("table",ve,[t("thead",ye,[t("tr",null,[t("th",be,i(o.$t("zone")),1),t("th",Ce,i(o.$t("vehicle_type")),1),t("th",Be,i(o.$t("drop_zone")),1),t("th",ke,i(o.$t("status")),1),t("th",we,i(o.$t("action")),1)])]),s.results.length>0?(d(),g("tbody",xe,[(d(!0),g(q,null,R(s.results,(a,N)=>(d(),g("tr",{key:N},[t("td",null,i(a.zone_name),1),t("td",null,i(a.vehicle_type_name),1),t("td",null,i(a.drop_zone_name),1),o.permissions.includes("toggle-price")?(d(),g("td",Me,[t("div",{class:ae({"form-check":!0,"form-switch":!0,"form-switch-lg":!0,"form-switch-success":a.active})},[t("input",{class:"form-check-input",type:"checkbox",role:"switch",onClick:U(A=>s.toggleActiveStatus(a.id,!a.active),["prevent"]),id:"status_"+a.id,checked:a.active},null,8,Pe)],2)])):k("",!0),t("td",null,[t("div",Se,[o.permissions.includes("edit-price")?F((d(),O(C,{key:0,class:"btn btn-soft-warning btn-sm m-2",onClick:U(A=>s.editData(a),["prevent"]),"data-bs-toggle":"tooltip",title:o.$t("edit")},{default:u(()=>e[5]||(e[5]=[t("i",{class:"bx bxs-edit-alt bx-xs"},null,-1)])),_:2,__:[5]},1032,["onClick","title"])),[[h,void 0,void 0,{hover:!0}]]):k("",!0)])])]))),128))])):(d(),g("tbody",Le,[t("tr",null,[t("td",ze,[e[6]||(e[6]=t("img",{src:de,alt:"Loading...",style:{width:"100px"}},null,-1)),t("h5",null,i(o.$t("no_data_found")),1)])])]))])])]),_:1})]),_:1}),r(H,{paginator:s.paginator,onPageChanged:s.handlePageChanged},null,8,["paginator","onPageChanged"])]),_:1})]),_:1}),s.successMessage?(d(),g("div",Te,[t("div",De,[e[7]||(e[7]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[8]||(e[8]=B()),e[9]||(e[9]=t("strong",null,"Success",-1)),B(" - "+i(s.successMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-success",onClick:e[2]||(e[2]=(...a)=>s.dismissMessage&&s.dismissMessage(...a)),"aria-label":"Close Success Message"})])])):k("",!0),s.alertMessage?(d(),g("div",He,[t("div",Ie,[e[10]||(e[10]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[11]||(e[11]=B()),e[12]||(e[12]=t("strong",null,"Alert",-1)),B(" - "+i(s.alertMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-danger",onClick:e[3]||(e[3]=(...a)=>s.dismissMessage&&s.dismissMessage(...a)),"aria-label":"Close Alert Message"})])])):k("",!0)]),_:1})}const je=j(ue,[["render",Ne]]);export{je as default};
