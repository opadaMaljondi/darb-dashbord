import{_ as j,Z as R,D as G,r as h,T as J,o as K,g as w,i as r,y as q,w as T,a as B,Y as k,N as F,l as V,n as e,p as Y,z as m,J as n,t as u,K as N,k as i,L as D,F as E,C as l,q as Q,M as v}from"./vendor-54d6cb1e.js";import{L as W}from"./main-b839be26.js";import{P as X}from"./page-header-ff719701.js";import{u as $}from"./footer-7e4f68d9.js";import"./app-cb082573.js";const ee={components:{Layout:W,PageHeader:X,Head:R},props:{successMessage:String,alertMessage:String,default_lat:String,default_lng:String,existingZones:Array,enable_maximum_distance_feature:Boolean,settings:Object},setup(s){const{t}=G(),{languages:x,fetchData:o}=$(),M=h("English"),U=h(s.settings.enable_peak_zone_feature==1),g=J({service_location_id:"",languageFields:{},unit:"",maximum_outstation_distance:s.enable_maximum_distance_feature?"":0,maximum_distance:s.enable_maximum_distance_feature?"":0}),C=h(parseFloat(s.default_lat)),S=h(parseFloat(s.default_lng)),L=h(s.successMessage||""),y=h(s.alertMessage||""),a=h([]);let p=[];const P=async()=>{const d=await B.get("list");a.value=d.data.results},A=()=>{const d=k.map("map").setView({lat:C.value,lng:S.value},10);k.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(d);const c=new k.FeatureGroup;d.addLayer(c),s.existingZones.forEach(z=>{const f=z.map(b=>[b.lat,b.lng]);k.polygon(f,{color:"red",interactive:!1}).addTo(d)});const _=new k.Control.Draw({draw:{polygon:{allowIntersection:!1},rectangle:!1,circle:!1,polyline:!1,marker:!1},edit:{featureGroup:c,remove:!0}});d.addControl(_),d.on(k.Draw.Event.CREATED,z=>{const f=z.layer;p.push(f),c.addLayer(f),d.addLayer(f)}),d.on(k.Draw.Event.DELETED,function(z){z.layers.eachLayer(function(b){console.log("Deleted layer:",b),p=p.filter(Z=>Z!==b)})})},H=async()=>{const d=O();if(Object.keys(d).length===0)try{if(p.length===0){y.value=t("at_least_one_completed_polygon_is_required");return}const c=p.map(f=>f.getLatLngs()[0].map(b=>[b.lng,b.lat])),_={...g.data(),coordinates:JSON.stringify(c)};(await B.post("store",_)).status===201?(L.value=t("zone_created_successfully"),g.reset(),F.get("/zones")):y.value=t("failed_to_create_zone")}catch(c){c.response&&c.response.status===403?(y.value=c.response.data.alertMessage,setTimeout(()=>{F.get("/zones")},5e3)):(console.error(t("error_creating_zone"),c),y.value=t("failed_to_create_zone_catch"))}else g.errors=d},I=d=>{M.value=d};K(async()=>{Object.keys(x).length==0&&await o(),A(),P()});const O=()=>{const{service_location_id:d,unit:c}=g,_={};return c?delete _.unit:_.unit=t("unit_is_required"),d?delete _.service_location_id:_.service_location_id=t("service_location_is_required"),p.length===0?_.coordinates=t("at_least_one_completed_polygon_is_required"):delete _.coordinates,s.enable_maximum_distance_feature&&(maximum_distance?delete _.maximum_distance:_.maximum_distance=t("required"),maximum_outstation_distance?delete _.maximum_outstation_distance:_.maximum_outstation_distance=t("required")),_};return{form:g,successMessage:L,alertMessage:y,handleSubmit:H,serviceLocations:a,setActiveTab:I,activeTab:M,languages:x,enable_peak_zone_feature:U}}},te={class:"row"},oe={class:"col-lg-6"},se={class:"card"},ae={class:"card-body"},ne={class:"mb-3"},re={for:"service_location",class:"form-label"},ie={value:"",disabled:""},le=["value"],de={key:0,class:"text-danger"},_e={class:"nav nav-tabs nav-tabs-custom nav-success nav-justified",role:"tablist"},ce={class:"nav-item",role:"presentation"},me=["onClick"],ue=["id"],pe={class:"col-sm-6 mt-3"},fe={class:"mb-3"},be=["for"],ve=["placeholder","id","onUpdate:modelValue","required"],ge={class:"mb-3"},ye={for:"select_unit",class:"form-label"},he={disabled:"",value:""},ke={value:"1"},ze={value:"2"},xe={key:0,class:"text-danger"},we={key:0,class:"mb-3"},Le={for:"maximum_distance",class:"form-label"},Me=["placeholder"],Ce={key:0,class:"text-danger"},Se={key:1,class:"mb-3"},Te={for:"maximum_outstation_distance",class:"form-label"},Ve=["placeholder"],De={key:0,class:"text-danger"},Ee={key:2,class:"row"},Ue={class:"col-sm-6"},qe={class:"mb-3"},Be={for:"peak_zone_ride_count",class:"form-label"},Fe={class:"input-group"},Ne=["readonly","placeholder"],Pe={key:0,class:"text-danger"},Ae={class:"col-sm-6"},He={class:"mb-3"},Ie={for:"peak_zone_radius",class:"form-label"},Oe={class:"input-group"},Ze=["readonly","placeholder"],je={key:0,class:"text-danger"},Re={key:3,class:"row"},Ge={class:"col-sm-6"},Je={class:"mb-3"},Ke={for:"peak_zone_history_duration",class:"form-label"},Ye=["readonly","placeholder"],Qe={key:0,class:"text-danger"},We={class:"col-sm-6"},Xe={class:"mb-3"},$e={for:"peak_zone_duration",class:"form-label"},et={class:"input-group"},tt=["readonly","placeholder"],ot={key:0,class:"text-danger"},st={key:0,class:"row"},at={class:"col-sm-6"},nt={class:"mb-3"},rt={for:"distance_price_percentage",class:"form-label"},it={href:"",class:"text-success","data-bs-toggle":"modal","data-bs-target":"#surge"},lt={class:"input-group"},dt=["readonly","placeholder"],_t={key:0,class:"text-danger"},ct={class:"text-end"},mt={type:"submit",class:"btn btn-primary"},ut={class:"mb-3"},pt={key:0,class:"text-danger"},ft={class:"col-lg-6"},bt={class:"card"},vt={class:"card-body"},gt=["placeholder"],yt={key:0,class:"custom-alert alert alert-danger alert-border-left fade show",role:"alert",id:"alertMsg"},ht={class:"alert-content"};function kt(s,t,x,o,M,U){const g=w("Head"),C=w("PageHeader"),S=w("BCol"),L=w("BRow"),y=w("Layout");return r(),q(y,null,{default:T(()=>[V(g,{title:"Zones"}),V(C,{title:s.$t("create"),pageTitle:s.$t("zone"),pageLink:"/zones"},null,8,["title","pageTitle"]),e("div",te,[e("div",oe,[e("div",se,[e("div",ae,[e("form",{onSubmit:t[9]||(t[9]=Y((...a)=>o.handleSubmit&&o.handleSubmit(...a),["prevent"]))},[e("div",ne,[e("label",re,[m(n(s.$t("service_location"))+" ",1),t[11]||(t[11]=e("span",{class:"text-danger"},"*",-1))]),u(e("select",{class:"form-select",id:"service_location","onUpdate:modelValue":t[0]||(t[0]=a=>o.form.service_location_id=a)},[e("option",ie,n(s.$t("select_service_location")),1),(r(!0),i(E,null,D(o.serviceLocations,a=>(r(),i("option",{key:a.id,value:a.id},n(a.name),9,le))),128))],512),[[N,o.form.service_location_id]]),o.form.errors.service_location_id?(r(),i("span",de,n(o.form.errors.service_location_id),1)):l("",!0)]),e("ul",_e,[(r(!0),i(E,null,D(o.languages,a=>(r(),q(L,{key:a.code},{default:T(()=>[V(S,{lg:"12"},{default:T(()=>[e("li",ce,[e("a",{class:Q(["nav-link",{active:o.activeTab===a.label}]),onClick:p=>o.setActiveTab(a.label),role:"tab","aria-selected":"true"},n(a.label),11,me)])]),_:2},1024)]),_:2},1024))),128))]),(r(!0),i(E,null,D(o.languages,a=>(r(),i("div",{class:"tab-content text-muted",key:a.code},[o.activeTab===a.label?(r(),i("div",{key:0,class:"tab-pane active show",id:`${a.label}`,role:"tabpanel"},[e("div",pe,[e("div",fe,[e("label",{for:`name-${a.code}`,class:"form-label"},[m(n(s.$t("name"))+" ",1),t[12]||(t[12]=e("span",{class:"text-danger"},"*",-1))],8,be),u(e("input",{type:"text",class:"form-control",placeholder:`Enter Name in ${a.label}`,id:`name-${a.code}`,"onUpdate:modelValue":p=>o.form.languageFields[a.code]=p,required:a.code==="en"},null,8,ve),[[v,o.form.languageFields[a.code]]])])])],8,ue)):l("",!0)]))),128)),e("div",ge,[e("label",ye,[m(n(s.$t("select_unit"))+" ",1),t[13]||(t[13]=e("span",{class:"text-danger"},"*",-1))]),u(e("select",{id:"select_unit",class:"form-select","onUpdate:modelValue":t[1]||(t[1]=a=>o.form.unit=a)},[e("option",he,n(s.$t("choose_unit")),1),e("option",ke,n(s.$t("kilo_meter")),1),e("option",ze,n(s.$t("miles")),1)],512),[[N,o.form.unit]]),o.form.errors.unit?(r(),i("span",xe,n(o.form.errors.unit),1)):l("",!0)]),x.enable_maximum_distance_feature?(r(),i("div",we,[e("label",Le,[m(n(s.$t("maximum_distance"))+" ",1),t[14]||(t[14]=e("span",{class:"text-danger"},"*",-1))]),u(e("input",{type:"number",step:"any",class:"form-control",placeholder:s.$t("enter_maximum_distance"),id:"maximum_distance","onUpdate:modelValue":t[2]||(t[2]=a=>o.form.maximum_distance=a)},null,8,Me),[[v,o.form.maximum_distance,void 0,{number:!0}]]),o.form.errors.enter_maximum_distance?(r(),i("span",Ce,n(o.form.errors.enter_maximum_distance),1)):l("",!0)])):l("",!0),x.enable_maximum_distance_feature?(r(),i("div",Se,[e("label",Te,[m(n(s.$t("maximum_outstation_distance"))+" ",1),t[15]||(t[15]=e("span",{class:"text-danger"},"*",-1))]),u(e("input",{type:"number",step:"any",class:"form-control",placeholder:s.$t("enter_maximum_outstation_distance"),id:"maximum_outstation_distance","onUpdate:modelValue":t[3]||(t[3]=a=>o.form.maximum_outstation_distance=a)},null,8,Ve),[[v,o.form.maximum_outstation_distance,void 0,{number:!0}]]),o.form.errors.maximum_outstation_distance?(r(),i("span",De,n(o.form.errors.maximum_outstation_distance),1)):l("",!0)])):l("",!0),o.enable_peak_zone_feature?(r(),i("div",Ee,[e("div",Ue,[e("div",qe,[e("label",Be,[m(n(s.$t("peak_zone_ride_count"))+" ",1),t[16]||(t[16]=e("span",{class:"text-danger"},"*",-1))]),e("div",Fe,[u(e("input",{type:"number",readonly:s.app_for==="demo",class:"form-control",placeholder:s.$t("enter_peak_zone_ride_count"),id:"peak_zone_ride_count","onUpdate:modelValue":t[4]||(t[4]=a=>o.form.peak_zone_ride_count=a)},null,8,Ne),[[v,o.form.peak_zone_ride_count]]),o.form.errors.peak_zone_ride_count?(r(),i("span",Pe,n(o.form.errors.peak_zone_ride_count),1)):l("",!0)])])]),e("div",Ae,[e("div",He,[e("label",Ie,[m(n(s.$t("peak_zone_radius"))+" ",1),t[17]||(t[17]=e("span",{class:"text-danger"},"*",-1))]),e("div",Oe,[u(e("input",{type:"number",readonly:s.app_for==="demo",class:"form-control",placeholder:s.$t("enter_peak_zone_radius"),id:"peak_zone_radius","onUpdate:modelValue":t[5]||(t[5]=a=>o.form.peak_zone_radius=a)},null,8,Ze),[[v,o.form.peak_zone_radius]]),o.form.errors.peak_zone_radius?(r(),i("span",je,n(o.form.errors.peak_zone_radius),1)):l("",!0)])])])])):l("",!0),o.enable_peak_zone_feature?(r(),i("div",Re,[e("div",Ge,[e("div",Je,[e("label",Ke,[m(n(s.$t("peak_zone_history_duration"))+" ",1),t[18]||(t[18]=e("span",{class:"text-danger"},"*",-1))]),u(e("input",{type:"number",readonly:s.app_for==="demo",class:"form-control",placeholder:s.$t("enter_peak_zone_history_duration"),id:"peak_zone_history_duration","onUpdate:modelValue":t[6]||(t[6]=a=>o.form.peak_zone_history_duration=a)},null,8,Ye),[[v,o.form.peak_zone_history_duration]]),o.form.errors.peak_zone_history_duration?(r(),i("span",Qe,n(o.form.errors.peak_zone_history_duration),1)):l("",!0)])]),e("div",We,[e("div",Xe,[e("label",$e,[m(n(s.$t("peak_zone_duration"))+" ",1),t[19]||(t[19]=e("span",{class:"text-danger"},"*",-1))]),e("div",et,[u(e("input",{type:"number",readonly:s.app_for==="demo",class:"form-control",placeholder:s.$t("enter_peak_zone_duration"),id:"peak_zone_duration","onUpdate:modelValue":t[7]||(t[7]=a=>o.form.peak_zone_duration=a)},null,8,tt),[[v,o.form.peak_zone_duration]]),o.form.errors.peak_zone_duration?(r(),i("span",ot,n(o.form.errors.peak_zone_duration),1)):l("",!0)])])]),o.enable_peak_zone_feature?(r(),i("div",st,[e("div",at,[e("div",nt,[e("label",rt,[m(n(s.$t("distance_price_percentage"))+" ",1),t[20]||(t[20]=e("span",{class:"text-danger"},"*",-1)),e("a",it,n(s.$t("how_it_works")),1)]),e("div",lt,[u(e("input",{type:"number",readonly:s.app_for==="demo",class:"form-control",placeholder:s.$t("enter_distance_price_percentage"),id:"distance_price_percentage","onUpdate:modelValue":t[8]||(t[8]=a=>o.form.distance_price_percentage=a)},null,8,dt),[[v,o.form.distance_price_percentage]]),o.form.errors.distance_price_percentage?(r(),i("span",_t,n(o.form.errors.distance_price_percentage),1)):l("",!0)])])])])):l("",!0)])):l("",!0),e("div",ct,[e("button",mt,n(s.$t("save")),1)]),e("div",ut,[o.form.errors.coordinates?(r(),i("span",pt,n(o.form.errors.coordinates),1)):l("",!0)])],32)])])]),e("div",ft,[e("div",bt,[e("div",vt,[e("input",{id:"pac-input",class:"form-control",type:"text",placeholder:s.$t("search_for_a_city"),ref:"autocompleteInput"},null,8,gt),t[21]||(t[21]=e("div",{id:"map",style:{height:"400px"}},null,-1))])])])]),o.alertMessage?(r(),i("div",yt,[e("div",ht,[t[22]||(t[22]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),t[23]||(t[23]=e("strong",null,"Alert",-1)),m(" - "+n(o.alertMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-danger",onClick:t[10]||(t[10]=(...a)=>s.dismissMessage&&s.dismissMessage(...a)),"aria-label":"Close Alert Message"})])])):l("",!0),t[24]||(t[24]=e("div",{id:"surge",class:"modal fade",tabindex:"-1","aria-labelledby":"surgeLabel","aria-hidden":"true",style:{display:"none"}},[e("div",{class:"modal-dialog"},[e("div",{class:"modal-content"},[e("div",{class:"modal-header"},[e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]),e("div",{class:"modal-body"},[e("h5",{class:"fs-15"}," Peak Zone Surge Percentage "),e("p",{class:"text-muted"}," The percentage with which the price per distance increases when the ride is created within the peakzone ")])])])],-1))]),_:1})}const Ct=j(ee,[["render",kt],["__scopeId","data-v-70697d11"]]);export{Ct as default};
