import{_ as x,Z as H,O as R,D as V,T as L,r as d,g as n,i as B,y as N,w as m,a as U,W as w,N as k,l as i,n as t,z as I,J as p,p as P,k as F,C as T}from"./vendor-8caf5d52.js";import{L as D}from"./main-cc7bd0ce.js";import{P as j}from"./page-header-18309276.js";import{P as E}from"./Pagination-0518e4bd.js";import{F as O}from"./FormValidation-f14f6003.js";import{I as q}from"./ImageUpload-fc3b7bc8.js";import"./footer-502c2797.js";import"./app-974c65a1.js";const z={components:{Layout:D,PageHeader:j,Head:H,Pagination:E,Multiselect:R,FormValidation:O,ImageUpload:q},props:{successMessage:String,alertMessage:String,UserImported:{type:Object,required:!0},validate:Function},setup(o){const{t:e}=V(),r=L({user_file:null}),a={user_file:{required:!0}},g=d(null),c=d({}),f=d(o.successMessage||""),u=d(o.alertMessage||""),b=()=>{f.value="",u.value=""},v=async()=>{if(c.value=g.value.validate(),console.log("errors.value",c.value),!(Object.keys(c.value).length>0))try{console.log("form.user_file",r.user_file);const s=new FormData;s.append("file",r.user_file);let l;console.log("UserImported",o.UserImported),o.UserImported?l=await U.post(`/user-import/reupload-invalid-file-store/${o.UserImported.id}`,s,{headers:{"Content-Type":"multipart/form-data"}}):l=await U.post("/user-import/import-file",s,{headers:{"Content-Type":"multipart/form-data"}}),console.log("response",l),l.status===201?w.fire({title:"Success!",text:e("files_imported_successfully"),icon:"success"}).then(async S=>{S.isConfirmed&&(r.reset(),k.get("/user-import"))}):w.fire({title:"Error!",text:e("failed_to_create_user_imported_files."),icon:e("error")})}catch(s){s.response&&s.response.status===422?c.value=s.response.data.errors:s.response&&s.response.status===403?(u.value=s.response.data.alertMessage,setTimeout(()=>{k.get("/user-import")},5e3)):(console.error(e("error_creating_user_imported_files"),s),u.value=e("failed_to_create_user_imported_files_catch"))}},y=(s,l)=>{r[l]=s},M=s=>{r[s]=null},_=d(!1),C=async s=>{if(o.app_for=="demo"){w.fire(e("error"),e("you_are_not_authorised"),"error");return}const l=s.target.files[0];if(l&&!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(l.type)){_.value=!0,r.user_file=null;return}r.user_file=l},h=o.bannerimage?o.bannerimage.image:null;return{form:r,successMessage:f,alertMessage:u,handleSubmit:v,dismissMessage:b,selectedCountry:d(null),selectedTimezone:d(null),validationRules:a,validationRef:g,errors:c,handleImageSelected:y,handleImageRemoved:M,iconUrl:h,handleFileUpload:C,userFileError:_}}},A={class:"row"},J={class:"col-sm-6"},W={class:"mb-3"},Z={for:"firebase_json",class:"form-label"},G=["disabled"],K={class:"col-lg-12"},Q={class:"text-end"},X={type:"submit",class:"btn btn-primary"},Y={key:0,class:"custom-alert alert alert-success alert-border-left fade show",role:"alert",id:"alertMsg"},$={class:"alert-content"},ee={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",role:"alert",id:"alertMsg"},se={class:"alert-content"};function te(o,e,r,a,g,c){const f=n("Head"),u=n("PageHeader"),b=n("BCardHeader"),v=n("FormValidation"),y=n("BCardBody"),M=n("BCard"),_=n("BCol"),C=n("BRow"),h=n("Layout");return B(),N(h,null,{default:m(()=>[i(f,{title:"Banner Image"}),i(u,{title:o.bannerimage?o.$t("edit"):o.$t("create"),pageTitle:o.$t("user-import"),pageLink:"/banner-image"},null,8,["title","pageTitle"]),i(C,null,{default:m(()=>[i(_,{lg:"12"},{default:m(()=>[i(M,{"no-body":"",id:"tasksList"},{default:m(()=>[i(b,{class:"border-0"}),i(y,{class:"border border-dashed border-end-0 border-start-0"},{default:m(()=>[t("form",{onSubmit:e[1]||(e[1]=P((...s)=>a.handleSubmit&&a.handleSubmit(...s),["prevent"]))},[i(v,{form:a.form,rules:a.validationRules,ref:"validationRef"},{default:m(()=>[t("div",A,[t("div",J,[t("div",W,[t("label",Z,[I(p(o.$t("User Files"))+" ",1),e[4]||(e[4]=t("span",{class:"text-danger"},"*",-1))]),t("input",{disabled:o.app_for==="demo",type:"file",class:"form-control",onChange:e[0]||(e[0]=(...s)=>a.handleFileUpload&&a.handleFileUpload(...s)),accept:".xlsx,.xls,.csv"},null,40,G)])]),t("div",K,[t("div",Q,[t("button",X,p(r.UserImported?o.$t("update"):o.$t("save")),1)])])])]),_:1},8,["form","rules"])],32)]),_:1})]),_:1})]),_:1})]),_:1}),t("div",null,[a.successMessage?(B(),F("div",Y,[t("div",$,[e[5]||(e[5]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[6]||(e[6]=t("strong",null,"Success",-1)),I(" - "+p(a.successMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-success",onClick:e[2]||(e[2]=(...s)=>a.dismissMessage&&a.dismissMessage(...s)),"aria-label":"Close Success Message"})])])):T("",!0),a.alertMessage?(B(),F("div",ee,[t("div",se,[e[7]||(e[7]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[8]||(e[8]=t("strong",null,"Alert",-1)),I(" - "+p(a.alertMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-danger",onClick:e[3]||(e[3]=(...s)=>a.dismissMessage&&a.dismissMessage(...s)),"aria-label":"Close Alert Message"})])])):T("",!0)])]),_:1})}const ue=x(z,[["render",te]]);export{ue as default};
