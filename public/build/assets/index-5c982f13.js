import{_ as H,Z as P,O as N,P as A,D as q,T as O,r as v,R as j,G as E,g as _,i as n,y as $,w as g,a as U,N as z,l as m,n as e,J as a,t as w,K as C,k as i,L as h,F as y,z as M,C as S,p as G}from"./vendor-54d6cb1e.js";import{L as I}from"./main-b839be26.js";import{P as J}from"./page-header-ff719701.js";import{P as K}from"./Pagination-b5e3d5c9.js";import{i as Y}from"./imageUpload-bad454a2.js";import{F as Z}from"./FormValidation-cabc17c8.js";import"./footer-7e4f68d9.js";import"./app-cb082573.js";/* empty css                                                    */const Q={components:{Layout:I,PageHeader:J,Head:P,Pagination:K,Multiselect:N,FormValidation:Z,imageUpload:Y,flatPickr:A},props:{successMessage:String,alertMessage:String,validate:Function,vehicleTypes:Array},setup(l){const{t:s}=q(),d=O({date:"",select_status:"",select_date_option:"",select_transport_type:"",file_format:"",vehicle_types:[]}),o=v([]),L={select_status:{required:!0},select_date_option:{required:!0},file_format:{required:!0}},V=v(null),p=v({}),b=v(l.successMessage||""),u=v(l.alertMessage||""),B=()=>{b.value="",u.value=""},k=v(!1);j(()=>d.select_transport_type,async()=>{if(!d.select_transport_type){o.value=[];return}try{const r=await U.get("/report/getVehicleTypes",{params:{transport_type:d.select_transport_type}});console.log("Vehicle Types Response:",r.data),o.value=r.data}catch(r){console.error(s("error_fetching_vehicle_types"),r),u.value=s("failed_to_fetch_vehicle_types")}});const D=async()=>{if(p.value=V.value.validate(),!(Object.keys(p.value).length>0)){k.value=!0;try{console.log("Form Data:",d.data());const r=await U.post("/report/driver-report-download",d.data(),{responseType:"blob"}),f=window.URL.createObjectURL(new Blob([r.data])),t=document.createElement("a");t.href=f,t.setAttribute("download",`driver_report.${d.file_format}`),document.body.appendChild(t),t.click(),t.remove(),b.value=s("report_downloaded_successfully"),d.reset(),z.get("/report/driver-report")}catch(r){r.response&&r.response.status===422?p.value=r.response.data.errors:(console.error(s("error_downloading_report"),r),u.value=s("failed_to_download_report"))}finally{k.value=!1}}},T=E(()=>{if(d.date&&d.date.length===2){const r=new Date(d.date[0]),f=new Date(d.date[1]),t=r.toLocaleString("default",{month:"short"}),c=f.toLocaleString("default",{month:"short"});return`${r.getDate()} ${t} - ${f.getDate()} ${c}`}return""});return{form:d,vehicleTypes:o,successMessage:b,alertMessage:u,handleSubmit:D,dismissMessage:B,validationRules:L,validationRef:V,errors:p,formattedDate:T,rangeDateconfig:{mode:"range",dateFormat:"d M, Y",maxDate:"today"},loading:k}}},W={class:"row"},X={class:"col-sm-6"},x={class:"mb-3"},ee={for:"select_transport_type",class:"form-label"},te={selected:"",disabled:"",value:""},se={value:"taxi"},oe={value:"delivery"},ae={value:"both"},le={class:"col-sm-6"},re={class:"mb-3"},ne={for:"select_vehicle_type",class:"form-label"},ie={class:"col-sm-6"},de={class:"mb-3"},ce={for:"select_status",class:"form-label"},_e={selected:"",disabled:"",value:""},me={value:"1"},pe={value:"0"},ue={class:"col-sm-6"},fe={class:"mb-3"},ve={for:"select_date_option",class:"form-label"},ge={disabled:"",value:""},he={value:"today"},ye={value:"this_week"},be={value:"this_month"},ke={value:"this_year"},Me={value:"date"},we={key:0,class:"col-sm-6"},Ce={class:"mb-4"},Ve={for:"datepicker-range",class:"form-label"},Be={class:"col-sm-6"},De={class:"mb-3"},Te={for:"file_format",class:"form-label"},Se={disabled:"",selected:"",value:""},Le={value:"xlsx"},Re={value:"csv"},Fe={class:"col-lg-12"},Ue={class:"text-end"},He=["disabled"],Pe={key:0,class:"custom-alert alert alert-success alert-border-left fade show",role:"alert",id:"alertMsg"},Ne={class:"alert-content"},Ae={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",role:"alert",id:"alertMsg"},qe={class:"alert-content"};function Oe(l,s,d,o,L,V){const p=_("Head"),b=_("PageHeader"),u=_("BCardHeader"),B=_("Multiselect"),k=_("flat-pickr"),R=_("FormValidation"),D=_("BCardBody"),T=_("BCard"),F=_("BCol"),r=_("BRow"),f=_("Layout");return n(),$(f,null,{default:g(()=>[m(p,{title:"Driver Report"}),m(b,{title:l.$t("driver_report"),pageTitle:l.$t("driver_report")},null,8,["title","pageTitle"]),m(r,null,{default:g(()=>[m(F,{lg:"12"},{default:g(()=>[m(T,{"no-body":"",id:"tasksList"},{default:g(()=>[m(u,{class:"border-0"}),m(D,{class:"border border-dashed border-end-0 border-start-0"},{default:g(()=>[e("form",{onSubmit:s[6]||(s[6]=G((...t)=>o.handleSubmit&&o.handleSubmit(...t),["prevent"]))},[m(R,{form:o.form,rules:o.validationRules,ref:"validationRef"},{default:g(()=>[e("div",W,[e("div",X,[e("div",x,[e("label",ee,a(l.$t("select_transport_type")),1),w(e("select",{id:"select_transport_type",class:"form-select","onUpdate:modelValue":s[0]||(s[0]=t=>o.form.select_transport_type=t)},[e("option",te,a(l.$t("select")),1),e("option",se,a(l.$t("taxi")),1),e("option",oe,a(l.$t("delivery")),1),e("option",ae,a(l.$t("both")),1)],512),[[C,o.form.select_transport_type]]),(n(!0),i(y,null,h(o.errors.select_transport_type,(t,c)=>(n(),i("span",{key:c,class:"text-danger"},a(t),1))),128))])]),e("div",le,[e("div",re,[e("label",ne,a(l.$t("select_vehicle_type")),1),m(B,{id:"select_vehicle_type",mode:"tags",modelValue:o.form.vehicle_types,"onUpdate:modelValue":s[1]||(s[1]=t=>o.form.vehicle_types=t),"close-on-select":!1,searchable:!0,"create-option":!1,options:o.vehicleTypes.map(t=>({value:t.id,label:t.name})),placeholder:l.$t("select_vehicle_type"),multiple:!0},null,8,["modelValue","options","placeholder"]),(n(!0),i(y,null,h(o.errors.vehicle_types,(t,c)=>(n(),i("span",{key:c,class:"text-danger"},a(t),1))),128))])]),e("div",ie,[e("div",de,[e("label",ce,[M(a(l.$t("select_approval_status"))+" ",1),s[9]||(s[9]=e("span",{class:"text-danger"},"*",-1))]),w(e("select",{id:"select_status",class:"form-select","onUpdate:modelValue":s[2]||(s[2]=t=>o.form.select_status=t)},[e("option",_e,a(l.$t("select")),1),e("option",me,a(l.$t("approved")),1),e("option",pe,a(l.$t("disapproved")),1)],512),[[C,o.form.select_status]]),(n(!0),i(y,null,h(o.errors.select_status,(t,c)=>(n(),i("span",{key:c,class:"text-danger"},a(t),1))),128))])]),e("div",ue,[e("div",fe,[e("label",ve,[M(a(l.$t("date_option"))+" ",1),s[10]||(s[10]=e("span",{class:"text-danger"},"*",-1))]),w(e("select",{id:"select_date_option",class:"form-select","onUpdate:modelValue":s[3]||(s[3]=t=>o.form.select_date_option=t)},[e("option",ge,a(l.$t("select")),1),e("option",he,a(l.$t("today")),1),e("option",ye,a(l.$t("this_week")),1),e("option",be,a(l.$t("this_month")),1),e("option",ke,a(l.$t("this_year")),1),e("option",Me,a(l.$t("date")),1)],512),[[C,o.form.select_date_option]]),(n(!0),i(y,null,h(o.errors.select_date_option,(t,c)=>(n(),i("span",{key:c,class:"text-danger"},a(t),1))),128))])]),o.form.select_date_option==="date"?(n(),i("div",we,[e("div",Ce,[e("label",Ve,a(l.$t("from_to_date")),1),m(k,{placeholder:l.$t("select_date"),modelValue:o.form.date,"onUpdate:modelValue":s[4]||(s[4]=t=>o.form.date=t),config:o.rangeDateconfig,class:"form-control flatpickr-input",id:"datepicker-range"},null,8,["placeholder","modelValue","config"]),(n(!0),i(y,null,h(o.errors.date,(t,c)=>(n(),i("span",{key:c,class:"text-danger"},a(t),1))),128))])])):S("",!0),e("div",Be,[e("div",De,[e("label",Te,[M(a(l.$t("file_format"))+" ",1),s[11]||(s[11]=e("span",{class:"text-danger"},"*",-1))]),w(e("select",{id:"file_format",class:"form-select","onUpdate:modelValue":s[5]||(s[5]=t=>o.form.file_format=t)},[e("option",Se,a(l.$t("select_file_format")),1),e("option",Le,a(l.$t("excel")),1),e("option",Re,a(l.$t("csv")),1)],512),[[C,o.form.file_format]]),(n(!0),i(y,null,h(o.errors.file_format,(t,c)=>(n(),i("span",{key:c,class:"text-danger"},a(t),1))),128))])]),e("div",Fe,[e("div",Ue,[e("button",{type:"submit",class:"btn btn-primary",disabled:o.loading},a(l.$t("download")),9,He)])])])]),_:1},8,["form","rules"])],32)]),_:1})]),_:1})]),_:1})]),_:1}),e("div",null,[o.successMessage?(n(),i("div",Pe,[e("div",Ne,[s[12]||(s[12]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),s[13]||(s[13]=e("strong",null,"Success",-1)),M(" - "+a(o.successMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-success",onClick:s[7]||(s[7]=(...t)=>o.dismissMessage&&o.dismissMessage(...t)),"aria-label":"Close Success Message"})])])):S("",!0),o.alertMessage?(n(),i("div",Ae,[e("div",qe,[s[14]||(s[14]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),s[15]||(s[15]=e("strong",null,"Alert",-1)),M(" - "+a(o.alertMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-danger",onClick:s[8]||(s[8]=(...t)=>o.dismissMessage&&o.dismissMessage(...t)),"aria-label":"Close Alert Message"})])])):S("",!0)])]),_:1})}const Ze=H(Q,[["render",Oe]]);export{Ze as default};
